import{_ as o}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as e,o as c,c as l,a as n,b as s,d as t,e as p}from"./app-MsA2k2kn.js";const u={},i=n("h1",{id:"数据分析与可视化-基于matplotlib和plottable库绘制精美表格",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#数据分析与可视化-基于matplotlib和plottable库绘制精美表格","aria-hidden":"true"},"#"),s(" [数据分析与可视化] 基于matplotlib和plottable库绘制精美表格")],-1),d={href:"https://github.com/znstrider/plottable",target:"_blank",rel:"noopener noreferrer"},r={href:"https://plottable.readthedocs.io/en/latest/index.html#",target:"_blank",rel:"noopener noreferrer"},k=n("blockquote",null,[n("p",null,"pip install plottable")],-1),m={href:"https://github.com/luohenyueji/Python-Study-Notes/tree/master/Plot%20Items/Matplotlib-related/%E5%9F%BA%E4%BA%8Ematplotlib%E5%92%8Cplottable%E5%BA%93%E7%BB%98%E5%88%B6%E7%B2%BE%E7%BE%8E%E8%A1%A8%E6%A0%BC",target:"_blank",rel:"noopener noreferrer"},v=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## jupyter notebook环境去除warning</span>
<span class="token keyword">import</span> warnings
warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">&quot;ignore&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> plottable
<span class="token comment">## 打印plottable版本</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;plottable version:&#39;</span><span class="token punctuation">,</span> plottable<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token comment">## 打印matplotlib版本</span>
<span class="token keyword">import</span> matplotlib <span class="token keyword">as</span> plt
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;matplotlib version:&#39;</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>plottable version: 0.1.5
matplotlib version: 3.5.3
</code></pre><p>[toc]</p><h2 id="_1-使用说明" tabindex="-1"><a class="header-anchor" href="#_1-使用说明" aria-hidden="true">#</a> 1 使用说明</h2><h3 id="_1-1-基础使用" tabindex="-1"><a class="header-anchor" href="#_1-1-基础使用" aria-hidden="true">#</a> 1.1 基础使用</h3><p>下面的代码展示了一个简单的图形表格绘制示例，plottable提供了Table类以创建和展示图形表格。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">from</span> plottable <span class="token keyword">import</span> Table

<span class="token comment">## 生成一个包含随机数据的表格</span>
d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## 基于pandas表格数据创建和展示图形表格</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">)</span>

<span class="token comment">## 保存图片</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&quot;table.jpg&quot;</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>bbox_inches<span class="token operator">=</span><span class="token string">&#39;tight&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_4_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p>对于plottable的Table类，其构造参数介绍如下：</p><ul><li>df: pd.DataFrame, 要显示为表格的DataFrame对象</li><li>ax: mpl.axes.Axes, 绘制表格的坐标轴对象，默认为None</li><li>index_col: str, DataFrame中的索引列名。默认为None</li><li>columns: List[str], 哪些列用于绘图。为None表示使用所有列</li><li>column_definitions: List[ColumnDefinition], 需要设置样式列的style定义类，默认为None</li><li>textprops: Dict[str, Any], 文本属性的字典，默认为空字典</li><li>cell_kw: Dict[str, Any], 单元格属性的字典，默认为空字典</li><li>col_label_cell_kw: Dict[str, Any], 列标签单元格属性的字典，默认为空字典</li><li>col_label_divider: bool, 是否在列标签下方绘制分隔线，默认为True。</li><li>footer_divider: bool, 是否在表格下方绘制分隔线，默认为False。</li><li>row_dividers: bool, 是否显示行分隔线，默认为True</li><li>row_divider_kw: Dict[str, Any], 行分隔线属性的字典，默认为空字典</li><li>col_label_divider_kw: Dict[str, Any], 列标签分隔线属性的字典，默认为空字典</li><li>footer_divider_kw: Dict[str, Any], 页脚分隔线属性的字典，默认为空字典</li><li>column_border_kw: Dict[str, Any], 列边框属性的字典，默认为空字典</li><li>even_row_color: str | Tuple, 偶数行单元格的填充颜色，默认为None</li><li>odd_row_color: str | Tuple, 奇数行单元格的填充颜色，默认为None</li></ul><p>在这些参数之中，控制表格绘图效果的参数有以下几类：</p><ul><li>column_definitions：列的样式自定义</li><li>textprops：文本的样样式自定义</li><li>cell_kw：表格单元格的样式自定义</li><li>其他设置参数的样式</li></ul><p>在这些参数中，最重要的参数是column_definitions，因为column_definitions可以控制几乎所有的绘图效果。接下来本文主要对column_definitions的使用进行具体介绍。</p><h3 id="_1-2-列的样式自定义" tabindex="-1"><a class="header-anchor" href="#_1-2-列的样式自定义" aria-hidden="true">#</a> 1.2 列的样式自定义</h3><p>plottable提供了ColumnDefinition类（别名ColDef）来自定义图形表格的单个列的样式。ColumnDefinition类的构造参数如下：</p><ul><li>name: str，要设置绘图效果的列名</li><li>title: str = None，用于覆盖列名的绘图标题</li><li>width: float = 1，列的宽度，默认情况下各列的宽度为轴的宽度/列的总数</li><li>textprops: Dict[str, Any] = field(default_factory=dict)，提供给每个文本单元格的文本属性</li><li>formatter: Callable = None，用于格式化文本外观的可调用函数</li><li>cmap: Callable = None，根据单元格的值返回颜色的可调用函数</li><li>text_cmap: Callable = None，根据单元格的值返回颜色的可调用函数</li><li>group: str = None，设置每个组都会在列标签上方显示的分组列标签</li><li>plot_fn: Callable = None，一个可调用函数，将单元格的值作为输入，并在每个单元格上创建一个子图并绘制在其上 要向其传递其他参数</li><li>plot_kw: Dict[str, Any] = field(default_factory=dict)，提供给plot_fn的附加关键字参数</li><li>border: str | List = None，绘制垂直边界线，可以是&quot;left&quot; / &quot;l&quot;、&quot;right&quot; / &quot;r&quot;或&quot;both&quot;</li></ul><p>通过ColumnDefinition类来设置Table类的column_definitions参数，可以实现不同表格列样式的效果。如果是同时多个列的绘图效果，则需要使用[ColumnDefinition,ColumnDefinition]列表的形式。一些使用示例如下</p><p><strong>设置列标题和列宽</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> plottable <span class="token keyword">import</span> ColumnDefinition<span class="token punctuation">,</span> ColDef<span class="token punctuation">,</span> Table

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## name表示设置哪个列的样式</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">,</span> column_definitions<span class="token operator">=</span><span class="token punctuation">[</span>ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;Title A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                   ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_8_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p><strong>设置列的文字属性和文本格式</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> plottable<span class="token punctuation">.</span>formatters <span class="token keyword">import</span> decimal_to_percent

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## index列的文字居中，加粗</span>
<span class="token comment">## 列A的文本数值改为百分制</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">,</span> column_definitions<span class="token operator">=</span><span class="token punctuation">[</span>ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">,</span> textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;weight&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;bold&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                   ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span>decimal_to_percent<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_10_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p><strong>设置列单元格背景色和字体颜色</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> plottable<span class="token punctuation">.</span>cmap <span class="token keyword">import</span> normed_cmap
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>cm

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## cmap设置单元格背景色</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">,</span> column_definitions<span class="token operator">=</span><span class="token punctuation">[</span>ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>matplotlib<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>tab20<span class="token punctuation">,</span> text_cmap<span class="token operator">=</span>matplotlib<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Reds<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                   ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>matplotlib<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>tab20b<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                   ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> text_cmap<span class="token operator">=</span>matplotlib<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>tab20c<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_12_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p><strong>设置列的分组名</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> plottable<span class="token punctuation">.</span>cmap <span class="token keyword">import</span> normed_cmap
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>cm

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## 将列B和列C视为同一组，该组命名为group_name</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">,</span> column_definitions<span class="token operator">=</span><span class="token punctuation">[</span>ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> group<span class="token operator">=</span><span class="token string">&quot;group_name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                   ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> group<span class="token operator">=</span><span class="token string">&quot;group_name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_14_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p><strong>设置列边框</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> plottable<span class="token punctuation">.</span>cmap <span class="token keyword">import</span> normed_cmap
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>cm

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## 将列B和列C视为同一组，该组命名为group_name</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">,</span> column_definitions<span class="token operator">=</span><span class="token punctuation">[</span>ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token string">&quot;l&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                   ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span>  border<span class="token operator">=</span><span class="token string">&quot;both&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_16_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p><strong>调用函数的使用</strong></p><p>ColumnDefinition类的plot_fn和plot_kw参数提供了自定义函数实现表格效果绘制的功能。其中plot_fn表示待调用的函数，plot_kw表示待调用函数的输入参数。此外在plotable.plots预置了一些效果函数，我们可以参考这些效果函数定义自己的绘图函数。预置效果函数如下：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
<span class="token keyword">import</span> matplotlib
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>colors <span class="token keyword">import</span> LinearSegmentedColormap
<span class="token keyword">from</span> plottable <span class="token keyword">import</span> ColumnDefinition<span class="token punctuation">,</span> Table
<span class="token comment">## 调用预置绘图函数</span>
<span class="token keyword">from</span> plottable<span class="token punctuation">.</span>plots <span class="token keyword">import</span> image<span class="token punctuation">,</span>monochrome_image<span class="token punctuation">,</span>circled_image<span class="token punctuation">,</span>bar<span class="token punctuation">,</span>percentile_bars<span class="token punctuation">,</span>percentile_stars<span class="token punctuation">,</span>progress_donut

cmap <span class="token operator">=</span> matplotlib<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>tab20
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 柱状图绘制</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## 0.7表示数值,lw边框线宽</span>
b <span class="token operator">=</span> bar<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span> plot_bg_bar<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>cmap<span class="token punctuation">,</span> annotate<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> lw<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">0.35</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_19_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 星星百分比图</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
stars <span class="token operator">=</span> percentile_stars<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> background_color<span class="token operator">=</span><span class="token string">&quot;#f0f0f0&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_20_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 圆环图</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
donut <span class="token operator">=</span> progress_donut<span class="token punctuation">(</span>ax<span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;fontsize&quot;</span><span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_21_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p>对于待调用的函数，可以通过help函数查看这些函数的参数含义。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token builtin">help</span><span class="token punctuation">(</span>progress_donut<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><pre><code>Help on function progress_donut in module plottable.plots:

progress_donut(ax: matplotlib.axes._axes.Axes, val: float, radius: float = 0.45, color: str = None, background_color: str = None, width: float = 0.05, is_pct: bool = False, textprops: Dict[str, Any] = {}, formatter: Callable = None, **kwargs) -&gt; List[matplotlib.patches.Wedge]
    Plots a Progress Donut on the axes.
    
    Args:
        ax (matplotlib.axes.Axes): Axes
        val (float): value
        radius (float, optional):
            radius of the progress donut. Defaults to 0.45.
        color (str, optional):
            color of the progress donut. Defaults to None.
        background_color (str, optional):
            background_color of the progress donut where the value is not reached. Defaults to None.
        width (float, optional):
            width of the donut wedge. Defaults to 0.05.
        is_pct (bool, optional):
            whether the value is given not as a decimal, but as a value between 0 and 100.
            Defaults to False.
        textprops (Dict[str, Any], optional):
            textprops passed to ax.text. Defaults to {}.
        formatter (Callable, optional):
            a string formatter.
            Can either be a string format, ie &quot;{:2f}&quot; for 2 decimal places.
            Or a Callable that is applied to the value. Defaults to None.
    
    Returns:
        List[matplotlib.patches.Wedge]
</code></pre><p>通过plot_fn和plot_kw参数设置自定义绘图函数和函数输入参数，可以展示不同的绘图效果，如下所示：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> plottable<span class="token punctuation">.</span>cmap <span class="token keyword">import</span> normed_cmap
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>cm

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## plot_fn和plot_kw</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">,</span> textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            column_definitions<span class="token operator">=</span><span class="token punctuation">[</span>ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> plot_fn<span class="token operator">=</span>bar<span class="token punctuation">,</span>plot_kw<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;plot_bg_bar&#39;</span><span class="token punctuation">:</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">&#39;cmap&#39;</span><span class="token punctuation">:</span>cmap<span class="token punctuation">,</span> 
                                <span class="token string">&#39;annotate&#39;</span><span class="token punctuation">:</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">&#39;height&#39;</span><span class="token punctuation">:</span><span class="token number">0.5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> plot_fn<span class="token operator">=</span>progress_donut<span class="token punctuation">,</span>plot_kw<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;is_pct&#39;</span><span class="token punctuation">:</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_25_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p><strong>自定义文字格式</strong></p><p>plottable提供了以下三个自定义函数来表示不同的文字格式：</p><ul><li>decimal_to_percent：将数值数据变为百分比</li><li>tickcross：将数值格式化为✔或✖</li><li>signed_integer：添加正负符号</li></ul><p>我们可以通过ColumnDefinition的formatter来设置文字格式，如下所示：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> plottable <span class="token keyword">import</span> ColumnDefinition<span class="token punctuation">,</span> Table
<span class="token keyword">from</span> plottable<span class="token punctuation">.</span>formatters <span class="token keyword">import</span> decimal_to_percent<span class="token punctuation">,</span>tickcross<span class="token punctuation">,</span>signed_integer

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">,</span> column_definitions<span class="token operator">=</span><span class="token punctuation">[</span>ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span>decimal_to_percent<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                   ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span>tickcross<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                   ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span>signed_integer<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_27_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p>此外，也可以自定义函数来设置文本格式，如下所示：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">setformat</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">## 使用format格式函数</span>
    <span class="token keyword">return</span> <span class="token string">&quot;{:.2e}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">,</span> textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>column_definitions<span class="token operator">=</span><span class="token punctuation">[</span>ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span>setformat<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                   ColumnDefinition<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">round</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_29_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h3 id="_1-3-行列自定义" tabindex="-1"><a class="header-anchor" href="#_1-3-行列自定义" aria-hidden="true">#</a> 1.3 行列自定义</h3><p><strong>访问行列单元格</strong></p><p>plottable提供了直接访问Table实例的某一行、某一列的方法，如下所示：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> plottable<span class="token punctuation">.</span>cmap <span class="token keyword">import</span> normed_cmap
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>cm

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## 实例化Table对象</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_31_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 根据列名，提取整列</span>
tab<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>Column(cells=[TextCell(xy=(1, 0), content=0.0, row_idx=0, col_idx=1), TextCell(xy=(1, 1), content=0.09, row_idx=1, col_idx=1), TextCell(xy=(1, 2), content=0.95, row_idx=2, col_idx=1), TextCell(xy=(1, 3), content=0.08, row_idx=3, col_idx=1), TextCell(xy=(1, 4), content=0.92, row_idx=4, col_idx=1)], index=1)
</code></pre><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 读取某列第1行的内容</span>
tab<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>content
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>0.04
</code></pre><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 根据行索引，提取整行</span>
tab<span class="token punctuation">.</span>rows<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>Row(cells=[TextCell(xy=(0, 1), content=1, row_idx=1, col_idx=0), TextCell(xy=(1, 1), content=0.09, row_idx=1, col_idx=1), TextCell(xy=(2, 1), content=0.04, row_idx=1, col_idx=2), TextCell(xy=(3, 1), content=0.42, row_idx=1, col_idx=3), TextCell(xy=(4, 1), content=0.64, row_idx=1, col_idx=4), TextCell(xy=(5, 1), content=0.26, row_idx=1, col_idx=5)], index=1)
</code></pre><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 提取表头列名</span>
tab<span class="token punctuation">.</span>col_label_row
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>Row(cells=[TextCell(xy=(0, -1), content=index, row_idx=-1, col_idx=0), TextCell(xy=(1, -1), content=A, row_idx=-1, col_idx=1), TextCell(xy=(2, -1), content=B, row_idx=-1, col_idx=2), TextCell(xy=(3, -1), content=C, row_idx=-1, col_idx=3), TextCell(xy=(4, -1), content=D, row_idx=-1, col_idx=4), TextCell(xy=(5, -1), content=E, row_idx=-1, col_idx=5)], index=-1)
</code></pre><p><strong>设置单元格样式</strong></p><p>在上面的例子可以看到plottable直接访问表格行列对象，因此我们可以通过设置这些对象的绘图属性来直接更改其绘图效果或文字效果，所支持更改的属性如下：</p><ul><li>单元格属性 <ul><li>set_alpha：设置单元格的透明度。</li><li>set_color：设置单元格的颜色。</li><li>set_edgecolor：设置单元格边缘的颜色。</li><li>set_facecolor：设置单元格内部的颜色。</li><li>set_fill：设置单元格是否填充。</li><li>set_hatch：设置单元格的填充图案。</li><li>set_linestyle：设置单元格边缘线的样式。</li><li>set_linewidth：设置单元格边缘线的宽度。</li></ul></li><li>字体属性 <ul><li>set_fontcolor：设置字体的颜色。</li><li>set_fontfamily：设置字体的家族。</li><li>set_fontsize：设置字体的大小。</li><li>set_ha：设置文本的水平对齐方式。</li><li>set_ma：设置文本的垂直对齐方式。</li></ul></li></ul><p>示例代码如下：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> plottable<span class="token punctuation">.</span>cmap <span class="token keyword">import</span> normed_cmap
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>cm

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">## 实例化Table对象</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token comment">## 设置行号为1的行的背景颜色</span>
tab<span class="token punctuation">.</span>rows<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span><span class="token string">&quot;grey&quot;</span><span class="token punctuation">)</span>
<span class="token comment">## 设置B列的字体颜色</span>
tab<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_fontcolor<span class="token punctuation">(</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>Column(cells=[TextCell(xy=(2, 0), content=0.38, row_idx=0, col_idx=2), TextCell(xy=(2, 1), content=0.69, row_idx=1, col_idx=2), TextCell(xy=(2, 2), content=0.15, row_idx=2, col_idx=2), TextCell(xy=(2, 3), content=0.74, row_idx=3, col_idx=2), TextCell(xy=(2, 4), content=0.41, row_idx=4, col_idx=2)], index=2)
</code></pre><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_37_1.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h2 id="_2-绘图实例" tabindex="-1"><a class="header-anchor" href="#_2-绘图实例" aria-hidden="true">#</a> 2 绘图实例</h2><h3 id="_2-1-多行样式设置" tabindex="-1"><a class="header-anchor" href="#_2-1-多行样式设置" aria-hidden="true">#</a> 2.1 多行样式设置</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">from</span> plottable <span class="token keyword">import</span> Table

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## row_dividers显示行的分割线</span>
<span class="token comment">## odd_row_color奇数行颜色</span>
<span class="token comment">## even_row_color偶数行颜色</span>
tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>d<span class="token punctuation">,</span> row_dividers<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> odd_row_color<span class="token operator">=</span><span class="token string">&quot;#f0f0f0&quot;</span><span class="token punctuation">,</span> even_row_color<span class="token operator">=</span><span class="token string">&quot;#e0f6ff&quot;</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&quot;table.jpg&quot;</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>bbox_inches<span class="token operator">=</span><span class="token string">&#39;tight&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_40_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h3 id="_2-2-自定义单元格效果" tabindex="-1"><a class="header-anchor" href="#_2-2-自定义单元格效果" aria-hidden="true">#</a> 2.2 自定义单元格效果</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>colors <span class="token keyword">import</span> LinearSegmentedColormap

<span class="token keyword">from</span> plottable <span class="token keyword">import</span> ColumnDefinition<span class="token punctuation">,</span> Table
<span class="token keyword">from</span> plottable<span class="token punctuation">.</span>formatters <span class="token keyword">import</span> decimal_to_percent
<span class="token keyword">from</span> plottable<span class="token punctuation">.</span>plots <span class="token keyword">import</span> bar<span class="token punctuation">,</span> percentile_bars<span class="token punctuation">,</span> percentile_stars<span class="token punctuation">,</span> progress_donut

<span class="token comment">## 自定义颜色</span>
cmap <span class="token operator">=</span> LinearSegmentedColormap<span class="token punctuation">.</span>from_list<span class="token punctuation">(</span>
    name<span class="token operator">=</span><span class="token string">&quot;BuYl&quot;</span><span class="token punctuation">,</span> colors<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;#01a6ff&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#eafedb&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#fffdbb&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ffc834&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> N<span class="token operator">=</span><span class="token number">256</span>
<span class="token punctuation">)</span>

fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>
    d<span class="token punctuation">,</span>
    cell_kw<span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token string">&quot;linewidth&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;edgecolor&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;k&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    column_definitions<span class="token operator">=</span><span class="token punctuation">[</span>
        ColumnDefinition<span class="token punctuation">(</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">,</span> textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        ColumnDefinition<span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span> plot_fn<span class="token operator">=</span>percentile_bars<span class="token punctuation">,</span> plot_kw<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;is_pct&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        ColumnDefinition<span class="token punctuation">(</span>
            <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">,</span> plot_fn<span class="token operator">=</span>percentile_stars<span class="token punctuation">,</span> plot_kw<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;is_pct&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        ColumnDefinition<span class="token punctuation">(</span>
            <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span>
            plot_fn<span class="token operator">=</span>progress_donut<span class="token punctuation">,</span>
            plot_kw<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token string">&quot;is_pct&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token string">&quot;formatter&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;{:.0%}&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        ColumnDefinition<span class="token punctuation">(</span>
            <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span>
            width<span class="token operator">=</span><span class="token number">1.25</span><span class="token punctuation">,</span>
            plot_fn<span class="token operator">=</span>bar<span class="token punctuation">,</span>
            plot_kw<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token string">&quot;cmap&quot;</span><span class="token punctuation">:</span> cmap<span class="token punctuation">,</span>
                <span class="token string">&quot;plot_bg_bar&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token string">&quot;annotate&quot;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
                <span class="token string">&quot;height&quot;</span><span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lw&quot;</span><span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
                <span class="token string">&quot;formatter&quot;</span><span class="token punctuation">:</span> decimal_to_percent<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_42_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h3 id="_2-3-热图" tabindex="-1"><a class="header-anchor" href="#_2-3-热图" aria-hidden="true">#</a> 2.3 热图</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>colors <span class="token keyword">import</span> LinearSegmentedColormap
<span class="token comment">## ColDef是ColumnDefinition的别名</span>
<span class="token keyword">from</span> plottable <span class="token keyword">import</span> ColDef<span class="token punctuation">,</span> Table

<span class="token comment">## 自定义颜色</span>
cmap <span class="token operator">=</span> LinearSegmentedColormap<span class="token punctuation">.</span>from_list<span class="token punctuation">(</span>
    name<span class="token operator">=</span><span class="token string">&quot;bugw&quot;</span><span class="token punctuation">,</span> colors<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;#ffffff&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#f2fbd2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#c9ecb4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#93d3ab&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#35b0ab&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> N<span class="token operator">=</span><span class="token number">256</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 创建数据</span>
cities <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;TORONTO&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;VANCOUVER&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;HALIFAX&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;CALGARY&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;OTTAWA&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;MONTREAL&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;WINNIPEG&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;EDMONTON&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;LONDON&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;ST. JONES&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
months <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;JAN&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;FEB&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;MAR&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;APR&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;MAY&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;JUN&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;JUL&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;AUG&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;SEP&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;OCT&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;NOV&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;DEC&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

data <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">5.5</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> data <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>shape
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>(10, 12)
</code></pre><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 绘图</span>
d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> columns<span class="token operator">=</span>months<span class="token punctuation">,</span> index<span class="token operator">=</span>cities<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## 自定义各列的绘图效果</span>
column_definitions <span class="token operator">=</span> <span class="token punctuation">[</span>
    ColDef<span class="token punctuation">(</span>name<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cmap<span class="token punctuation">,</span> formatter<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token keyword">for</span> name <span class="token keyword">in</span> months
<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>ColDef<span class="token punctuation">(</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">,</span> textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;right&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

tab <span class="token operator">=</span> Table<span class="token punctuation">(</span>
    d<span class="token punctuation">,</span>
    column_definitions<span class="token operator">=</span>column_definitions<span class="token punctuation">,</span>
    row_dividers<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    col_label_divider<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fontname&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Roboto&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">## 设置各个单元格的效果</span>
    cell_kw<span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token string">&quot;edgecolor&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;black&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;linewidth&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>


<span class="token comment">## 设置列标题文字和背景颜色</span>
tab<span class="token punctuation">.</span>col_label_row<span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span><span class="token string">&quot;white&quot;</span><span class="token punctuation">)</span>
tab<span class="token punctuation">.</span>col_label_row<span class="token punctuation">.</span>set_fontcolor<span class="token punctuation">(</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span>
<span class="token comment">## 设置行标题文字和背景颜色</span>
tab<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span>
tab<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_fontcolor<span class="token punctuation">(</span><span class="token string">&quot;white&quot;</span><span class="token punctuation">)</span>
tab<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_linewidth<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_46_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h3 id="_2-4-女子世界杯预测数据展示" tabindex="-1"><a class="header-anchor" href="#_2-4-女子世界杯预测数据展示" aria-hidden="true">#</a> 2.4 女子世界杯预测数据展示</h3><p><strong>step1 准备数据</strong></p>`,91),b={href:"https://github.com/znstrider/plottable/tree/master/docs/example_notebooks",target:"_blank",rel:"noopener noreferrer"},g=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 下载数据集</span>
<span class="token comment">## !wget https://raw.githubusercontent.com/znstrider/plottable/master/docs/example_notebooks/data/wwc_forecasts.csv</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path

<span class="token keyword">import</span> matplotlib
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>colors <span class="token keyword">import</span> LinearSegmentedColormap

<span class="token keyword">from</span> plottable <span class="token keyword">import</span> ColumnDefinition<span class="token punctuation">,</span> Table
<span class="token keyword">from</span> plottable<span class="token punctuation">.</span>cmap <span class="token keyword">import</span> normed_cmap
<span class="token keyword">from</span> plottable<span class="token punctuation">.</span>formatters <span class="token keyword">import</span> decimal_to_percent
<span class="token keyword">from</span> plottable<span class="token punctuation">.</span>plots <span class="token keyword">import</span> circled_image <span class="token comment">## image</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>cols <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;team&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;points&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;group&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;spi&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;global_o&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;global_d&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;group_1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;group_2&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;group_3&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;make_round_of_16&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;make_quarters&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;make_semis&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;make_final&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;win_league&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment">## 读取数据</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>
    <span class="token string">&quot;data/wwc_forecasts.csv&quot;</span><span class="token punctuation">,</span>
    usecols<span class="token operator">=</span>cols<span class="token punctuation">,</span>
<span class="token punctuation">)</span>

<span class="token comment">## 展示数据</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>team</th><th>group</th><th>spi</th><th>global_o</th><th>global_d</th><th>group_1</th><th>group_2</th><th>group_3</th><th>make_round_of_16</th><th>make_quarters</th><th>make_semis</th><th>make_final</th><th>win_league</th><th>points</th></tr></thead><tbody><tr><th>0</th><td>USA</td><td>F</td><td>98.32748</td><td>5.52561</td><td>0.58179</td><td>0.82956</td><td>0.17044</td><td>0.00000</td><td>1.0</td><td>0.78079</td><td>0.47307</td><td>0.35076</td><td>0.23618</td><td>6</td></tr><tr><th>1</th><td>France</td><td>A</td><td>96.29671</td><td>4.31375</td><td>0.52137</td><td>0.99483</td><td>0.00515</td><td>0.00002</td><td>1.0</td><td>0.78367</td><td>0.42052</td><td>0.30038</td><td>0.19428</td><td>6</td></tr><tr><th>2</th><td>Germany</td><td>B</td><td>93.76549</td><td>3.96791</td><td>0.67818</td><td>0.98483</td><td>0.01517</td><td>0.00000</td><td>1.0</td><td>0.89280</td><td>0.48039</td><td>0.27710</td><td>0.12256</td><td>6</td></tr><tr><th>3</th><td>Canada</td><td>E</td><td>93.51599</td><td>3.67537</td><td>0.56980</td><td>0.38830</td><td>0.61170</td><td>0.00000</td><td>1.0</td><td>0.59192</td><td>0.36140</td><td>0.20157</td><td>0.09031</td><td>6</td></tr><tr><th>4</th><td>England</td><td>D</td><td>91.92311</td><td>3.51560</td><td>0.63717</td><td>0.70570</td><td>0.29430</td><td>0.00000</td><td>1.0</td><td>0.68510</td><td>0.43053</td><td>0.16465</td><td>0.08003</td><td>6</td></tr></tbody></table></div>`,4),h={href:"https://github.com/znstrider/plottable/tree/master/docs/example_notebooks",target:"_blank",rel:"noopener noreferrer"},q=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 读取图片路径</span>
flag_paths <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>Path<span class="token punctuation">(</span><span class="token string">&quot;data/country_flags&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;*.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
country_to_flagpath <span class="token operator">=</span> <span class="token punctuation">{</span>p<span class="token punctuation">.</span>stem<span class="token punctuation">:</span> p <span class="token keyword">for</span> p <span class="token keyword">in</span> flag_paths<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>step2 数据处理</strong></p><p>该步需要合并数据，将其转换为plottable可用的数据结构。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 重置列名</span>
colnames <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;Team&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Points&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Group&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;SPI&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;OFF&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;DEF&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;1st Place&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;2nd Place&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;3rd Place&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Make Rd Of 16&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Make Quarters&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Make Semis&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Make Finals&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Win World Cup&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

col_to_name <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>cols<span class="token punctuation">,</span> colnames<span class="token punctuation">)</span><span class="token punctuation">)</span>
col_to_name
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>{&#39;team&#39;: &#39;Team&#39;,
 &#39;points&#39;: &#39;Points&#39;,
 &#39;group&#39;: &#39;Group&#39;,
 &#39;spi&#39;: &#39;SPI&#39;,
 &#39;global_o&#39;: &#39;OFF&#39;,
 &#39;global_d&#39;: &#39;DEF&#39;,
 &#39;group_1&#39;: &#39;1st Place&#39;,
 &#39;group_2&#39;: &#39;2nd Place&#39;,
 &#39;group_3&#39;: &#39;3rd Place&#39;,
 &#39;make_round_of_16&#39;: &#39;Make Rd Of 16&#39;,
 &#39;make_quarters&#39;: &#39;Make Quarters&#39;,
 &#39;make_semis&#39;: &#39;Make Semis&#39;,
 &#39;make_final&#39;: &#39;Make Finals&#39;,
 &#39;win_league&#39;: &#39;Win World Cup&#39;}
</code></pre><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;spi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;global_o&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;global_d&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;spi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;global_o&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;global_d&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>col_to_name<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">## 删除Points列</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">&quot;Points&quot;</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">## 插入列</span>
df<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;Flag&quot;</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&quot;Team&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> country_to_flagpath<span class="token punctuation">.</span>get<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&quot;Team&quot;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>Flag</th><th>Group</th><th>SPI</th><th>OFF</th><th>DEF</th><th>1st Place</th><th>2nd Place</th><th>3rd Place</th><th>Make Rd Of 16</th><th>Make Quarters</th><th>Make Semis</th><th>Make Finals</th><th>Win World Cup</th></tr><tr><th>Team</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>USA</th><td>data/country_flags/USA.png</td><td>F</td><td>98.3</td><td>5.5</td><td>0.6</td><td>0.82956</td><td>0.17044</td><td>0.00000</td><td>1.0</td><td>0.78079</td><td>0.47307</td><td>0.35076</td><td>0.23618</td></tr><tr><th>France</th><td>data/country_flags/France.png</td><td>A</td><td>96.3</td><td>4.3</td><td>0.5</td><td>0.99483</td><td>0.00515</td><td>0.00002</td><td>1.0</td><td>0.78367</td><td>0.42052</td><td>0.30038</td><td>0.19428</td></tr><tr><th>Germany</th><td>data/country_flags/Germany.png</td><td>B</td><td>93.8</td><td>4.0</td><td>0.7</td><td>0.98483</td><td>0.01517</td><td>0.00000</td><td>1.0</td><td>0.89280</td><td>0.48039</td><td>0.27710</td><td>0.12256</td></tr><tr><th>Canada</th><td>data/country_flags/Canada.png</td><td>E</td><td>93.5</td><td>3.7</td><td>0.6</td><td>0.38830</td><td>0.61170</td><td>0.00000</td><td>1.0</td><td>0.59192</td><td>0.36140</td><td>0.20157</td><td>0.09031</td></tr><tr><th>England</th><td>data/country_flags/England.png</td><td>D</td><td>91.9</td><td>3.5</td><td>0.6</td><td>0.70570</td><td>0.29430</td><td>0.00000</td><td>1.0</td><td>0.68510</td><td>0.43053</td><td>0.16465</td><td>0.08003</td></tr></tbody></table></div><p><strong>step3 绘图</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 设置颜色</span>
cmap <span class="token operator">=</span> LinearSegmentedColormap<span class="token punctuation">.</span>from_list<span class="token punctuation">(</span>
    name<span class="token operator">=</span><span class="token string">&quot;bugw&quot;</span><span class="token punctuation">,</span> colors<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;#ffffff&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#f2fbd2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#c9ecb4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#93d3ab&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#35b0ab&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> N<span class="token operator">=</span><span class="token number">256</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>team_rating_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;SPI&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;OFF&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;DEF&quot;</span><span class="token punctuation">]</span>
group_stage_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;1st Place&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2nd Place&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3rd Place&quot;</span><span class="token punctuation">]</span>
knockout_stage_cols <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">## 单独设置每一列的绘制参数</span>
col_defs <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token comment">## 绘制第一部分效果</span>
    <span class="token punctuation">[</span>
        ColumnDefinition<span class="token punctuation">(</span>
            name<span class="token operator">=</span><span class="token string">&quot;Flag&quot;</span><span class="token punctuation">,</span>
            title<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
            textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>
            <span class="token comment">## 设置自定义效果展示函数</span>
            plot_fn<span class="token operator">=</span>circled_image<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        ColumnDefinition<span class="token punctuation">(</span>
            name<span class="token operator">=</span><span class="token string">&quot;Team&quot;</span><span class="token punctuation">,</span>
            textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;weight&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;bold&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            width<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        ColumnDefinition<span class="token punctuation">(</span>
            name<span class="token operator">=</span><span class="token string">&quot;Group&quot;</span><span class="token punctuation">,</span>
            textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            width<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        ColumnDefinition<span class="token punctuation">(</span>
            name<span class="token operator">=</span><span class="token string">&quot;SPI&quot;</span><span class="token punctuation">,</span>
            group<span class="token operator">=</span><span class="token string">&quot;Team Rating&quot;</span><span class="token punctuation">,</span>
            textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            width<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        ColumnDefinition<span class="token punctuation">(</span>
            name<span class="token operator">=</span><span class="token string">&quot;OFF&quot;</span><span class="token punctuation">,</span>
            width<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">,</span>
            textprops<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">,</span>
                <span class="token comment">## 设置填充方式</span>
                <span class="token string">&quot;bbox&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;boxstyle&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;circle&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pad&quot;</span><span class="token punctuation">:</span> <span class="token number">0.35</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            cmap<span class="token operator">=</span>normed_cmap<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&quot;OFF&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>matplotlib<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>PiYG<span class="token punctuation">,</span> num_stds<span class="token operator">=</span><span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            group<span class="token operator">=</span><span class="token string">&quot;Team Rating&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        ColumnDefinition<span class="token punctuation">(</span>
            name<span class="token operator">=</span><span class="token string">&quot;DEF&quot;</span><span class="token punctuation">,</span>
            width<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">,</span>
            textprops<span class="token operator">=</span><span class="token punctuation">{</span>
                <span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;bbox&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;boxstyle&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;circle&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pad&quot;</span><span class="token punctuation">:</span> <span class="token number">0.35</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            cmap<span class="token operator">=</span>normed_cmap<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&quot;DEF&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>matplotlib<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>PiYG_r<span class="token punctuation">,</span> num_stds<span class="token operator">=</span><span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            group<span class="token operator">=</span><span class="token string">&quot;Team Rating&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
    <span class="token comment">## 绘制第二部分效果</span>
    <span class="token operator">+</span> <span class="token punctuation">[</span>
        ColumnDefinition<span class="token punctuation">(</span>
            name<span class="token operator">=</span>group_stage_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            title<span class="token operator">=</span>group_stage_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\\n&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            formatter<span class="token operator">=</span>decimal_to_percent<span class="token punctuation">,</span>
            group<span class="token operator">=</span><span class="token string">&quot;Group Stage Chances&quot;</span><span class="token punctuation">,</span>
            <span class="token comment">## 设置边框</span>
            border<span class="token operator">=</span><span class="token string">&quot;left&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
    <span class="token operator">+</span> <span class="token punctuation">[</span>
        ColumnDefinition<span class="token punctuation">(</span>
            name<span class="token operator">=</span>col<span class="token punctuation">,</span>
            title<span class="token operator">=</span>col<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\\n&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            formatter<span class="token operator">=</span>decimal_to_percent<span class="token punctuation">,</span>
            group<span class="token operator">=</span><span class="token string">&quot;Group Stage Chances&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">for</span> col <span class="token keyword">in</span> group_stage_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
    <span class="token comment">## 绘制第三部分效果</span>
    <span class="token operator">+</span> <span class="token punctuation">[</span>
        ColumnDefinition<span class="token punctuation">(</span>
            name<span class="token operator">=</span>knockout_stage_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            title<span class="token operator">=</span>knockout_stage_cols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\\n&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            formatter<span class="token operator">=</span>decimal_to_percent<span class="token punctuation">,</span>
            cmap<span class="token operator">=</span>cmap<span class="token punctuation">,</span>
            group<span class="token operator">=</span><span class="token string">&quot;Knockout Stage Chances&quot;</span><span class="token punctuation">,</span>
            border<span class="token operator">=</span><span class="token string">&quot;left&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
    <span class="token operator">+</span> <span class="token punctuation">[</span>
        ColumnDefinition<span class="token punctuation">(</span>
            name<span class="token operator">=</span>col<span class="token punctuation">,</span>
            title<span class="token operator">=</span>col<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\\n&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            formatter<span class="token operator">=</span>decimal_to_percent<span class="token punctuation">,</span>
            cmap<span class="token operator">=</span>cmap<span class="token punctuation">,</span>
            group<span class="token operator">=</span><span class="token string">&quot;Knockout Stage Chances&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">for</span> col <span class="token keyword">in</span> knockout_stage_cols<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 绘图</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

table <span class="token operator">=</span> Table<span class="token punctuation">(</span>
    df<span class="token punctuation">,</span>
    column_definitions<span class="token operator">=</span>col_defs<span class="token punctuation">,</span>
    row_dividers<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    footer_divider<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    ax<span class="token operator">=</span>ax<span class="token punctuation">,</span>
    textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;fontsize&quot;</span><span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    row_divider_kw<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;linewidth&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;linestyle&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    col_label_divider_kw<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;linewidth&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;linestyle&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    column_border_kw<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;linewidth&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;linestyle&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span>autoset_fontcolors<span class="token punctuation">(</span>colnames<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;OFF&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;DEF&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">## 保存图片</span>
fig<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&quot;wwc_table.jpg&quot;</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span>ax<span class="token punctuation">.</span>get_facecolor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>bbox_inches<span class="token operator">=</span><span class="token string">&#39;tight&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_60_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h3 id="_2-5-德甲积分排名榜展示" tabindex="-1"><a class="header-anchor" href="#_2-5-德甲积分排名榜展示" aria-hidden="true">#</a> 2.5 德甲积分排名榜展示</h3><p><strong>step1 准备数据</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path

<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">from</span> plottable <span class="token keyword">import</span> ColDef<span class="token punctuation">,</span> Table
<span class="token keyword">from</span> plottable<span class="token punctuation">.</span>plots <span class="token keyword">import</span> image
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 下载联赛数据</span>
<span class="token comment">## !wget https://projects.fivethirtyeight.com/soccer-api/club/spi_matches.csv</span>
<span class="token comment">## !wget https://projects.fivethirtyeight.com/soccer-api/club/spi_matches_latest.csv</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 数据地址</span>
FIVETHIRTYEIGHT_URLS <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;SPI_MATCHES&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;https://projects.fivethirtyeight.com/soccer-api/club/spi_matches.csv&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;SPI_MATCHES_LATEST&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;https://projects.fivethirtyeight.com/soccer-api/club/spi_matches_latest.csv&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">## 读取数据</span>
<span class="token comment">## df = pd.read_csv(FIVETHIRTYEIGHT_URLS[&quot;SPI_MATCHES_LATEST&quot;])</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/spi_matches_latest.csv&quot;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>season</th><th>date</th><th>league_id</th><th>league</th><th>team1</th><th>team2</th><th>spi1</th><th>spi2</th><th>prob1</th><th>prob2</th><th>...</th><th>importance1</th><th>importance2</th><th>score1</th><th>score2</th><th>xg1</th><th>xg2</th><th>nsxg1</th><th>nsxg2</th><th>adj_score1</th><th>adj_score2</th></tr></thead><tbody><tr><th>0</th><td>2019</td><td>2019-03-01</td><td>1979</td><td>Chinese Super League</td><td>Shandong Luneng</td><td>Guizhou Renhe</td><td>48.22</td><td>37.83</td><td>0.5755</td><td>0.1740</td><td>...</td><td>45.9</td><td>22.1</td><td>1.0</td><td>0.0</td><td>1.39</td><td>0.26</td><td>2.05</td><td>0.54</td><td>1.05</td><td>0.00</td></tr><tr><th>1</th><td>2019</td><td>2019-03-01</td><td>1979</td><td>Chinese Super League</td><td>Shanghai Greenland</td><td>Shanghai SIPG</td><td>39.81</td><td>60.08</td><td>0.2387</td><td>0.5203</td><td>...</td><td>25.6</td><td>63.4</td><td>0.0</td><td>4.0</td><td>0.57</td><td>2.76</td><td>0.80</td><td>1.50</td><td>0.00</td><td>3.26</td></tr><tr><th>2</th><td>2019</td><td>2019-03-01</td><td>1979</td><td>Chinese Super League</td><td>Guangzhou Evergrande</td><td>Tianjin Quanujian</td><td>65.59</td><td>39.99</td><td>0.7832</td><td>0.0673</td><td>...</td><td>77.1</td><td>28.8</td><td>3.0</td><td>0.0</td><td>0.49</td><td>0.45</td><td>1.05</td><td>0.75</td><td>3.15</td><td>0.00</td></tr><tr><th>3</th><td>2019</td><td>2019-03-01</td><td>1979</td><td>Chinese Super League</td><td>Wuhan Zall</td><td>Beijing Guoan</td><td>32.25</td><td>54.82</td><td>0.2276</td><td>0.5226</td><td>...</td><td>35.8</td><td>58.9</td><td>0.0</td><td>1.0</td><td>1.12</td><td>0.97</td><td>1.51</td><td>0.94</td><td>0.00</td><td>1.05</td></tr><tr><th>4</th><td>2019</td><td>2019-03-01</td><td>1979</td><td>Chinese Super League</td><td>Chongqing Lifan</td><td>Guangzhou RF</td><td>38.24</td><td>40.45</td><td>0.4403</td><td>0.2932</td><td>...</td><td>26.2</td><td>21.3</td><td>2.0</td><td>2.0</td><td>2.77</td><td>3.17</td><td>1.05</td><td>2.08</td><td>2.10</td><td>2.10</td></tr></tbody></table><p>5 rows × 23 columns</p></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 筛选德甲联赛数据,并删除为空数据</span>
bl <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>league <span class="token operator">==</span> <span class="token string">&quot;German Bundesliga&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>
bl<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>season</th><th>date</th><th>league_id</th><th>league</th><th>team1</th><th>team2</th><th>spi1</th><th>spi2</th><th>prob1</th><th>prob2</th><th>...</th><th>importance1</th><th>importance2</th><th>score1</th><th>score2</th><th>xg1</th><th>xg2</th><th>nsxg1</th><th>nsxg2</th><th>adj_score1</th><th>adj_score2</th></tr></thead><tbody><tr><th>497</th><td>2022</td><td>2022-08-05</td><td>1845</td><td>German Bundesliga</td><td>Eintracht Frankfurt</td><td>Bayern Munich</td><td>68.47</td><td>91.75</td><td>0.1350</td><td>0.6796</td><td>...</td><td>32.6</td><td>71.9</td><td>1.0</td><td>6.0</td><td>0.83</td><td>4.50</td><td>0.65</td><td>2.72</td><td>1.05</td><td>5.96</td></tr><tr><th>514</th><td>2022</td><td>2022-08-06</td><td>1845</td><td>German Bundesliga</td><td>VfL Bochum</td><td>Mainz</td><td>60.73</td><td>68.88</td><td>0.3568</td><td>0.3629</td><td>...</td><td>33.5</td><td>34.5</td><td>1.0</td><td>2.0</td><td>1.00</td><td>1.62</td><td>0.96</td><td>0.86</td><td>1.05</td><td>2.10</td></tr><tr><th>515</th><td>2022</td><td>2022-08-06</td><td>1845</td><td>German Bundesliga</td><td>Borussia Monchengladbach</td><td>TSG Hoffenheim</td><td>69.38</td><td>66.77</td><td>0.4872</td><td>0.2742</td><td>...</td><td>40.2</td><td>33.3</td><td>3.0</td><td>1.0</td><td>1.86</td><td>0.10</td><td>2.51</td><td>0.31</td><td>2.36</td><td>1.05</td></tr><tr><th>516</th><td>2022</td><td>2022-08-06</td><td>1845</td><td>German Bundesliga</td><td>VfL Wolfsburg</td><td>Werder Bremen</td><td>68.18</td><td>59.82</td><td>0.5319</td><td>0.2014</td><td>...</td><td>30.2</td><td>33.3</td><td>2.0</td><td>2.0</td><td>0.81</td><td>0.97</td><td>1.07</td><td>1.25</td><td>2.10</td><td>2.10</td></tr><tr><th>517</th><td>2022</td><td>2022-08-06</td><td>1845</td><td>German Bundesliga</td><td>1. FC Union Berlin</td><td>Hertha Berlin</td><td>69.98</td><td>59.70</td><td>0.5479</td><td>0.1860</td><td>...</td><td>34.9</td><td>33.0</td><td>3.0</td><td>1.0</td><td>1.25</td><td>0.40</td><td>1.66</td><td>0.36</td><td>3.15</td><td>1.05</td></tr></tbody></table><p>5 rows × 23 columns</p></div><p><strong>step2 数据处理</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 统计得分</span>
<span class="token keyword">def</span> <span class="token function">add_points</span><span class="token punctuation">(</span>df<span class="token punctuation">:</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">:</span>
    <span class="token comment">## 三元表达式</span>
    <span class="token comment">## df[&quot;score1&quot;] &gt; df[&quot;score2&quot;]，则返回3</span>
    <span class="token comment">## np.where(df[&quot;score1&quot;] == df[&quot;score2&quot;]，则返回1</span>
    <span class="token comment">## 否则为0</span>
    df<span class="token punctuation">[</span><span class="token string">&quot;pts_home&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>
        df<span class="token punctuation">[</span><span class="token string">&quot;score1&quot;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> df<span class="token punctuation">[</span><span class="token string">&quot;score2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&quot;score1&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> df<span class="token punctuation">[</span><span class="token string">&quot;score2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">&quot;pts_away&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>
        df<span class="token punctuation">[</span><span class="token string">&quot;score1&quot;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> df<span class="token punctuation">[</span><span class="token string">&quot;score2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&quot;score1&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> df<span class="token punctuation">[</span><span class="token string">&quot;score2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> df

<span class="token comment">## 统计得分数据</span>
bl <span class="token operator">=</span> add_points<span class="token punctuation">(</span>bl<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 总得分、总进球数、总助攻数和总黄牌数</span>

<span class="token comment">## 以下代码先分别统计team1和team2的得分数据，然后将两组数据相加</span>
perform <span class="token operator">=</span> <span class="token punctuation">(</span>
    bl<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span>
        <span class="token string">&quot;pts_home&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;score1&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;score2&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;xg1&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;xg2&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>set_axis<span class="token punctuation">(</span>
        <span class="token punctuation">[</span>
            <span class="token string">&quot;pts&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;gf&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;ga&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;xgf&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;xga&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
        bl<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span>
            <span class="token string">&quot;pts_away&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;score2&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;score1&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;xg2&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;xg1&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>set_axis<span class="token punctuation">(</span>
            <span class="token punctuation">[</span>
                <span class="token string">&quot;pts&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;gf&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;ga&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;xgf&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;xga&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment">## 由于python和pandas版本问题，如果上面的代码出问题，则使用下面代码</span>
<span class="token comment">## t1= bl.groupby(&quot;team1&quot;)[[&quot;pts_home&quot;,&quot;score1&quot;,&quot;score2&quot;,&quot;xg1&quot;,&quot;xg2&quot;, ]]</span>
<span class="token comment">## t1 = t1.sum()</span>
<span class="token comment">## t1.set_axis( [&quot;pts&quot;,&quot;gf&quot;,&quot;ga&quot;,&quot;xgf&quot;,&quot;xga&quot;, ], axis=1,)</span>
<span class="token comment">## t2 = bl.groupby(&quot;team1&quot;)[[&quot;pts_home&quot;,&quot;score1&quot;,&quot;score2&quot;,&quot;xg1&quot;,&quot;xg2&quot;, ]]</span>
<span class="token comment">## t2 = t2.sum()</span>
<span class="token comment">## t2.set_axis( [&quot;pts&quot;,&quot;gf&quot;,&quot;ga&quot;,&quot;xgf&quot;,&quot;xga&quot;, ], axis=1,)</span>
<span class="token comment">## perform = (t1.add(t2))</span>

perform<span class="token punctuation">.</span>shape
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>(18, 5)
</code></pre><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 汇总得分表现数据</span>
perform<span class="token punctuation">.</span>index<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;team&quot;</span>

perform<span class="token punctuation">[</span><span class="token string">&quot;gd&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> perform<span class="token punctuation">[</span><span class="token string">&quot;gf&quot;</span><span class="token punctuation">]</span> <span class="token operator">-</span> perform<span class="token punctuation">[</span><span class="token string">&quot;ga&quot;</span><span class="token punctuation">]</span>

perform <span class="token operator">=</span> perform<span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
        <span class="token string">&quot;pts&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;gd&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;gf&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;ga&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;xgf&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;xga&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">]</span>

perform<span class="token punctuation">[</span><span class="token string">&quot;games&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> bl<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add<span class="token punctuation">(</span>bl<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
perform<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>pts</th><th>gd</th><th>gf</th><th>ga</th><th>xgf</th><th>xga</th><th>games</th></tr><tr><th>team</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1. FC Union Berlin</th><td>62</td><td>13.0</td><td>51.0</td><td>38.0</td><td>35.93</td><td>43.06</td><td>34</td></tr><tr><th>Bayer Leverkusen</th><td>50</td><td>8.0</td><td>57.0</td><td>49.0</td><td>53.62</td><td>48.20</td><td>34</td></tr><tr><th>Bayern Munich</th><td>71</td><td>54.0</td><td>92.0</td><td>38.0</td><td>84.93</td><td>40.12</td><td>34</td></tr><tr><th>Borussia Dortmund</th><td>71</td><td>39.0</td><td>83.0</td><td>44.0</td><td>75.96</td><td>42.69</td><td>34</td></tr><tr><th>Borussia Monchengladbach</th><td>43</td><td>-3.0</td><td>52.0</td><td>55.0</td><td>53.05</td><td>58.88</td><td>34</td></tr></tbody></table></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 统计各队的胜负数据</span>
<span class="token keyword">def</span> <span class="token function">get_wins_draws_losses</span><span class="token punctuation">(</span>games<span class="token punctuation">:</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        games<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;pts_home&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;pts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;team1&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;team&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;pts&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>add<span class="token punctuation">(</span>
            games<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;pts_away&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;pts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;team2&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;team&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;pts&quot;</span><span class="token punctuation">]</span>
            <span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            fill_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>level<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>pivot<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token string">&quot;pts&quot;</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">&quot;L&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">&quot;W&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;W&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;L&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span>

wins_draws_losses <span class="token operator">=</span> get_wins_draws_losses<span class="token punctuation">(</span>bl<span class="token punctuation">)</span>
wins_draws_losses<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th>pts</th><th>W</th><th>D</th><th>L</th></tr><tr><th>team</th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1. FC Union Berlin</th><td>18</td><td>8</td><td>8</td></tr><tr><th>Bayer Leverkusen</th><td>14</td><td>8</td><td>12</td></tr><tr><th>Bayern Munich</th><td>21</td><td>8</td><td>5</td></tr><tr><th>Borussia Dortmund</th><td>22</td><td>5</td><td>7</td></tr><tr><th>Borussia Monchengladbach</th><td>11</td><td>10</td><td>13</td></tr></tbody></table></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 合并得分和胜负数据</span>
perform <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>perform<span class="token punctuation">,</span> wins_draws_losses<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
perform<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>pts</th><th>gd</th><th>gf</th><th>ga</th><th>xgf</th><th>xga</th><th>games</th><th>W</th><th>D</th><th>L</th></tr><tr><th>team</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>1. FC Union Berlin</th><td>62</td><td>13.0</td><td>51.0</td><td>38.0</td><td>35.93</td><td>43.06</td><td>34</td><td>18</td><td>8</td><td>8</td></tr><tr><th>Bayer Leverkusen</th><td>50</td><td>8.0</td><td>57.0</td><td>49.0</td><td>53.62</td><td>48.20</td><td>34</td><td>14</td><td>8</td><td>12</td></tr><tr><th>Bayern Munich</th><td>71</td><td>54.0</td><td>92.0</td><td>38.0</td><td>84.93</td><td>40.12</td><td>34</td><td>21</td><td>8</td><td>5</td></tr><tr><th>Borussia Dortmund</th><td>71</td><td>39.0</td><td>83.0</td><td>44.0</td><td>75.96</td><td>42.69</td><td>34</td><td>22</td><td>5</td><td>7</td></tr><tr><th>Borussia Monchengladbach</th><td>43</td><td>-3.0</td><td>52.0</td><td>55.0</td><td>53.05</td><td>58.88</td><td>34</td><td>11</td><td>10</td><td>13</td></tr></tbody></table></div><p><strong>step3 映射队标图片</strong></p>`,31),_={href:"https://github.com/znstrider/plottable/tree/master/docs/example_notebooks",target:"_blank",rel:"noopener noreferrer"},f=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 创建队名和队标的索引数据</span>
club_logo_path <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">&quot;data/bundesliga_crests_22_23&quot;</span><span class="token punctuation">)</span>
club_logo_files <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>club_logo_path<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;*.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
club_logos_paths <span class="token operator">=</span> <span class="token punctuation">{</span>f<span class="token punctuation">.</span>stem<span class="token punctuation">:</span> f <span class="token keyword">for</span> f <span class="token keyword">in</span> club_logo_files<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>perform <span class="token operator">=</span> perform<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">## 添加新列</span>
perform<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;crest&quot;</span><span class="token punctuation">,</span> perform<span class="token punctuation">[</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
perform<span class="token punctuation">[</span><span class="token string">&quot;crest&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> perform<span class="token punctuation">[</span><span class="token string">&quot;crest&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>club_logos_paths<span class="token punctuation">)</span>

<span class="token comment">## 数据排序</span>
perform <span class="token operator">=</span> perform<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;pts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;gd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;gf&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> colname <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">&quot;gd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;gf&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ga&quot;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    perform<span class="token punctuation">[</span>colname<span class="token punctuation">]</span> <span class="token operator">=</span> perform<span class="token punctuation">[</span>colname<span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&quot;int32&quot;</span><span class="token punctuation">)</span>

perform<span class="token punctuation">[</span><span class="token string">&quot;goal_difference&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> perform<span class="token punctuation">[</span><span class="token string">&quot;gf&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> perform<span class="token punctuation">[</span><span class="token string">&quot;ga&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>

<span class="token comment">## 添加排名</span>
perform<span class="token punctuation">[</span><span class="token string">&quot;rank&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

perform<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>crest</th><th>team</th><th>pts</th><th>gd</th><th>gf</th><th>ga</th><th>xgf</th><th>xga</th><th>games</th><th>W</th><th>D</th><th>L</th><th>goal_difference</th><th>rank</th></tr></thead><tbody><tr><th>2</th><td>data/bundesliga_crests_22_23/Bayern Munich.png</td><td>Bayern Munich</td><td>71</td><td>54</td><td>92</td><td>38</td><td>84.93</td><td>40.12</td><td>34</td><td>21</td><td>8</td><td>5</td><td>92:38</td><td>1</td></tr><tr><th>3</th><td>data/bundesliga_crests_22_23/Borussia Dortmund...</td><td>Borussia Dortmund</td><td>71</td><td>39</td><td>83</td><td>44</td><td>75.96</td><td>42.69</td><td>34</td><td>22</td><td>5</td><td>7</td><td>83:44</td><td>2</td></tr><tr><th>10</th><td>data/bundesliga_crests_22_23/RB Leipzig.png</td><td>RB Leipzig</td><td>66</td><td>23</td><td>64</td><td>41</td><td>67.01</td><td>37.48</td><td>34</td><td>20</td><td>6</td><td>8</td><td>64:41</td><td>3</td></tr><tr><th>0</th><td>data/bundesliga_crests_22_23/1. FC Union Berli...</td><td>1. FC Union Berlin</td><td>62</td><td>13</td><td>51</td><td>38</td><td>35.93</td><td>43.06</td><td>34</td><td>18</td><td>8</td><td>8</td><td>51:38</td><td>4</td></tr><tr><th>11</th><td>data/bundesliga_crests_22_23/SC Freiburg.png</td><td>SC Freiburg</td><td>59</td><td>7</td><td>51</td><td>44</td><td>53.11</td><td>52.25</td><td>34</td><td>17</td><td>8</td><td>9</td><td>51:44</td><td>5</td></tr></tbody></table></div><p><strong>step4 设定绘图数据</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 设置颜色</span>
row_colors <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;top4&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;#2d3636&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;top6&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;#516362&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;playoffs&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;#8d9386&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;relegation&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;#c8ab8d&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;even&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;#627979&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;odd&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;#68817e&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

bg_color <span class="token operator">=</span> row_colors<span class="token punctuation">[</span><span class="token string">&quot;odd&quot;</span><span class="token punctuation">]</span>
text_color <span class="token operator">=</span> <span class="token string">&quot;#e0e8df&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 确定绘图列</span>
table_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;crest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;team&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;games&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;W&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;L&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;goal_difference&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;gd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pts&quot;</span><span class="token punctuation">]</span>
perform<span class="token punctuation">[</span>table_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>crest</th><th>team</th><th>games</th><th>W</th><th>D</th><th>L</th><th>goal_difference</th><th>gd</th><th>pts</th></tr></thead><tbody><tr><th>2</th><td>data/bundesliga_crests_22_23/Bayern Munich.png</td><td>Bayern Munich</td><td>34</td><td>21</td><td>8</td><td>5</td><td>92:38</td><td>54</td><td>71</td></tr><tr><th>3</th><td>data/bundesliga_crests_22_23/Borussia Dortmund...</td><td>Borussia Dortmund</td><td>34</td><td>22</td><td>5</td><td>7</td><td>83:44</td><td>39</td><td>71</td></tr><tr><th>10</th><td>data/bundesliga_crests_22_23/RB Leipzig.png</td><td>RB Leipzig</td><td>34</td><td>20</td><td>6</td><td>8</td><td>64:41</td><td>23</td><td>66</td></tr><tr><th>0</th><td>data/bundesliga_crests_22_23/1. FC Union Berli...</td><td>1. FC Union Berlin</td><td>34</td><td>18</td><td>8</td><td>8</td><td>51:38</td><td>13</td><td>62</td></tr><tr><th>11</th><td>data/bundesliga_crests_22_23/SC Freiburg.png</td><td>SC Freiburg</td><td>34</td><td>17</td><td>8</td><td>9</td><td>51:44</td><td>7</td><td>59</td></tr></tbody></table></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">## 定义各列绘图效果</span>
table_col_defs <span class="token operator">=</span> <span class="token punctuation">[</span>
    ColDef<span class="token punctuation">(</span><span class="token string">&quot;rank&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ColDef<span class="token punctuation">(</span><span class="token string">&quot;crest&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.35</span><span class="token punctuation">,</span> plot_fn<span class="token operator">=</span>image<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ColDef<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">2.5</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ColDef<span class="token punctuation">(</span><span class="token string">&quot;games&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;Games&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ColDef<span class="token punctuation">(</span><span class="token string">&quot;W&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ColDef<span class="token punctuation">(</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ColDef<span class="token punctuation">(</span><span class="token string">&quot;L&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ColDef<span class="token punctuation">(</span><span class="token string">&quot;goal_difference&quot;</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;Goals&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ColDef<span class="token punctuation">(</span><span class="token string">&quot;gd&quot;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span><span class="token string">&quot;{:+}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ColDef<span class="token punctuation">(</span><span class="token string">&quot;pts&quot;</span><span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token string">&quot;left&quot;</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">&quot;Points&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>step5 绘图</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&quot;text.color&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> text_color
<span class="token comment">## 设置绘图字体</span>
<span class="token comment">## plt.rcParams[&quot;font.family&quot;] = &quot;Roboto&quot;</span>

<span class="token comment">## 设置背景颜色</span>
fig<span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span>bg_color<span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span>bg_color<span class="token punctuation">)</span>

table <span class="token operator">=</span> Table<span class="token punctuation">(</span>
    perform<span class="token punctuation">,</span>
    column_definitions<span class="token operator">=</span>table_col_defs<span class="token punctuation">,</span>
    row_dividers<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    col_label_divider<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    footer_divider<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    index_col<span class="token operator">=</span><span class="token string">&quot;rank&quot;</span><span class="token punctuation">,</span>
    columns<span class="token operator">=</span>table_cols<span class="token punctuation">,</span>
    even_row_color<span class="token operator">=</span>row_colors<span class="token punctuation">[</span><span class="token string">&quot;even&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    footer_divider_kw<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">:</span> bg_color<span class="token punctuation">,</span> <span class="token string">&quot;lw&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    row_divider_kw<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">:</span> bg_color<span class="token punctuation">,</span> <span class="token string">&quot;lw&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    column_border_kw<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">:</span> bg_color<span class="token punctuation">,</span> <span class="token string">&quot;lw&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">## 如果设置字体需要添加&quot;fontname&quot;: &quot;Roboto&quot;</span>
    textprops<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;fontsize&quot;</span><span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">&quot;ha&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>


<span class="token comment">## 设置不同行的颜色</span>
<span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    table<span class="token punctuation">.</span>rows<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span>row_colors<span class="token punctuation">[</span><span class="token string">&quot;top4&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
<span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    table<span class="token punctuation">.</span>rows<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span>row_colors<span class="token punctuation">[</span><span class="token string">&quot;top6&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
table<span class="token punctuation">.</span>rows<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span>row_colors<span class="token punctuation">[</span><span class="token string">&quot;playoffs&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    table<span class="token punctuation">.</span>rows<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span>row_colors<span class="token punctuation">[</span><span class="token string">&quot;relegation&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    table<span class="token punctuation">.</span>rows<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>set_fontcolor<span class="token punctuation">(</span>row_colors<span class="token punctuation">[</span><span class="token string">&quot;top4&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


fig<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>
    <span class="token string">&quot;bohndesliga_table_recreation.png&quot;</span><span class="token punctuation">,</span>
    facecolor<span class="token operator">=</span>fig<span class="token punctuation">.</span>get_facecolor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    bbox_inches<span class="token operator">=</span><span class="token string">&#39;tight&#39;</span><span class="token punctuation">,</span>
    dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Matplotlib-related/[数据分析与可视化] 基于matplotlib和plottable库绘制精美表格/output/output_81_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h2 id="_3-参考" tabindex="-1"><a class="header-anchor" href="#_3-参考" aria-hidden="true">#</a> 3 参考</h2>`,12),y={href:"https://github.com/znstrider/plottable",target:"_blank",rel:"noopener noreferrer"},w={href:"https://plottable.readthedocs.io/en/latest/index.html#",target:"_blank",rel:"noopener noreferrer"},x={href:"https://github.com/znstrider/plottable/tree/master/docs/example_notebooks",target:"_blank",rel:"noopener noreferrer"};function C(D,T){const a=e("ExternalLinkIcon");return c(),l("div",null,[i,n("p",null,[s("plottable是一个Python库，用于在matplotlib中绘制精美定制的图形表格。plottable的官方仓库地址为："),n("a",d,[s("plottable"),t(a)]),s("。本文主要参考其官方文档，plottable的官方文档地址为："),n("a",r,[s("plottable-doc"),t(a)]),s("。plottable安装命令如下：")]),k,n("p",null,[s("本文所有代码见："),n("a",m,[s("Python-Study-Notes"),t(a)])]),v,n("p",null,[s("下载示例数据，所有示例数据在"),n("a",b,[s("plottable-example_notebooks"),t(a)]),s("。")]),g,n("p",null,[s("此外，我们需要准备每个国家对应的国旗图片，该数据也在"),n("a",h,[s("plottable-example_notebooks"),t(a)]),s("下。")]),q,n("p",null,[s("队标图片地址为："),n("a",_,[s("plottable-example_notebooks"),t(a)])]),f,n("ul",null,[n("li",null,[n("a",y,[s("plottable"),t(a)])]),n("li",null,[n("a",w,[s("plottable-doc"),t(a)])]),n("li",null,[n("a",x,[s("plottable-example_notebooks"),t(a)])])])])}const S=o(u,[["render",C],["__file","2023-07-10-_数据分析与可视化_ 基于matplotlib和plottable库绘制精美表格.html.vue"]]);export{S as default};
