import{_ as p}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as e,o as c,c as i,a as n,b as s,d as t,e as o}from"./app-MsA2k2kn.js";const l={},u=n("h1",{id:"python-圆形嵌套图circular-packing",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#python-圆形嵌套图circular-packing","aria-hidden":"true"},"#"),s(" [python] 圆形嵌套图Circular Packing")],-1),r={href:"https://github.com/elmotec/circlify",target:"_blank",rel:"noopener noreferrer"},d=n("p",null,"您可以使用以下代码安装circlify：",-1),k=n("blockquote",null,[n("p",null,"pip install circlify")],-1),m={href:"https://github.com/elmotec/circlify",target:"_blank",rel:"noopener noreferrer"},v={href:"https://www.python-graph-gallery.com/circular-packing/",target:"_blank",rel:"noopener noreferrer"},b=o(`<h2 id="_1-具有一级层次的圆形嵌套图绘制" tabindex="-1"><a class="header-anchor" href="#_1-具有一级层次的圆形嵌套图绘制" aria-hidden="true">#</a> 1 具有一级层次的圆形嵌套图绘制</h2><p>circlify可以在没有层次结构的情况下工作，即只有一组数字变量，将每个变量都将显示为圆形。请注意，该包仅计算每个圆形的位置和大小。完成后，matplotlib用于制作图表本身。此外circlify库也提供了一个bubbles()函数完成所有绘图的功能。但它没有提供很多定制，所以matplotlib在这里是一个更好的绘图选择。</p><h3 id="_1-1-绘图数据与circlify计算" tabindex="-1"><a class="header-anchor" href="#_1-1-绘图数据与circlify计算" aria-hidden="true">#</a> 1.1 绘图数据与circlify计算</h3><p>基于一级层次结构的基本圆形嵌套图只需要两列数据框。第一列提供每个项目的名称（用于标记）。第二列提供项目的数值。它控制圆形大小。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&#39;Name&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;C&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;D&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;E&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;F&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&#39;Value&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
df
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div><table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th><th>Name</th><th>Value</th></tr></thead><tbody><tr><th>0</th><td>A</td><td>10</td></tr><tr><th>1</th><td>B</td><td>2</td></tr><tr><th>2</th><td>C</td><td>23</td></tr><tr><th>3</th><td>D</td><td>87</td></tr><tr><th>4</th><td>E</td><td>12</td></tr><tr><th>5</th><td>F</td><td>65</td></tr></tbody></table></div><p>在具有一级层次结构的基本圆形嵌套图中，数据集的每个实体都由一个圆圈表示。圆圈大小与其代表的值成正比。工作中最难的部分是计算每个圆的位置和大小。幸运的是，该circlify库提供了一个circlify()进行计算的函数。它将作为绘图输入。 计算函数输入参数如下：</p><ul><li>data ：（必需）从大到小排序的正值列表</li><li>show_enclosure ：（可选）一个布尔值，指示是否在所有圆之外添加一个最小包围圆（默认为 False）</li><li>target_enclosure ：（可选）最小包围圆的参数信息（默认为单位圆 (0, 0, 1)）</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># import the circlify library</span>
<span class="token comment"># 导入库</span>
<span class="token keyword">import</span> circlify

<span class="token comment"># compute circle positions:</span>
<span class="token comment"># 计算圆的位置</span>
<span class="token comment"># circle是一个列表</span>
circles <span class="token operator">=</span> circlify<span class="token punctuation">.</span>circlify<span class="token punctuation">(</span>
    df<span class="token punctuation">[</span><span class="token string">&#39;Value&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    show_enclosure<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> 
    target_enclosure<span class="token operator">=</span>circlify<span class="token punctuation">.</span>Circle<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> r<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment"># 输出要绘制其中一个圆形信息，x,y为圆心坐标，level为绘制等级</span>
circles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>Circle(x=-0.44578608966292743, y=0.537367020215489, r=0.08132507760370634, level=1, ex={&#39;datum&#39;: 2})
</code></pre><h3 id="_1-2-图形绘制" tabindex="-1"><a class="header-anchor" href="#_1-2-图形绘制" aria-hidden="true">#</a> 1.2 图形绘制</h3><h4 id="_1-2-1-基础图形绘制" tabindex="-1"><a class="header-anchor" href="#_1-2-1-基础图形绘制" aria-hidden="true">#</a> 1.2.1 基础图形绘制</h4><p>通过circlify计算数据后，基础的圆形嵌套图绘制如下所示。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># import libraries</span>
<span class="token keyword">import</span> circlify
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># Create just a figure and only one subplot</span>
<span class="token comment"># 设置图像尺寸</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Remove axes</span>
<span class="token comment"># 设置matplotlib不显示坐标轴</span>
ax<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">&#39;off&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># Find axis boundaries</span>
<span class="token comment"># 查找轴边界</span>
lim <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>
    <span class="token builtin">max</span><span class="token punctuation">(</span>
        <span class="token builtin">abs</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> circle<span class="token punctuation">.</span>r<span class="token punctuation">,</span>
        <span class="token builtin">abs</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> circle<span class="token punctuation">.</span>r<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">for</span> circle <span class="token keyword">in</span> circles
<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span>lim<span class="token punctuation">,</span> lim<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span>lim<span class="token punctuation">,</span> lim<span class="token punctuation">)</span>

<span class="token comment"># print circles</span>
<span class="token comment"># 画圆</span>
<span class="token keyword">for</span> circle <span class="token keyword">in</span> circles<span class="token punctuation">:</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> r <span class="token operator">=</span> circle
    <span class="token comment"># fill表示不填充圆</span>
    ax<span class="token punctuation">.</span>add_patch<span class="token punctuation">(</span>plt<span class="token punctuation">.</span>Circle<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> fill<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Circular Packing/output_7_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h4 id="_1-2-2-视觉调整" tabindex="-1"><a class="header-anchor" href="#_1-2-2-视觉调整" aria-hidden="true">#</a> 1.2.2 视觉调整</h4><p>让我们从这里做一些更漂亮、更有洞察力的事情。我们将添加一个标题，给圆形着色并添加标签：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># import libraries</span>
<span class="token keyword">import</span> circlify
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># Create just a figure and only one subplot</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Title</span>
<span class="token comment"># 添加标题</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&#39;Basic circular packing&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># Remove axes</span>
ax<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">&#39;off&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># Find axis boundaries</span>
lim <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>
    <span class="token builtin">max</span><span class="token punctuation">(</span>
        <span class="token builtin">abs</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> circle<span class="token punctuation">.</span>r<span class="token punctuation">,</span>
        <span class="token builtin">abs</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> circle<span class="token punctuation">.</span>r<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">for</span> circle <span class="token keyword">in</span> circles
<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span>lim<span class="token punctuation">,</span> lim<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span>lim<span class="token punctuation">,</span> lim<span class="token punctuation">)</span>

<span class="token comment"># list of labels</span>
<span class="token comment"># 添加标签</span>
labels <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;Name&#39;</span><span class="token punctuation">]</span>

<span class="token comment"># print circles</span>
<span class="token keyword">for</span> circle<span class="token punctuation">,</span> label <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>circles<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> r <span class="token operator">=</span> circle
    ax<span class="token punctuation">.</span>add_patch<span class="token punctuation">(</span>plt<span class="token punctuation">.</span>Circle<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 添加标签</span>
    plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>
          label<span class="token punctuation">,</span> 
          <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y <span class="token punctuation">)</span> <span class="token punctuation">,</span>
          va<span class="token operator">=</span><span class="token string">&#39;center&#39;</span><span class="token punctuation">,</span>
          ha<span class="token operator">=</span><span class="token string">&#39;center&#39;</span>
     <span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Circular Packing/output_9_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h4 id="_1-2-3-圆形之间的空间设置" tabindex="-1"><a class="header-anchor" href="#_1-2-3-圆形之间的空间设置" aria-hidden="true">#</a> 1.2.3 圆形之间的空间设置</h4><p>可以轻松地在圆形之间添加间距。只需要提供半径参数的百分比给add_patch()（此处为70%）。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># Create just a figure and only one subplot</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Title</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&#39;Basic circular packing&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># Remove axes</span>
ax<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">&#39;off&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># Find axis boundaries</span>
lim <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>
    <span class="token builtin">max</span><span class="token punctuation">(</span>
        <span class="token builtin">abs</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> circle<span class="token punctuation">.</span>r<span class="token punctuation">,</span>
        <span class="token builtin">abs</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> circle<span class="token punctuation">.</span>r<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">for</span> circle <span class="token keyword">in</span> circles
<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span>lim<span class="token punctuation">,</span> lim<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span>lim<span class="token punctuation">,</span> lim<span class="token punctuation">)</span>

<span class="token comment"># list of labels</span>
labels <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;Name&#39;</span><span class="token punctuation">]</span>

<span class="token comment"># print circles</span>
<span class="token keyword">for</span> circle<span class="token punctuation">,</span> label <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>circles<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> r <span class="token operator">=</span> circle
    <span class="token comment"># facecolor设置圆的填充颜色，edgecolor设置边框颜色</span>
    ax<span class="token punctuation">.</span>add_patch<span class="token punctuation">(</span>plt<span class="token punctuation">.</span>Circle<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token operator">*</span><span class="token number">0.7</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">&quot;#69b2a3&quot;</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># boxstyle设置边框形状，pad设置边框填充</span>
    plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>label<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y <span class="token punctuation">)</span> <span class="token punctuation">,</span>va<span class="token operator">=</span><span class="token string">&#39;center&#39;</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">&#39;center&#39;</span><span class="token punctuation">,</span> bbox<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>facecolor<span class="token operator">=</span><span class="token string">&#39;white&#39;</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">&#39;black&#39;</span><span class="token punctuation">,</span> boxstyle<span class="token operator">=</span><span class="token string">&#39;round&#39;</span><span class="token punctuation">,</span> pad<span class="token operator">=</span><span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Circular Packing/output_11_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h2 id="_2-具有多级层次的圆形嵌套图绘制" tabindex="-1"><a class="header-anchor" href="#_2-具有多级层次的圆形嵌套图绘制" aria-hidden="true">#</a> 2 具有多级层次的圆形嵌套图绘制</h2><p>下面将解释如何构建具有多个层次结构的圆形嵌套图。它使用circlify库来计算圆形位置，并通过matplotlib用于渲染图形。</p><h3 id="_2-1-绘图数据与circlify计算" tabindex="-1"><a class="header-anchor" href="#_2-1-绘图数据与circlify计算" aria-hidden="true">#</a> 2.1 绘图数据与circlify计算</h3><p>此示例考虑分层数据集。世界被大陆分割。大陆按国家划分。每个国家都有一个值（人口规模）。我们的目标是将每个国家表示为一个圆圈，其大小与其人口成正比。让我们创建这样一个数据集：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;World&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span><span class="token punctuation">:</span> <span class="token number">6964195249</span><span class="token punctuation">,</span> <span class="token string">&#39;children&#39;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;North America&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span><span class="token punctuation">:</span> <span class="token number">450448697</span><span class="token punctuation">,</span>
                   <span class="token string">&#39;children&#39;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;United States&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">308865000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Mexico&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">107550697</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Canada&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">34033000</span><span class="token punctuation">}</span> 
                   <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;South America&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">278095425</span><span class="token punctuation">,</span> 
                   <span class="token string">&#39;children&#39;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Brazil&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">192612000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Colombia&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">45349000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Argentina&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">40134425</span><span class="token punctuation">}</span>
                   <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Europe&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">209246682</span><span class="token punctuation">,</span>  
                   <span class="token string">&#39;children&#39;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Germany&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">81757600</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;France&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">65447374</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;United Kingdom&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">62041708</span><span class="token punctuation">}</span>
                   <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Africa&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">311929000</span><span class="token punctuation">,</span>  
                   <span class="token string">&#39;children&#39;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Nigeria&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">154729000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Ethiopia&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">79221000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Egypt&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">77979000</span><span class="token punctuation">}</span>
                   <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Asia&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">2745929500</span><span class="token punctuation">,</span>  
                   <span class="token string">&#39;children&#39;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;China&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">1336335000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;India&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">1178225000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                     <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Indonesia&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span> <span class="token punctuation">:</span> <span class="token number">231369500</span><span class="token punctuation">}</span>
                   <span class="token punctuation">]</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>

data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>[{&#39;id&#39;: &#39;World&#39;,
  &#39;datum&#39;: 6964195249,
  &#39;children&#39;: [{&#39;id&#39;: &#39;North America&#39;,
    &#39;datum&#39;: 450448697,
    &#39;children&#39;: [{&#39;id&#39;: &#39;United States&#39;, &#39;datum&#39;: 308865000},
     {&#39;id&#39;: &#39;Mexico&#39;, &#39;datum&#39;: 107550697},
     {&#39;id&#39;: &#39;Canada&#39;, &#39;datum&#39;: 34033000}]},
   {&#39;id&#39;: &#39;South America&#39;,
    &#39;datum&#39;: 278095425,
    &#39;children&#39;: [{&#39;id&#39;: &#39;Brazil&#39;, &#39;datum&#39;: 192612000},
     {&#39;id&#39;: &#39;Colombia&#39;, &#39;datum&#39;: 45349000},
     {&#39;id&#39;: &#39;Argentina&#39;, &#39;datum&#39;: 40134425}]},
   {&#39;id&#39;: &#39;Europe&#39;,
    &#39;datum&#39;: 209246682,
    &#39;children&#39;: [{&#39;id&#39;: &#39;Germany&#39;, &#39;datum&#39;: 81757600},
     {&#39;id&#39;: &#39;France&#39;, &#39;datum&#39;: 65447374},
     {&#39;id&#39;: &#39;United Kingdom&#39;, &#39;datum&#39;: 62041708}]},
   {&#39;id&#39;: &#39;Africa&#39;,
    &#39;datum&#39;: 311929000,
    &#39;children&#39;: [{&#39;id&#39;: &#39;Nigeria&#39;, &#39;datum&#39;: 154729000},
     {&#39;id&#39;: &#39;Ethiopia&#39;, &#39;datum&#39;: 79221000},
     {&#39;id&#39;: &#39;Egypt&#39;, &#39;datum&#39;: 77979000}]},
   {&#39;id&#39;: &#39;Asia&#39;,
    &#39;datum&#39;: 2745929500,
    &#39;children&#39;: [{&#39;id&#39;: &#39;China&#39;, &#39;datum&#39;: 1336335000},
     {&#39;id&#39;: &#39;India&#39;, &#39;datum&#39;: 1178225000},
     {&#39;id&#39;: &#39;Indonesia&#39;, &#39;datum&#39;: 231369500}]}]}]
</code></pre><p>然后我们需要用circlify()来计算表示每个国家和大陆圆形的位置，以及它们的半径。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># import the circlify library</span>
<span class="token keyword">import</span> circlify

<span class="token comment"># Compute circle positions thanks to the circlify() function</span>
<span class="token comment"># 计算</span>
circles <span class="token operator">=</span> circlify<span class="token punctuation">.</span>circlify<span class="token punctuation">(</span>
    data<span class="token punctuation">,</span> 
    show_enclosure<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> 
    target_enclosure<span class="token operator">=</span>circlify<span class="token punctuation">.</span>Circle<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> r<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>circles
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><pre><code>[Circle(x=0.0, y=0.0, r=1.0, level=1, ex={&#39;id&#39;: &#39;World&#39;, &#39;datum&#39;: 6964195249, &#39;children&#39;: [{&#39;id&#39;: &#39;North America&#39;, &#39;datum&#39;: 450448697, &#39;children&#39;: [{&#39;id&#39;: &#39;United States&#39;, &#39;datum&#39;: 308865000}, {&#39;id&#39;: &#39;Mexico&#39;, &#39;datum&#39;: 107550697}, {&#39;id&#39;: &#39;Canada&#39;, &#39;datum&#39;: 34033000}]}, {&#39;id&#39;: &#39;South America&#39;, &#39;datum&#39;: 278095425, &#39;children&#39;: [{&#39;id&#39;: &#39;Brazil&#39;, &#39;datum&#39;: 192612000}, {&#39;id&#39;: &#39;Colombia&#39;, &#39;datum&#39;: 45349000}, {&#39;id&#39;: &#39;Argentina&#39;, &#39;datum&#39;: 40134425}]}, {&#39;id&#39;: &#39;Europe&#39;, &#39;datum&#39;: 209246682, &#39;children&#39;: [{&#39;id&#39;: &#39;Germany&#39;, &#39;datum&#39;: 81757600}, {&#39;id&#39;: &#39;France&#39;, &#39;datum&#39;: 65447374}, {&#39;id&#39;: &#39;United Kingdom&#39;, &#39;datum&#39;: 62041708}]}, {&#39;id&#39;: &#39;Africa&#39;, &#39;datum&#39;: 311929000, &#39;children&#39;: [{&#39;id&#39;: &#39;Nigeria&#39;, &#39;datum&#39;: 154729000}, {&#39;id&#39;: &#39;Ethiopia&#39;, &#39;datum&#39;: 79221000}, {&#39;id&#39;: &#39;Egypt&#39;, &#39;datum&#39;: 77979000}]}, {&#39;id&#39;: &#39;Asia&#39;, &#39;datum&#39;: 2745929500, &#39;children&#39;: [{&#39;id&#39;: &#39;China&#39;, &#39;datum&#39;: 1336335000}, {&#39;id&#39;: &#39;India&#39;, &#39;datum&#39;: 1178225000}, {&#39;id&#39;: &#39;Indonesia&#39;, &#39;datum&#39;: 231369500}]}]}),
 Circle(x=-0.1891573044970616, y=0.7725949609994359, r=0.1964724487306323, level=2, ex={&#39;id&#39;: &#39;Europe&#39;, &#39;datum&#39;: 209246682, &#39;children&#39;: [{&#39;id&#39;: &#39;Germany&#39;, &#39;datum&#39;: 81757600}, {&#39;id&#39;: &#39;France&#39;, &#39;datum&#39;: 65447374}, {&#39;id&#39;: &#39;United Kingdom&#39;, &#39;datum&#39;: 62041708}]}),
 Circle(x=-0.5193811141243917, y=-0.4774793174718824, r=0.22650056519090414, level=2, ex={&#39;id&#39;: &#39;South America&#39;, &#39;datum&#39;: 278095425, &#39;children&#39;: [{&#39;id&#39;: &#39;Brazil&#39;, &#39;datum&#39;: 192612000}, {&#39;id&#39;: &#39;Colombia&#39;, &#39;datum&#39;: 45349000}, {&#39;id&#39;: &#39;Argentina&#39;, &#39;datum&#39;: 40134425}]}),
 Circle(x=-0.5250482991363239, y=0.4940564718994228, r=0.23988342689140008, level=2, ex={&#39;id&#39;: &#39;Africa&#39;, &#39;datum&#39;: 311929000, &#39;children&#39;: [{&#39;id&#39;: &#39;Nigeria&#39;, &#39;datum&#39;: 154729000}, {&#39;id&#39;: &#39;Ethiopia&#39;, &#39;datum&#39;: 79221000}, {&#39;id&#39;: &#39;Egypt&#39;, &#39;datum&#39;: 77979000}]}),
 Circle(x=-0.7117329289789401, y=0.0, r=0.28826707102105975, level=2, ex={&#39;id&#39;: &#39;North America&#39;, &#39;datum&#39;: 450448697, &#39;children&#39;: [{&#39;id&#39;: &#39;United States&#39;, &#39;datum&#39;: 308865000}, {&#39;id&#39;: &#39;Mexico&#39;, &#39;datum&#39;: 107550697}, {&#39;id&#39;: &#39;Canada&#39;, &#39;datum&#39;: 34033000}]}),
 Circle(x=0.28826707102105975, y=0.0, r=0.7117329289789401, level=2, ex={&#39;id&#39;: &#39;Asia&#39;, &#39;datum&#39;: 2745929500, &#39;children&#39;: [{&#39;id&#39;: &#39;China&#39;, &#39;datum&#39;: 1336335000}, {&#39;id&#39;: &#39;India&#39;, &#39;datum&#39;: 1178225000}, {&#39;id&#39;: &#39;Indonesia&#39;, &#39;datum&#39;: 231369500}]}),
 Circle(x=-0.8015572298502232, y=0.13991165332617728, r=0.06017798041665636, level=3, ex={&#39;id&#39;: &#39;Canada&#39;, &#39;datum&#39;: 34033000}),
 Circle(x=-0.6218965087862706, y=-0.35827194898537407, r=0.06927524011838612, level=3, ex={&#39;id&#39;: &#39;Argentina&#39;, &#39;datum&#39;: 40134425}),
 Circle(x=-0.6715240632168605, y=-0.49229197511777817, r=0.07363823567480635, level=3, ex={&#39;id&#39;: &#39;Colombia&#39;, &#39;datum&#39;: 45349000}),
 Circle(x=-0.20484950837730978, y=0.8820383650518233, r=0.08590977893113161, level=3, ex={&#39;id&#39;: &#39;United Kingdom&#39;, &#39;datum&#39;: 62041708}),
 Circle(x=-0.2883116431566897, y=0.7291956444670085, r=0.08823620918716854, level=3, ex={&#39;id&#39;: &#39;France&#39;, &#39;datum&#39;: 65447374}),
 Circle(x=-0.5807524341097545, y=0.6266527390697123, r=0.09606159016055799, level=3, ex={&#39;id&#39;: &#39;Egypt&#39;, &#39;datum&#39;: 77979000}),
 Circle(x=-0.6616477217438194, y=0.4515509451194898, r=0.09682357206293761, level=3, ex={&#39;id&#39;: &#39;Ethiopia&#39;, &#39;datum&#39;: 79221000}),
 Circle(x=-0.10145547990466931, y=0.7291956444670085, r=0.09861995406485186, level=3, ex={&#39;id&#39;: &#39;Germany&#39;, &#39;datum&#39;: 81757600}),
 Circle(x=-0.8930220906231182, y=0.0, r=0.1069779093768817, level=3, ex={&#39;id&#39;: &#39;Mexico&#39;, &#39;datum&#39;: 107550697}),
 Circle(x=-0.42950888228212775, y=0.4515509451194898, r=0.13531526739875396, level=3, ex={&#39;id&#39;: &#39;Nigeria&#39;, &#39;datum&#39;: 154729000}),
 Circle(x=-0.44612447532083954, y=-0.49229197511777817, r=0.15176135222121462, level=3, ex={&#39;id&#39;: &#39;Brazil&#39;, &#39;datum&#39;: 192612000}),
 Circle(x=0.2610622289123354, y=0.3631857971321717, r=0.15273517341003195, level=3, ex={&#39;id&#39;: &#39;Indonesia&#39;, &#39;datum&#39;: 231369500}),
 Circle(x=-0.6047550196020585, y=0.0, r=0.18128916164417805, level=3, ex={&#39;id&#39;: &#39;United States&#39;, &#39;datum&#39;: 308865000}),
 Circle(x=-0.07879852383709784, y=0.0, r=0.34466733412078254, level=3, ex={&#39;id&#39;: &#39;India&#39;, &#39;datum&#39;: 1178225000}),
 Circle(x=0.6329344051418423, y=0.0, r=0.3670655948581576, level=3, ex={&#39;id&#39;: &#39;China&#39;, &#39;datum&#39;: 1336335000})]
</code></pre><h3 id="_2-2-图形绘制" tabindex="-1"><a class="header-anchor" href="#_2-2-图形绘制" aria-hidden="true">#</a> 2.2 图形绘制</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>
<span class="token comment"># import libraries</span>
<span class="token keyword">import</span> circlify
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># Create just a figure and only one subplot</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Title</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&#39;Repartition of the world population&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># Remove axes</span>
ax<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">&#39;off&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># Find axis boundaries</span>
lim <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>
    <span class="token builtin">max</span><span class="token punctuation">(</span>
        <span class="token builtin">abs</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> circle<span class="token punctuation">.</span>r<span class="token punctuation">,</span>
        <span class="token builtin">abs</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">+</span> circle<span class="token punctuation">.</span>r<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">for</span> circle <span class="token keyword">in</span> circles
<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span>lim<span class="token punctuation">,</span> lim<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span>lim<span class="token punctuation">,</span> lim<span class="token punctuation">)</span>

<span class="token comment"># Print circle the highest level (continents):</span>
<span class="token comment"># 打印最高级别的圆形也就是数据中的大陆，这一部分circle的level为3</span>
<span class="token keyword">for</span> circle <span class="token keyword">in</span> circles<span class="token punctuation">:</span>
    <span class="token keyword">if</span> circle<span class="token punctuation">.</span>level <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>
      <span class="token keyword">continue</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> r <span class="token operator">=</span> circle
    ax<span class="token punctuation">.</span>add_patch<span class="token punctuation">(</span> plt<span class="token punctuation">.</span>Circle<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;lightblue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 打印次高级别的圆形也就是数据中的国家，这一部分circle的level为2</span>
<span class="token keyword">for</span> circle <span class="token keyword">in</span> circles<span class="token punctuation">:</span>
    <span class="token keyword">if</span> circle<span class="token punctuation">.</span>level <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">:</span>
      <span class="token keyword">continue</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> r <span class="token operator">=</span> circle
    label <span class="token operator">=</span> circle<span class="token punctuation">.</span>ex<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span>
    ax<span class="token punctuation">.</span>add_patch<span class="token punctuation">(</span> plt<span class="token punctuation">.</span>Circle<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;#69b3a2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 画出国家的名字</span>
    plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>label<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y <span class="token punctuation">)</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">&#39;center&#39;</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;white&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># Print labels for the continents</span>
<span class="token comment"># 画出各大洲的标签</span>
<span class="token keyword">for</span> circle <span class="token keyword">in</span> circles<span class="token punctuation">:</span>
    <span class="token keyword">if</span> circle<span class="token punctuation">.</span>level <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>
      <span class="token keyword">continue</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> r <span class="token operator">=</span> circle
    label <span class="token operator">=</span> circle<span class="token punctuation">.</span>ex<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span>
    plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>label<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y <span class="token punctuation">)</span> <span class="token punctuation">,</span>va<span class="token operator">=</span><span class="token string">&#39;center&#39;</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">&#39;center&#39;</span><span class="token punctuation">,</span> bbox<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>facecolor<span class="token operator">=</span><span class="token string">&#39;white&#39;</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">&#39;black&#39;</span><span class="token punctuation">,</span> boxstyle<span class="token operator">=</span><span class="token string">&#39;round&#39;</span><span class="token punctuation">,</span> pad<span class="token operator">=</span><span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Circular Packing/output_19_0.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h2 id="_3-circlify自带绘图函数" tabindex="-1"><a class="header-anchor" href="#_3-circlify自带绘图函数" aria-hidden="true">#</a> 3 circlify自带绘图函数</h2><p>如果只是想看看数据如何，可以用circlify的自带绘图函数bubbles，但是不能定制图形。circlify的bubbles函数好处就是不需要用matplotlib一层一层的画圆。</p><p><strong>一级层次绘图</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> pprint <span class="token keyword">import</span> pprint <span class="token keyword">as</span> pp
<span class="token keyword">import</span> circlify
<span class="token comment"># 定义圆</span>
<span class="token comment"># show_enclosure=True表示显示外圈大圆，也就是结果中的#0</span>
circles <span class="token operator">=</span> circlify<span class="token punctuation">.</span>circlify<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> show_enclosure<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># 美化输出</span>
pp<span class="token punctuation">(</span>circles<span class="token punctuation">)</span>

<span class="token comment"># 展示结果</span>
circlify<span class="token punctuation">.</span>bubbles<span class="token punctuation">(</span>circles<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>[Circle(x=0.0, y=0.0, r=1.0, level=0, ex=None),
 Circle(x=-0.633232604611031, y=-0.47732413442115296, r=0.09460444572843042, level=1, ex={&#39;datum&#39;: 1}),
 Circle(x=-0.7720311587589236, y=0.19946176418549022, r=0.13379089020993573, level=1, ex={&#39;datum&#39;: 2}),
 Circle(x=-0.43168871955473165, y=-0.6391381648617572, r=0.16385970662353394, level=1, ex={&#39;datum&#39;: 3}),
 Circle(x=0.595447603036083, y=0.5168251295666467, r=0.21154197162246005, level=1, ex={&#39;datum&#39;: 5}),
 Circle(x=-0.5480911056188739, y=0.5115139053491098, r=0.2502998363185337, level=1, ex={&#39;datum&#39;: 7}),
 Circle(x=0.043747233552068686, y=-0.6848366902134195, r=0.31376744998074435, level=1, ex={&#39;datum&#39;: 11}),
 Circle(x=0.04298737651230445, y=0.5310431146935967, r=0.34110117996070605, level=1, ex={&#39;datum&#39;: 13}),
 Circle(x=-0.3375943908160698, y=-0.09326467617622711, r=0.39006412239133215, level=1, ex={&#39;datum&#39;: 17}),
 Circle(x=0.46484095011516874, y=-0.09326467617622711, r=0.4123712185399064, level=1, ex={&#39;datum&#39;: 19})]
</code></pre><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Circular Packing/output_22_1.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p><strong>多级层次绘图</strong></p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> pprint <span class="token keyword">import</span> pprint <span class="token keyword">as</span> pp
<span class="token keyword">import</span> circlify
data <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;a2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span><span class="token punctuation">:</span> <span class="token number">0.05</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;a0&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span><span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token string">&#39;children&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;a1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span><span class="token punctuation">:</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token string">&#39;children&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;a1_1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;datum&#39;</span><span class="token punctuation">:</span> <span class="token number">0.05</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&#39;datum&#39;</span><span class="token punctuation">:</span> <span class="token number">0.04</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
circles <span class="token operator">=</span> circlify<span class="token punctuation">.</span>circlify<span class="token punctuation">(</span>data<span class="token punctuation">,</span> show_enclosure<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
pp<span class="token punctuation">(</span>circles<span class="token punctuation">)</span>

<span class="token comment"># 展示结果</span>
circlify<span class="token punctuation">.</span>bubbles<span class="token punctuation">(</span>circles<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>[Circle(x=0.0, y=0.0, r=1.0, level=0, ex=None),
 Circle(x=-0.5658030759977484, y=0.4109778665114514, r=0.18469903125906464, level=1, ex={&#39;datum&#39;: 0.05}),
 Circle(x=-0.5658030759977484, y=-0.4109778665114514, r=0.18469903125906464, level=1, ex={&#39;id&#39;: &#39;a2&#39;, &#39;datum&#39;: 0.05}),
 Circle(x=-0.7387961250362587, y=0.0, r=0.2612038749637415, level=1, ex={&#39;id&#39;: &#39;a1&#39;, &#39;datum&#39;: 0.1, &#39;children&#39;: [{&#39;id&#39;: &#39;a1_1&#39;, &#39;datum&#39;: 0.05}, {&#39;datum&#39;: 0.04}, 0.01]}),
 Circle(x=0.2612038749637414, y=0.0, r=0.7387961250362586, level=1, ex={&#39;id&#39;: &#39;a0&#39;, &#39;datum&#39;: 0.8, &#39;children&#39;: [0.3, 0.2, 0.2, 0.1]}),
 Circle(x=-0.7567888163564135, y=0.1408782365133844, r=0.0616618704777984, level=2, ex={&#39;datum&#39;: 0.01}),
 Circle(x=-0.8766762590444033, y=0.0, r=0.1233237409555968, level=2, ex={&#39;datum&#39;: 0.04}),
 Circle(x=-0.6154723840806618, y=0.0, r=0.13788013400814464, level=2, ex={&#39;id&#39;: &#39;a1_1&#39;, &#39;datum&#39;: 0.05}),
 Circle(x=0.6664952237042414, y=0.33692908734605553, r=0.21174557028487648, level=2, ex={&#39;datum&#39;: 0.1}),
 Circle(x=-0.1128831469183017, y=-0.23039288135707192, r=0.29945345726929773, level=2, ex={&#39;datum&#39;: 0.2}),
 Circle(x=0.1563193680487183, y=0.304601976765483, r=0.29945345726929773, level=2, ex={&#39;datum&#39;: 0.2}),
 Circle(x=0.5533243963620487, y=-0.23039288135707192, r=0.3667540860110527, level=2, ex={&#39;datum&#39;: 0.3})]
</code></pre><figure><img src="https://gitlab.com/luohenyueji/article_picture_warehouse/-/raw/main/Python-Study-Notes/Circular Packing/output_24_1.png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h2 id="_4-参考" tabindex="-1"><a class="header-anchor" href="#_4-参考" aria-hidden="true">#</a> 4 参考</h2>`,47),g={href:"https://github.com/elmotec/circlify",target:"_blank",rel:"noopener noreferrer"},h={href:"https://www.python-graph-gallery.com/circular-packing/",target:"_blank",rel:"noopener noreferrer"};function y(x,f){const a=e("ExternalLinkIcon");return c(),i("div",null,[u,n("p",null,[s("圆形嵌套图Circular Packing能够将一组组圆形互相嵌套起来，以显示数据的层次关系。本文主要基于circlify实现圆形嵌套图的绘制。circlify包由Python实现。官方开源地址见："),n("a",r,[s("circlify"),t(a)])]),d,k,n("p",null,[s("本文主要参考"),n("a",m,[s("circlify"),t(a)]),s("和"),n("a",v,[s("circular-packing"),t(a)])]),b,n("ul",null,[n("li",null,[n("a",g,[s("circlify"),t(a)])]),n("li",null,[n("a",h,[s("circular-packing"),t(a)])])])])}const w=p(l,[["render",y],["__file","2021-07-23-_python_ 圆形嵌套图Circular Packing.html.vue"]]);export{w as default};
