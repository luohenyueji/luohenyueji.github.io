import{_ as t}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as e,o as p,c as o,a as n,b as s,d as l,e as c}from"./app-MsA2k2kn.js";const i={},u=n("h1",{id:"python-《python编程快速上手让繁琐工作自动化》学习笔记4",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#python-《python编程快速上手让繁琐工作自动化》学习笔记4","aria-hidden":"true"},"#"),s(" [python]《Python编程快速上手让繁琐工作自动化》学习笔记4")],-1),r={id:"_1-处理excel-电子表格笔记-第12章-代码下载",tabindex:"-1"},d=n("a",{class:"header-anchor",href:"#_1-处理excel-电子表格笔记-第12章-代码下载","aria-hidden":"true"},"#",-1),k={href:"https://github.com/luohenyueji/Python-Study-Notes/tree/master/Automate%20the%20Boring%20Stuff%20with%20Python",target:"_blank",rel:"noopener noreferrer"},v=c(`<p>本文主要介绍openpyxl 的2.5.12版处理excel电子表格，原书是2.1.4 版，OpenPyXL 团队会经常发布新版本。不过不用担心，新版本应该在相当长的时间内向后兼容。如果你有新版本，想看看它提供了什么新功能，可以查看OpenPyXL 的完整文档： http://openpyxl.readthedocs.org/。</p><h3 id="_1-1-读取excel文档" tabindex="-1"><a class="header-anchor" href="#_1-1-读取excel文档" aria-hidden="true">#</a> <strong>1.1 读取Excel文档</strong></h3><p>常用函数如下：</p><table><thead><tr><th style="text-align:left;">函数(2.5.12)</th><th style="text-align:left;">函数(2.1.4)</th><th>用途</th><th style="text-align:center;">备注</th></tr></thead><tbody><tr><td style="text-align:left;">openpyxl.load_workbook(&#39;example.xlsx&#39;)</td><td style="text-align:left;">openpyxl.load_workbook(&#39;example.xlsx&#39;)</td><td>打开excel文档</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">wb.sheetnames</td><td style="text-align:left;">wb.get_sheet_names()</td><td>取得工作簿中所有表名的列表</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">sheet = wb[&#39;Sheet&#39;]</td><td style="text-align:left;">sheet = wb.get_sheet_by_name(&#39;Sheet&#39;)</td><td>获得工作簿表格Sheet</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">sheet.title</td><td style="text-align:left;">sheet.title</td><td>获得sheet的表格名</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">anotherSheet = wb.active</td><td style="text-align:left;">anotherSheet = wb.get_active_sheet()</td><td>获得当前活动表</td><td style="text-align:center;">活动表就是工作簿在Excel 中打开时出现的工作表</td></tr><tr><td style="text-align:left;">sheet[&#39;A1&#39;].value</td><td style="text-align:left;">sheet[&#39;A1&#39;].value</td><td>获得A1框格的值</td><td style="text-align:center;">可以通过=赋值改变A1框格的值</td></tr><tr><td style="text-align:left;">sheet.cell(row=1, column=2)</td><td style="text-align:left;">sheet.cell(row=1, column=2)</td><td>获得B2框格的值</td><td style="text-align:center;">另一种赋值方法，row表示行号，row代表用数字标识的列号</td></tr><tr><td style="text-align:left;">sheet.max_row/sheet.max_column</td><td style="text-align:left;">sheet.get_highest_row()/sheet.get_highest_column()</td><td>获得表格最大行数/列数</td><td style="text-align:center;">返回整数</td></tr><tr><td style="text-align:left;">from openpyxl.utils import get_column_letter, column_index_from_string</td><td style="text-align:left;">from openpyxl.cell import get_column_letter, column_index_from_string</td><td>调用数字字母转换函数</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">get_column_letter(2)</td><td style="text-align:left;">get_column_letter(2)</td><td>将数字2转为字母B</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">column_index_from_string(&#39;AA&#39;)</td><td style="text-align:left;">column_index_from_string(&#39;AA&#39;)</td><td>将字母AA转为数字27</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">tuple(sheet[&#39;A1&#39;:&#39;C3&#39;])</td><td style="text-align:left;">tuple(sheet[&#39;A1&#39;:&#39;C3&#39;])</td><td>获得A1到C3处的单元格</td><td style="text-align:center;"></td></tr></tbody></table><h3 id="_1-2-写入excel文档" tabindex="-1"><a class="header-anchor" href="#_1-2-写入excel文档" aria-hidden="true">#</a> <strong>1.2 写入Excel文档</strong></h3><p>常用函数如下：</p><table><thead><tr><th style="text-align:left;">函数(2.5.12)</th><th style="text-align:left;">函数(2.1.4)</th><th>用途</th><th style="text-align:center;">备注</th></tr></thead><tbody><tr><td style="text-align:left;">wb = openpyxl.Workbook()</td><td style="text-align:left;">wb = openpyxl.Workbook()</td><td>创建新的工作表对象</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">wb.create_sheet(index=2, title=&#39;Middle Sheet&#39;))</td><td style="text-align:left;">wb.create_sheet(index=2, title=&#39;Middle Sheet&#39;))</td><td>创建序号为index+1的新工作表</td><td style="text-align:center;">可以缺省输入参数</td></tr><tr><td style="text-align:left;">wb.remove(wb[&#39;Sheet1&#39;])</td><td style="text-align:left;">wb.remove_sheet(wb.get_sheet_by_name(&#39;Sheet&#39;))</td><td>删除工作表Sheet1</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">wb.save(&#39;example_copy.xlsx&#39;)</td><td style="text-align:left;">wb.save(&#39;example_copy.xlsx&#39;)</td><td>保存xlsx文件</td><td style="text-align:center;"></td></tr></tbody></table><h3 id="_1-3-表格设置" tabindex="-1"><a class="header-anchor" href="#_1-3-表格设置" aria-hidden="true">#</a> <strong>1.3 表格设置</strong></h3><p>常用函数如下：</p><table><thead><tr><th style="text-align:left;">函数(2.5.12)</th><th style="text-align:left;">函数(2.1.4)</th><th>用途</th><th style="text-align:center;">备注</th></tr></thead><tbody><tr><td style="text-align:left;">from openpyxl.styles import Font</td><td style="text-align:left;">from openpyxl.styles import Font, Style</td><td>导入字体设置模块</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">italic24Font = Font(name=&#39;Times New Roman&#39;,size=24, italic=True,bold=True)<br>sheet[&#39;A1&#39;].font = italic24Font</td><td style="text-align:left;">italic24Font = Font(name=&#39;Times New Roman&#39;,size=24, italic=True,bold=True)<br>styleObj = Style(font=italic24Font)<br> sheet[&#39;A1&#39;].style=styleObj</td><td>设置A1单元格字体，斜体加粗，字号24</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">sheet[&#39;A3&#39;] = &#39;=SUM(A1:A2)&#39;</td><td style="text-align:left;">sheet[&#39;A3&#39;] = &#39;=SUM(A1:A2)&#39;</td><td>设置公式</td><td style="text-align:center;">类似excel公式处理</td></tr><tr><td style="text-align:left;">sheet.row_dimensions[1].height = 70</td><td style="text-align:left;">sheet.row_dimensions[1].height = 70</td><td>设置第1行高度</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">sheet.column_dimensions[&#39;B&#39;].width = 20</td><td style="text-align:left;">sheet.column_dimensions[&#39;B&#39;].width = 20</td><td>设置第B列宽度</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">sheet.merge_cells(&#39;A1:D3&#39;)</td><td style="text-align:left;">sheet.merge_cells(&#39;A1:D3&#39;)</td><td>将&#39;A1:D3&#39;12 个单元格合并为一个单元格</td><td style="text-align:center;"></td></tr><tr><td style="text-align:left;">sheet.unmerge_cells(&#39;C5:D5&#39;)</td><td style="text-align:left;">sheet.unmerge_cells(&#39;C5:D5&#39;)</td><td>解除单元格合并</td><td style="text-align:center;"></td></tr></tbody></table><h2 id="_2-项目练习" tabindex="-1"><a class="header-anchor" href="#_2-项目练习" aria-hidden="true">#</a> 2. 项目练习</h2><h3 id="_2-1-从电子表格中读取数据" tabindex="-1"><a class="header-anchor" href="#_2-1-从电子表格中读取数据" aria-hidden="true">#</a> 2.1 从电子表格中读取数据</h3><p>2010 年美国人口普查数据censuspopdata.xlsx，可以从https://download.csdn.net/download/luohenyj/11266976 下载。程序主要功能：</p><ol><li>读取电子表格数据</li><li>填充数据结构</li><li>将结果写入文件 代码如下：</li></ol><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl
<span class="token keyword">import</span> pprint


<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Opening workbook...&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 打开excel文档</span>
wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span><span class="token string">&#39;censuspopdata.xlsx&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 打开 工作表</span>
<span class="token comment">#sheet = wb.get_sheet_by_name(&#39;Population by Census Tract&#39;)</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">&#39;Population by Census Tract&#39;</span><span class="token punctuation">]</span>
countyData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Reading rows...&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 按行读取数据</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span>max_row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    state <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string">&#39;B&#39;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value
    county <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string">&#39;C&#39;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value
    pop <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string">&#39;D&#39;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value

    <span class="token comment"># Make sure the key for this state exists.</span>
    countyData<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment"># country没有时设置的默认值</span>
    countyData<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span>county<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&#39;tracts&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;pop&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment"># Each row represents one census tract, so increment by one.</span>
    <span class="token comment"># 计算每个县中普查区的数</span>
    countyData<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">[</span>county<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;tracts&#39;</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token comment"># Increase the county pop by the pop in this census tract.</span>
    <span class="token comment"># 统计总人口</span>
    countyData<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">[</span>county<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;pop&#39;</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>pop<span class="token punctuation">)</span>


<span class="token comment"># Open a new text file and write the contents of countyData to it.</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Writing results...&#39;</span><span class="token punctuation">)</span>
resultFile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;census2010.py&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 保存数据</span>
resultFile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">&#39;allData = &#39;</span> <span class="token operator">+</span> pprint<span class="token punctuation">.</span>pformat<span class="token punctuation">(</span>countyData<span class="token punctuation">)</span><span class="token punctuation">)</span>
resultFile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Done.&#39;</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">&#39;&#39;&#39;
import os
# 导入py数据文件
import census2010
# 打印某一项数据
census2010.allData[&#39;AK&#39;][&#39;Anchorage&#39;]
anchoragePop = census2010.allData[&#39;AK&#39;][&#39;Anchorage&#39;][&#39;pop&#39;]
print(&#39;The 2010 population of Anchorage was &#39; + str(anchoragePop))
&#39;&#39;&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-更新一个电子表格" tabindex="-1"><a class="header-anchor" href="#_2-2-更新一个电子表格" aria-hidden="true">#</a> 2.2 更新一个电子表格</h3><p>从produceSales.xlsx找到特定类型的产品，并更新它们的价格。produceSales.xlsx可以从https://download.csdn.net/download/luohenyj/11266976 下载</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl

<span class="token comment"># 打开文档</span>
wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span><span class="token string">&#39;produceSales.xlsx&#39;</span><span class="token punctuation">)</span>
<span class="token comment">#sheet = wb.get_sheet_by_name(&#39;Sheet&#39;)</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">&#39;Sheet&#39;</span><span class="token punctuation">]</span>

<span class="token comment"># 要改变的价格</span>
PRICE_UPDATES <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;Garlic&#39;</span><span class="token punctuation">:</span> <span class="token number">3.07</span><span class="token punctuation">,</span>
                 <span class="token string">&#39;Celery&#39;</span><span class="token punctuation">:</span> <span class="token number">1.19</span><span class="token punctuation">,</span>
                 <span class="token string">&#39;Lemon&#39;</span><span class="token punctuation">:</span> <span class="token number">1.27</span><span class="token punctuation">}</span>


<span class="token comment"># skip the first row 跳过首行</span>
<span class="token keyword">for</span> rowNum <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span>max_row<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获得该行第一列的值</span>
    produceName <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>rowNum<span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
    <span class="token comment"># 判断键值</span>
    <span class="token keyword">if</span> produceName <span class="token keyword">in</span> PRICE_UPDATES<span class="token punctuation">:</span>
        <span class="token comment"># 更新值</span>
        sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>rowNum<span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> PRICE_UPDATES<span class="token punctuation">[</span>produceName<span class="token punctuation">]</span>

wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;updatedProduceSales.xlsx&#39;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-乘法表" tabindex="-1"><a class="header-anchor" href="#_2-3-乘法表" aria-hidden="true">#</a> 2.3 乘法表</h3><p>从命令行接受数字N，在一个Excel 电子表格中创建一个N×N 的乘法表。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>
<span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>utils <span class="token keyword">import</span> get_column_letter<span class="token punctuation">,</span> column_index_from_string
<span class="token comment"># 设置字体风格</span>
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> Font

wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">&#39;Sheet&#39;</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Please input N:&quot;</span><span class="token punctuation">)</span>
N <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
A <span class="token operator">=</span> get_column_letter<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># 设置字体加粗</span>
fontObj <span class="token operator">=</span> Font<span class="token punctuation">(</span>bold<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># 设置行</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    sheet<span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> row<span class="token operator">-</span><span class="token number">1</span>
    sheet<span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>font <span class="token operator">=</span> fontObj

<span class="token comment"># 设置列</span>
<span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    colName <span class="token operator">=</span> get_column_letter<span class="token punctuation">(</span>col<span class="token punctuation">)</span>
    sheet<span class="token punctuation">[</span>colName<span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> col<span class="token operator">-</span><span class="token number">1</span>
    sheet<span class="token punctuation">[</span>colName<span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>font <span class="token operator">=</span> fontObj


<span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        colName <span class="token operator">=</span> get_column_letter<span class="token punctuation">(</span>col<span class="token punctuation">)</span>
        rowName <span class="token operator">=</span> row
        sheet<span class="token punctuation">[</span>colName<span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> sheet<span class="token punctuation">[</span>colName<span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                                        <span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token operator">*</span>sheet<span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value

wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;multiplicationTable.xlsx&#39;</span><span class="token punctuation">)</span>
wb<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>Please input N:
9
</code></pre><h3 id="_2-4-空行插入程序" tabindex="-1"><a class="header-anchor" href="#_2-4-空行插入程序" aria-hidden="true">#</a> 2.4 空行插入程序</h3><p>命令行参数输入N和M。从第N行开始，在电子表格中插入M 个空行</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl


xlsxPath<span class="token operator">=</span><span class="token string">&#39;multiplicationTable.xlsx&#39;</span>
<span class="token comment"># 打开文件</span>
wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>xlsxPath<span class="token punctuation">)</span>

sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">&#39;Sheet&#39;</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;空行起始行号：&quot;</span><span class="token punctuation">)</span>
rowBlank<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;空行数：&quot;</span><span class="token punctuation">)</span>
rowBlanInsert<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 新的文件</span>
wb_save <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet_save <span class="token operator">=</span> wb_save<span class="token punctuation">[</span><span class="token string">&#39;Sheet&#39;</span><span class="token punctuation">]</span>


<span class="token comment"># 保存空行的数据</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>sheet<span class="token punctuation">.</span>max_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>sheet<span class="token punctuation">.</span>max_column<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 保存前rowBlank的值</span>
        <span class="token keyword">if</span> row<span class="token operator">&lt;</span>rowBlank<span class="token punctuation">:</span>    
            sheet_save<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span>col<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">=</span>sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span>col<span class="token punctuation">)</span><span class="token punctuation">.</span>value
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            sheet_save<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">+</span>rowBlanInsert<span class="token punctuation">,</span>col<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">=</span>sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span>col<span class="token punctuation">)</span><span class="token punctuation">.</span>value

       

wb_save<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;blankRowInserter.xlsx&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>空行起始行号：
2
空行数：
3
</code></pre><h3 id="_2-5-电子表格单元格翻转程序" tabindex="-1"><a class="header-anchor" href="#_2-5-电子表格单元格翻转程序" aria-hidden="true">#</a> 2.5 电子表格单元格翻转程序</h3><p>编写一个程序，翻转电子表格中行和列的单元格</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl

xlsxPath <span class="token operator">=</span> <span class="token string">&#39;blankRowInserter.xlsx&#39;</span>
<span class="token comment"># 打开文件</span>
wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>xlsxPath<span class="token punctuation">)</span>

sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">&#39;Sheet&#39;</span><span class="token punctuation">]</span>
<span class="token comment"># 新的文件</span>
wb_save <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet_save <span class="token operator">=</span> wb_save<span class="token punctuation">[</span><span class="token string">&#39;Sheet&#39;</span><span class="token punctuation">]</span>


<span class="token comment"># 翻转数据</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span>max_row<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span>max_column<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sheet_save<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>col<span class="token punctuation">,</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">.</span>value

wb_save<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;transSheet.xlsx&#39;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-6-文本文件到电子表格" tabindex="-1"><a class="header-anchor" href="#_2-6-文本文件到电子表格" aria-hidden="true">#</a> 2.6 文本文件到电子表格</h3><p>读入几个文本文件的内容（可以自己创造这些文本文件），并将这些内容插入一个电子表格，每行写入一行文本。第一个文本文件中的行将写入 列A 中的单元格，第二个文本文件中的行将写入列B 中的单元格，以此类推。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> openpyxl
<span class="token keyword">import</span> os


wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">&#39;Sheet&#39;</span><span class="token punctuation">]</span>


searchPath <span class="token operator">=</span> <span class="token string">&#39;./my_test&#39;</span>
<span class="token comment"># 返回指定目录下所有的文件名和文件夹名列表</span>
fileNames <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>searchPath<span class="token punctuation">)</span>
txtNames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> fileName <span class="token keyword">in</span> fileNames<span class="token punctuation">:</span>
    <span class="token comment"># 如果结尾是txt</span>
    <span class="token keyword">if</span> fileName<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">&#39;.txt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 保存到列表</span>
        txtNames<span class="token punctuation">.</span>append<span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>


<span class="token comment"># 遍历文件</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>txtNames<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    txtPath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>searchPath<span class="token punctuation">,</span> txtNames<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>txtPath<span class="token punctuation">)</span>
    fileContents <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>fileContents<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> fileContents<span class="token punctuation">[</span>j<span class="token punctuation">]</span>

wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;txtToXlsx.xlsx&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-7-电子表格到文本文件" tabindex="-1"><a class="header-anchor" href="#_2-7-电子表格到文本文件" aria-hidden="true">#</a> 2.7 电子表格到文本文件</h3><p>将列A 中的单元格写入一个文本文件，将列B 中的单元格写入另一个文本文件，以此类推。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># -*- coding: utf-8 -*-</span>


<span class="token keyword">import</span> openpyxl
<span class="token keyword">import</span> os


wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span><span class="token string">&#39;txtToXlsx.xlsx&#39;</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>active

<span class="token keyword">for</span> rows <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>max_row<span class="token punctuation">)</span><span class="token punctuation">:</span>
    txtFile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;%s.txt&#39;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;w&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 遍历行</span>
    <span class="token keyword">for</span> cols <span class="token keyword">in</span> sheet<span class="token punctuation">[</span>rows<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        txtFile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>cols<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    txtFile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,35);function m(b,h){const a=e("ExternalLinkIcon");return p(),o("div",null,[u,n("h2",r,[d,s(" 1. 处理Excel 电子表格笔记（第12章)"),n("a",k,[s("(代码下载)"),l(a)])]),v])}const g=t(i,[["render",m],["__file","2019-07-05-_python_《Python编程快速上手让繁琐工作自动化》学习笔记4.html.vue"]]);export{g as default};
