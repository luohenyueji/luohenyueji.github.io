import{_ as e}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as p,o,c,a as n,d as t,b as s,e as l}from"./app-MsA2k2kn.js";const u={},i=n("h1",{id:"机器学习-特征选择笔记2-单变量特征选择",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#机器学习-特征选择笔记2-单变量特征选择","aria-hidden":"true"},"#"),s(" [机器学习] 特征选择笔记2-单变量特征选择")],-1),r={href:"https://github.com/luohenyueji/Python-Study-Notes/tree/master/Documents/%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9%E7%AC%94%E8%AE%B0",target:"_blank",rel:"noopener noreferrer"},k=n("strong",null,"代码下载",-1),d={href:"https://scikit-learn.org/stable/modules/feature_selection.html",target:"_blank",rel:"noopener noreferrer"},m=n("p",null,"单变量特征选择是通过单变量统计检验来选择最好的特征。它可以看作是估计器的预处理步骤。Scikit-learn将特征选择相关功能作为接口进行公开:",-1),v={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html#sklearn.feature_selection.SelectKBest",target:"_blank",rel:"noopener noreferrer"},b={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectPercentile.html#sklearn.feature_selection.SelectPercentile",target:"_blank",rel:"noopener noreferrer"},_={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFpr.html#sklearn.feature_selection.SelectFpr",target:"_blank",rel:"noopener noreferrer"},h={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFdr.html#sklearn.feature_selection.SelectFdr",target:"_blank",rel:"noopener noreferrer"},f={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFwe.html#sklearn.feature_selection.SelectFwe",target:"_blank",rel:"noopener noreferrer"},g={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.GenericUnivariateSelect.html#sklearn.feature_selection.GenericUnivariateSelect",target:"_blank",rel:"noopener noreferrer"},y=l(`<p>@[toc]</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># 多行输出</span>
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>core<span class="token punctuation">.</span>interactiveshell <span class="token keyword">import</span> InteractiveShell
InteractiveShell<span class="token punctuation">.</span>ast_node_interactivity <span class="token operator">=</span> <span class="token string">&quot;all&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-基本方法" tabindex="-1"><a class="header-anchor" href="#_1-基本方法" aria-hidden="true">#</a> 1 基本方法</h2><h3 id="_1-1-selectkbest" tabindex="-1"><a class="header-anchor" href="#_1-1-selectkbest" aria-hidden="true">#</a> 1.1 SelectKBest</h3><p>导入特征选择库中的SelectKBest和chi2(卡方统计量)用来计算特征间与结果的相关性，并选择相关性最高的特征</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_digits
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> SelectKBest<span class="token punctuation">,</span> chi2

<span class="token comment"># 获得手写数字数据</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> load_digits<span class="token punctuation">(</span>return_X_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
X<span class="token punctuation">.</span>shape

<span class="token comment"># SelectKBest接收两个参数，使用的计算方法和选取的特征个数</span>
<span class="token comment"># SelectKBest默认方法为f_classif，计算提样本的ANOVA F值</span>
<span class="token comment"># 选择相关性最高的前20个特征</span>
X_new <span class="token operator">=</span> SelectKBest<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
X_new<span class="token punctuation">.</span>shape
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>(1797, 64)






(1797, 20)
</code></pre><p>SelectKBest具体特征输出评价如下：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征选取的结果：&quot;</span><span class="token punctuation">,</span>X<span class="token punctuation">)</span>
selector<span class="token operator">=</span>SelectKBest<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span>k<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
value <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token comment"># 得分越大越好</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征的得分：&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>scores_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征的p值:&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>pvalues_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;保留的特征列号为：&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>get_support<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征选择后的值&quot;</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>特征选取的结果： [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [3, 3, 3, 3, 3], [0, 1, 1, 1, 1]]
特征的得分： [0.11111111 0.         0.4        1.6        3.6       ]
特征的p值: [0.73888268 1.         0.52708926 0.20590321 0.05777957]
保留的特征列号为： [2 3 4]
特征选择后的值 [[3 4 5]
 [3 2 1]
 [3 3 3]
 [1 1 1]]
</code></pre><h3 id="_1-2-selectpercentile" tabindex="-1"><a class="header-anchor" href="#_1-2-selectpercentile" aria-hidden="true">#</a> 1.2 SelectPercentile</h3><p>SelectPercentile根据最高分数的百分位数选择特征。SelectPercentile方法类似于SelectKBest</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_digits
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> SelectPercentile<span class="token punctuation">,</span> chi2
X<span class="token punctuation">,</span> y <span class="token operator">=</span> load_digits<span class="token punctuation">(</span>return_X_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
X<span class="token punctuation">.</span>shape

<span class="token comment"># SelectPercentile接收两个参数，使用的计算方法和选取得分排名前percentile的特征，第一个参数默认值为f_classif</span>
X_new <span class="token operator">=</span> SelectPercentile<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> percentile<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
X_new<span class="token punctuation">.</span>shape

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>(1797, 64)






(1797, 7)
</code></pre><p>SelectPercentile具体特征输出评价如下：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征选取的结果：&quot;</span><span class="token punctuation">,</span>X<span class="token punctuation">)</span>
selector<span class="token operator">=</span>SelectPercentile<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span>percentile<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
value <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token comment"># 得分越大越好</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征的得分：&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>scores_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征的p值:&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>pvalues_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;保留的特征列号为：&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>get_support<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征选择后的值&quot;</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>特征选取的结果： [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [3, 3, 3, 3, 3], [0, 1, 1, 1, 1]]
特征的得分： [0.11111111 0.         0.4        1.6        3.6       ]
特征的p值: [0.73888268 1.         0.52708926 0.20590321 0.05777957]
保留的特征列号为： [4]
特征选择后的值 [[5]
 [1]
 [3]
 [1]]
</code></pre><h3 id="_1-3-selectfpr" tabindex="-1"><a class="header-anchor" href="#_1-3-selectfpr" aria-hidden="true">#</a> 1.3 SelectFpr</h3><p>SelectFpr表示基于假正例率（真实反例被预测为正例的比例 ）的大小进行特征选择</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_breast_cancer
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> SelectFpr<span class="token punctuation">,</span> chi2
X<span class="token punctuation">,</span> y <span class="token operator">=</span> load_breast_cancer<span class="token punctuation">(</span>return_X_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
X<span class="token punctuation">.</span>shape

<span class="token comment"># SelectFpr有两个参数方法和显著性水平</span>
<span class="token comment"># alpha也可以理解为保留的特征最高p值</span>
X_new <span class="token operator">=</span> SelectFpr<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
X_new<span class="token punctuation">.</span>shape
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>(569, 30)






(569, 16)
</code></pre><p>SelectFpr具体特征输出评价如下：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征选取的结果：&quot;</span><span class="token punctuation">,</span>X<span class="token punctuation">)</span>
selector<span class="token operator">=</span>SelectFpr<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
value <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token comment"># 得分越大越好</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征的得分：&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>scores_<span class="token punctuation">)</span>
<span class="token comment">#  过滤了P值高于alpha(设定)的值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征的p值:&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>pvalues_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;保留的特征列号为：&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>get_support<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征选择后的值&quot;</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>特征选取的结果： [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [3, 3, 3, 3, 3], [0, 1, 1, 1, 1]]
特征的得分： [0.11111111 0.         0.4        1.6        3.6       ]
特征的p值: [0.73888268 1.         0.52708926 0.20590321 0.05777957]
保留的特征列号为： [4]
特征选择后的值 [[5]
 [1]
 [3]
 [1]]
</code></pre><h3 id="_1-4-selectfdr" tabindex="-1"><a class="header-anchor" href="#_1-4-selectfdr" aria-hidden="true">#</a> 1.4 SelectFdr</h3><p>Bonferroni 校正获得错误发现率。FDR为q value：衡量错误发现率的指标（False discovery rate，简称FDR，所有检验中假阳性的概率）。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_breast_cancer
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> SelectFdr<span class="token punctuation">,</span> chi2
X<span class="token punctuation">,</span> y <span class="token operator">=</span> load_breast_cancer<span class="token punctuation">(</span>return_X_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
X<span class="token punctuation">.</span>shape

<span class="token comment"># alpha是预期错误发现率的上限</span>
X_new <span class="token operator">=</span> SelectFdr<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
X_new<span class="token punctuation">.</span>shape
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>(569, 30)






(569, 16)
</code></pre><p>SelectFdr具体特征输出评价如下：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征选取的结果：&quot;</span><span class="token punctuation">,</span>X<span class="token punctuation">)</span>
selector<span class="token operator">=</span>SelectFdr<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
value <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token comment"># 得分越大越好</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征的得分：&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>scores_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;保留的特征列号为：&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>get_support<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征选择后的值&quot;</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>特征选取的结果： [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [3, 3, 3, 3, 3], [0, 1, 1, 1, 1]]
特征的得分： [0.11111111 0.         0.4        1.6        3.6       ]
保留的特征列号为： [4]
特征选择后的值 [[5]
 [1]
 [3]
 [1]]
</code></pre><h3 id="_1-5-selectfwe" tabindex="-1"><a class="header-anchor" href="#_1-5-selectfwe" aria-hidden="true">#</a> 1.5 SelectFwe</h3><p>SelectFwe基于族系误差进行特征选择</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_breast_cancer
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> SelectFwe<span class="token punctuation">,</span> chi2
X<span class="token punctuation">,</span> y <span class="token operator">=</span> load_breast_cancer<span class="token punctuation">(</span>return_X_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
X<span class="token punctuation">.</span>shape

<span class="token comment"># alpha要保留的要素的最高未校正p值。</span>
X_new <span class="token operator">=</span> SelectFwe<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
X_new<span class="token punctuation">.</span>shape
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>(569, 30)






(569, 15)
</code></pre><p>SelectFwe具体特征输出评价如下：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>X<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征选取的结果：&quot;</span><span class="token punctuation">,</span>X<span class="token punctuation">)</span>
selector<span class="token operator">=</span>SelectFwe<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
value <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token comment"># 得分越大越好</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征的得分：&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>scores_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;保留的特征列号为：&quot;</span><span class="token punctuation">,</span>selector<span class="token punctuation">.</span>get_support<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;特征选择后的值&quot;</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>特征选取的结果： [[1, 2, 3, 4, 5], [5, 4, 3, 2, 1], [3, 3, 3, 3, 3], [0, 1, 1, 1, 1]]
特征的得分： [0.11111111 0.         0.4        1.6        3.6       ]
保留的特征列号为： [4]
特征选择后的值 [[5]
 [1]
 [3]
 [1]]
</code></pre><h3 id="_1-6-genericunivariateselect" tabindex="-1"><a class="header-anchor" href="#_1-6-genericunivariateselect" aria-hidden="true">#</a> 1.6 GenericUnivariateSelect</h3><p>GenericUnivariateSelect可以设置不同的策略来进行单变量特征选择</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_breast_cancer
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> GenericUnivariateSelect<span class="token punctuation">,</span> chi2
X<span class="token punctuation">,</span> y <span class="token operator">=</span> load_breast_cancer<span class="token punctuation">(</span>return_X_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
X<span class="token punctuation">.</span>shape

<span class="token comment"># 参数分别为方法，选择模式，选择多少种特征</span>
transformer <span class="token operator">=</span> GenericUnivariateSelect<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">&#39;k_best&#39;</span><span class="token punctuation">,</span> param<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
X_new <span class="token operator">=</span> transformer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
X_new<span class="token punctuation">.</span>shape
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>(569, 30)






(569, 20)
</code></pre><h2 id="_2-单变量特征选择特征方法应用" tabindex="-1"><a class="header-anchor" href="#_2-单变量特征选择特征方法应用" aria-hidden="true">#</a> 2 单变量特征选择特征方法应用</h2><h3 id="_2-1-单变量特征选择特征方法选择说明" tabindex="-1"><a class="header-anchor" href="#_2-1-单变量特征选择特征方法选择说明" aria-hidden="true">#</a> 2.1 单变量特征选择特征方法选择说明</h3><p>单变量特征选择方法就是将特征输入到评分函数，返回一个单变量的f_score(F检验的值)或p-values(P值，假设检验中的一个标准，P-value用来和显著性水平作比较)，注意SelectKBest 和 SelectPercentile只有得分，没有p-value。对于方法的选择推荐如下：</p><ul><li>回归的数据：f_regression，mutual_info_regression</li><li>分类的数据：chi2，f_classif，mutual_info_classif</li></ul><p>如果你使用稀疏数据(比如，使用稀疏矩阵表示的数据), 卡方检验(chi2)、互信息回归(mutual_info_regression)、互信息分类(mutual_info_classif)在处理数据时可保持其稀疏性，因此被推荐选择)。但是要注意的是当心不要在分类问题上使用回归评分函数，将获得无用的结果。</p><h3 id="_2-2-单变量特征选择特征实例" tabindex="-1"><a class="header-anchor" href="#_2-2-单变量特征选择特征实例" aria-hidden="true">#</a> 2.2 单变量特征选择特征实例</h3><p><strong>单变量特征选择</strong></p><p>本例中噪声特征会添加到鸢尾花数据中，将鸢尾花的特征数4增值到24，并且会应用单变量特征选择。然后使用SVM进行分类，查看没有进行特征选择是SVM分类器的效果。</p><p>对于每个特征，我们绘制单变量特征选择的p值以及SVM的相应权重。我们可以看到单变量特征选择会选择信息特征，并且这些特征具有更大的SVM权重。在全部特征中，只有前四个是有意义的。我们可以看到他们在单变量特征选择方面得分最高。SVM会为这些功能之一分配较大的权重，但还会选择许多非重要性功能。在SVM之前应用单变量特征选择会增加归因于重要特征的SVM权重，从而改善分类效率。</p><p>可以看到未经过特征提取的分类器得分: 0.789，经过特征提取的分类器得分: 0.868</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScaler
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> LinearSVC
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> make_pipeline
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> SelectKBest<span class="token punctuation">,</span> f_classif

<span class="token comment"># #############################################################################</span>
<span class="token comment"># Import some data to play with</span>

<span class="token comment"># The iris dataset</span>
<span class="token comment"># 鸢尾花数据集</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> load_iris<span class="token punctuation">(</span>return_X_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># Some noisy data not correlated</span>
<span class="token comment"># 添加噪声</span>
E <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>RandomState<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Add the noisy data to the informative features</span>
<span class="token comment"># 添加噪声特征，原来只有四个特征</span>
X <span class="token operator">=</span> np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Split dataset to select feature and evaluate the classifier</span>
<span class="token comment"># 分为训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>
        X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> stratify<span class="token operator">=</span>y<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span>
<span class="token punctuation">)</span>

<span class="token comment"># 新建一个名为figure1窗口</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># 清除当前 figure 的所有axes，但是不关闭这个 window，所以能继续复用于其他的 plot</span>
plt<span class="token punctuation">.</span>clf<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 特征标号</span>
X_indices <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># #############################################################################</span>
<span class="token comment"># Univariate feature selection with F-test for feature scoring</span>
<span class="token comment"># We use the default selection function to select the four</span>
<span class="token comment"># most significant features</span>
<span class="token comment">#基于F检验的特征评分单变量特征选择</span>
<span class="token comment"># 我们使用默认的选择函数来选择这四个最显著的特征</span>
selector <span class="token operator">=</span> SelectKBest<span class="token punctuation">(</span>f_classif<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
selector<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token comment"># 每个特征p值取对数</span>
scores <span class="token operator">=</span> <span class="token operator">-</span>np<span class="token punctuation">.</span>log10<span class="token punctuation">(</span>selector<span class="token punctuation">.</span>pvalues_<span class="token punctuation">)</span>
scores <span class="token operator">/=</span> scores<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 每个特征的特征的得分图</span>
<span class="token comment"># 蓝色的柱子</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>X_indices <span class="token operator">-</span> <span class="token number">.25</span><span class="token punctuation">,</span> scores<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">.2</span><span class="token punctuation">,</span>
        label<span class="token operator">=</span><span class="token string">r&#39;Univariate score ($-Log(p_{value})$)&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># #############################################################################</span>
<span class="token comment"># Compare to the weights of an SVM</span>
<span class="token comment"># 与支持向量机的权重进行比较</span>
clf <span class="token operator">=</span> make_pipeline<span class="token punctuation">(</span>MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> LinearSVC<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token comment"># 无特征选择得分</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;未经过特征提取的分类器得分: {:.3f}&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 提取权重</span>
svm_weights <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>clf<span class="token punctuation">.</span>named_steps<span class="token punctuation">[</span><span class="token string">&#39;linearsvc&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>coef_<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

svm_weights <span class="token operator">/=</span> svm_weights<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 橙色的柱子</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>X_indices<span class="token punctuation">,</span> svm_weights<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">.2</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;SVM weight&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># #############################################################################</span>
<span class="token comment"># 特征提取后支持向量机分类</span>
clf_selected <span class="token operator">=</span> make_pipeline<span class="token punctuation">(</span>
        SelectKBest<span class="token punctuation">(</span>f_classif<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> LinearSVC<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
clf_selected<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;经过特征提取的分类器得分: {:.3f}&#39;</span>
      <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>clf_selected<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

svm_weights_selected <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>clf_selected<span class="token punctuation">.</span>named_steps<span class="token punctuation">[</span><span class="token string">&#39;linearsvc&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>coef_<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
svm_weights_selected <span class="token operator">/=</span> svm_weights_selected<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>X_indices<span class="token punctuation">[</span>selector<span class="token punctuation">.</span>get_support<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">.25</span><span class="token punctuation">,</span> svm_weights_selected<span class="token punctuation">,</span>
        width<span class="token operator">=</span><span class="token number">.2</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&#39;SVM weights after selection&#39;</span><span class="token punctuation">)</span>


<span class="token comment"># 特征选择性能比较</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&quot;Comparing feature selection&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&#39;Feature number&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">&#39;tight&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">&#39;upper right&#39;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>未经过特征提取的分类器得分: 0.789
经过特征提取的分类器得分: 0.868
</code></pre><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVvaGVueXVlamkvYXJ0aWNsZV9waWN0dXJlX3dhcmVob3VzZS9yYXcvbWFzdGVyL0NTRE4vJTVCJUU2JTlDJUJBJUU1JTk5JUE4JUU1JUFEJUE2JUU0JUI5JUEwJTVEJTIwJUU3JTg5JUI5JUU1JUJFJTgxJUU5JTgwJTg5JUU2JThCJUE5JUU3JUFDJTk0JUU4JUFFJUIwMi0lRTUlOEQlOTUlRTUlOEYlOTglRTklODclOEYlRTclODklQjklRTUlQkUlODElRTklODAlODklRTYlOEIlQTkvb3V0cHV0XzI2XzEucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p><strong>F检验和相互信息的比较</strong></p><p>本例可视化y与三个变量之间的独立关系，并且正则化单变量F检验和互信息（有用的信息度量）二者的计算值。<br> 因F检验只能捕捉线性依赖关系，因此它把x1评为最关键的特征。而互信息能捕捉变量之间所有类型的依赖关系，因此它将x2评为最关键的特征，在这个例子中，它比较符合我们的直观感觉。 两种方法都能正确地把x_3评为不相关特征。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> f_regression<span class="token punctuation">,</span> mutual_info_regression

<span class="token comment"># # 设定随机种子</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># # 随机生成包含1000个样本，3个特征值的特征值，值越大越重要</span>
X <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 计算y值，并指定y值与x各个特征关系</span>
y <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi <span class="token operator">*</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.1</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>

<span class="token comment"># 单变量线性回归测试</span>
f_test<span class="token punctuation">,</span> _ <span class="token operator">=</span> f_regression<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># 将F值结果正则化</span>
<span class="token comment"># 测试线性模型中每一个回归因子的的影响</span>
f_test <span class="token operator">/=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>f_test<span class="token punctuation">)</span>

<span class="token comment"># 互信息计算（有用的信息度量），值越大越重要</span>
mi <span class="token operator">=</span> mutual_info_regression<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
mi <span class="token operator">/=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>mi<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">&#39;black&#39;</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&quot;$x_{}$&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&quot;$y$&quot;</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&quot;F-test={:.2f}, MI={:.2f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>f_test<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> mi<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVvaGVueXVlamkvYXJ0aWNsZV9waWN0dXJlX3dhcmVob3VzZS9yYXcvbWFzdGVyL0NTRE4vJTVCJUU2JTlDJUJBJUU1JTk5JUE4JUU1JUFEJUE2JUU0JUI5JUEwJTVEJTIwJUU3JTg5JUI5JUU1JUJFJTgxJUU5JTgwJTg5JUU2JThCJUE5JUU3JUFDJTk0JUU4JUFFJUIwMi0lRTUlOEQlOTUlRTUlOEYlOTglRTklODclOEYlRTclODklQjklRTUlQkUlODElRTklODAlODklRTYlOEIlQTkvb3V0cHV0XzI4XzAucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h2 id="_3-参考" tabindex="-1"><a class="header-anchor" href="#_3-参考" aria-hidden="true">#</a> 3 参考</h2>`,60),w={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html#sklearn.feature_selection.SelectKBest",target:"_blank",rel:"noopener noreferrer"},S={href:"https://www.cnblogs.com/tszr/p/10802025.html",target:"_blank",rel:"noopener noreferrer"},X={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectPercentile.html#sklearn.feature_selection.SelectPercentile",target:"_blank",rel:"noopener noreferrer"},U={href:"https://www.cnblogs.com/tszr/p/10802026.html",target:"_blank",rel:"noopener noreferrer"},J={href:"http://lijiancheng0614.github.io/scikit-learn/modules/generated/sklearn.feature_selection.SelectFpr.html",target:"_blank",rel:"noopener noreferrer"},q={href:"https://www.zhihu.com/question/23149768",target:"_blank",rel:"noopener noreferrer"},x={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFdr.html#sklearn.feature_selection.SelectFdr",target:"_blank",rel:"noopener noreferrer"},F={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFwe.html#sklearn.feature_selection.SelectFwe",target:"_blank",rel:"noopener noreferrer"},T={href:"https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.GenericUnivariateSelect.html#sklearn.feature_selection.GenericUnivariateSelect",target:"_blank",rel:"noopener noreferrer"},V={href:"https://www.cnblogs.com/stevenlk/p/6543628.html",target:"_blank",rel:"noopener noreferrer"},E={href:"https://scikit-learn.org/stable/auto_examples/feature_selection/plot_feature_selection.html#sphx-glr-auto-examples-feature-selection-plot-feature-selection-py",target:"_blank",rel:"noopener noreferrer"},B={href:"https://scikit-learn.org/stable/auto_examples/feature_selection/plot_f_test_vs_mi.html#sphx-glr-auto-examples-feature-selection-plot-f-test-vs-mi-py",target:"_blank",rel:"noopener noreferrer"},O={href:"https://blog.csdn.net/int_line/article/details/100231664",target:"_blank",rel:"noopener noreferrer"};function R(z,M){const a=p("ExternalLinkIcon");return o(),c("div",null,[i,n("p",null,[n("a",r,[k,t(a)]),s(" 本文主要介绍sklearn中进行特征选择的方法。 "),n("a",d,[s("sklearn.feature_selection"),t(a)]),s("模块中的类可用于样本集的特征选择/降维，以提高估计量的准确性得分或提高其在超高维数据集上的性能。")]),m,n("ul",null,[n("li",null,[n("a",v,[s("SelectKBest"),t(a)]),s("删除除最高评分外的所有功能")]),n("li",null,[n("a",b,[s("SelectPercentile"),t(a)]),s("删除除用户指定的最高得分百分比以外的所有特征")]),n("li",null,[s("对每个特征使用通用的单变量统计检验：误报率"),n("a",_,[s("SelectFpr"),t(a)]),s("，错误发现率"),n("a",h,[s("SelectFdr"),t(a)]),s("或多重比较谬误率"),n("a",f,[s("SelectFwe"),t(a)]),s("。")]),n("li",null,[n("a",g,[s("GenericUnivariateSelect"),t(a)]),s("允许使用可配置策略执行单变量特征选择。这使得我们可以用超参数搜索估计器来选择最佳的单变量选择策略。")])]),y,n("blockquote",null,[n("p",null,[n("a",w,[s("https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html#sklearn.feature_selection.SelectKBest"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",S,[s("https://www.cnblogs.com/tszr/p/10802025.html"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",X,[s("https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectPercentile.html#sklearn.feature_selection.SelectPercentile"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",U,[s("https://www.cnblogs.com/tszr/p/10802026.html"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",J,[s("http://lijiancheng0614.github.io/scikit-learn/modules/generated/sklearn.feature_selection.SelectFpr.html"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",q,[s("https://www.zhihu.com/question/23149768"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",x,[s("https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFdr.html#sklearn.feature_selection.SelectFdr"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",F,[s("https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFwe.html#sklearn.feature_selection.SelectFwe"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",T,[s("https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.GenericUnivariateSelect.html#sklearn.feature_selection.GenericUnivariateSelect"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",V,[s("https://www.cnblogs.com/stevenlk/p/6543628.html"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",E,[s("https://scikit-learn.org/stable/auto_examples/feature_selection/plot_feature_selection.html#sphx-glr-auto-examples-feature-selection-plot-feature-selection-py"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",B,[s("https://scikit-learn.org/stable/auto_examples/feature_selection/plot_f_test_vs_mi.html#sphx-glr-auto-examples-feature-selection-plot-f-test-vs-mi-py"),t(a)])])]),n("blockquote",null,[n("p",null,[n("a",O,[s("https://blog.csdn.net/int_line/article/details/100231664"),t(a)])])])])}const I=e(u,[["render",R],["__file","2020-07-09-_机器学习_ 特征选择笔记2-单变量特征选择.html.vue"]]);export{I as default};
