<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.71" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://luohenyueji.github.io/blog/r%E8%AF%AD%E8%A8%80/r%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/2020-01-10-_R%E8%AF%AD%E8%A8%80_%20WGCNA%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B.html"><meta property="og:site_name" content="落痕月极的博客"><meta property="og:title" content="[R语言] WGCNA入门教程"><meta property="og:description" content="[R语言] WGCNA入门教程 代码下载地址 本文主要参考WGCNA官网的教程1。整个分析流程可以分为以下几个步骤： 数据输入和清理 建设表达网络与模块检测 筛选与表型相关的模块 使用WGCNA进行网络可视化 参考 WGCNA的安装 前置软件包安装如果是R语言3.5及以上版本，安装命令如下： install.packages("BiocManager"..."><meta property="og:type" content="article"><meta property="og:image" content="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzE3XzEucG5n?x-oss-process=image/format,png"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="R语言"><meta property="article:tag" content="数据分析与可视化"><meta property="article:published_time" content="2020-01-10T14:28:55.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"[R语言] WGCNA入门教程","image":["https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzE3XzEucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzIyXzAucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzI5XzAucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzI5XzEucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzM2XzAucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzQ1XzEucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzUxXzAucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzU5XzEucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzYxXzAucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzY0XzAucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzY2XzAucG5n?x-oss-process=image/format,png","https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzY2XzEucG5n?x-oss-process=image/format,png"],"datePublished":"2020-01-10T14:28:55.000Z","dateModified":null,"author":[{"@type":"Person","name":"落痕月极","url":"/"}]}</script><link rel="icon" href="/logo.png"><title>[R语言] WGCNA入门教程 | 落痕月极的博客</title><meta name="description" content="[R语言] WGCNA入门教程 代码下载地址 本文主要参考WGCNA官网的教程1。整个分析流程可以分为以下几个步骤： 数据输入和清理 建设表达网络与模块检测 筛选与表型相关的模块 使用WGCNA进行网络可视化 参考 WGCNA的安装 前置软件包安装如果是R语言3.5及以上版本，安装命令如下： install.packages("BiocManager"...">
    <link rel="preload" href="/assets/style-7oyYUlCQ.css" as="style"><link rel="stylesheet" href="/assets/style-7oyYUlCQ.css">
    <link rel="modulepreload" href="/assets/app-HB0Nuzez.js"><link rel="modulepreload" href="/assets/2020-01-10-_R语言_ WGCNA入门教程.html-GV5ZDNgT.js">
    <link rel="prefetch" href="/assets/about.html-Bbn09tJN.js" as="script"><link rel="prefetch" href="/assets/intro.html-DCcAFvbf.js" as="script"><link rel="prefetch" href="/assets/index.html-B3NGOCJU.js" as="script"><link rel="prefetch" href="/assets/index.html-CnQXhKw3.js" as="script"><link rel="prefetch" href="/assets/index.html-2e8nD_dn.js" as="script"><link rel="prefetch" href="/assets/2021-08-04-_图像处理_ 基于图像哈希构建图像相似度对比算法.html-1kscxwrZ.js" as="script"><link rel="prefetch" href="/assets/2024-10-24-_图像处理_ 基于CleanVision库清洗图像数据集.html-CtWzX4Ox.js" as="script"><link rel="prefetch" href="/assets/2019-01-21-_常用工具_ 深度学习Caffe处理工具.html-BtzESI1I.js" as="script"><link rel="prefetch" href="/assets/2019-03-12-_常用工具_ Caffe ssd常见问题集合.html-C4tPk2Uh.js" as="script"><link rel="prefetch" href="/assets/2019-04-19-_常用工具_ OpenCV获取网络摄像头实时视频流.html-CjESZIFO.js" as="script"><link rel="prefetch" href="/assets/2020-02-16-_常用工具_ git基础学习笔记.html-PyXpR9Sb.js" as="script"><link rel="prefetch" href="/assets/2020-04-07-_常用工具_ shell脚本快速入门笔记.html-BJOZRVzz.js" as="script"><link rel="prefetch" href="/assets/2020-05-07-_常用工具_ live555的搭建.html-KCjKY5Ss.js" as="script"><link rel="prefetch" href="/assets/2020-08-11-_常用工具_ OpenCV_contrib库在windows下编译使用指南.html-D7dSRi_w.js" as="script"><link rel="prefetch" href="/assets/2021-02-10-_常用工具_ cvat安装与使用指北.html-B016w2Wg.js" as="script"><link rel="prefetch" href="/assets/2021-04-23-_常用工具_ dlib编译调用指南.html-DQy38mPw.js" as="script"><link rel="prefetch" href="/assets/2021-05-22-_常用工具_ mermaid学习笔记.html-JkXuW2fP.js" as="script"><link rel="prefetch" href="/assets/2021-12-21-_常用工具_ PyAutoGUI使用教程.html-ltCWe32d.js" as="script"><link rel="prefetch" href="/assets/2022-03-20-_常用工具_ 搜索引擎的常用技巧总结.html-DBBkAFdo.js" as="script"><link rel="prefetch" href="/assets/2022-07-13-_常用工具_ C__环境下Qt的安装.html-DFst7p6m.js" as="script"><link rel="prefetch" href="/assets/2022-07-18-_常用工具_ 基于psutil和GPUtil获取系统状态信息.html-DC_QUVcn.js" as="script"><link rel="prefetch" href="/assets/2022-08-12-_常用工具_ Python视频处理库VidGear使用指北.html--QBabZkh.js" as="script"><link rel="prefetch" href="/assets/2022-08-19-_常用工具_ Python视频解码库DeFFcode使用指北.html-_tMNYlfQ.js" as="script"><link rel="prefetch" href="/assets/2021-06-27-_数据分析与可视化_ 科技论文配色心得.html-Bk29lCdM.js" as="script"><link rel="prefetch" href="/assets/2017-10-24-_数学理论_ 单一数字评估指标.html-CdDj_vDd.js" as="script"><link rel="prefetch" href="/assets/2017-10-25-_数学理论_ 不同分布训练集、验证集、测试集处理.html-Dh1PBjHs.js" as="script"><link rel="prefetch" href="/assets/2024-06-01-_机器学习_ 低代码机器学习工具PyCaret库使用指北.html-Cg1qtA74.js" as="script"><link rel="prefetch" href="/assets/2023-07-27-_自然语言处理_ 自然语言处理库spaCy使用指北.html-CfwlmCOU.js" as="script"><link rel="prefetch" href="/assets/2023-08-21-_语音识别_ 基于Python构建简易的音频录制与语音识别应用.html-CSqD5W05.js" as="script"><link rel="prefetch" href="/assets/2023-09-24-_自然语言处理_ 基于pycorrector实现文本纠错.html-ClviZYMM.js" as="script"><link rel="prefetch" href="/assets/2020-05-13-_随笔所想_ CSDN认证博客专家申请通过随笔所想.html-C4Wu5uye.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_随笔所想_ 程序员中年失业随笔所想.html-CPyp8Xtp.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_随笔所想_ UBC学习生活经验分享.html-BEDNvA_y.js" as="script"><link rel="prefetch" href="/assets/2021-01-14-_随笔所想_ 2021年新年碎碎念-加油了不起的干饭人!.html-CnBGbpuP.js" as="script"><link rel="prefetch" href="/assets/2021-02-12-_随笔所想_ 牛年碎碎念祝大家牛年大吉.html-GqCmuiJN.js" as="script"><link rel="prefetch" href="/assets/2021-03-31-_随笔所想_ 买房和户型挑选入门.html-COkKF901.js" as="script"><link rel="prefetch" href="/assets/2021-08-29-_随笔所想_ 学英语打卡2000天碎碎念.html-DZa-oEIS.js" as="script"><link rel="prefetch" href="/assets/2021-12-1-_随笔所想_ 沉痛悼念开发技术专家毛星云老师.html-sJHDDaBn.js" as="script"><link rel="prefetch" href="/assets/2024-02-17-_随笔所想_ 劳动合同法学习笔记.html-CTesUnX5.js" as="script"><link rel="prefetch" href="/assets/2017-11-04-_能源化工_ TE田纳西-伊斯曼过程数据集.html-2ayL3XM3.js" as="script"><link rel="prefetch" href="/assets/2020-05-09-_能源化工_ 电力四遥.html-CaSUUUmw.js" as="script"><link rel="prefetch" href="/assets/2022-01-25-_生命科学_ 生物基础实验之PCR验证.html-DbGBfBhp.js" as="script"><link rel="prefetch" href="/assets/2022-01-31-_生命科学_ 生物基础实验之DNA提取.html-Dp8lh_0Q.js" as="script"><link rel="prefetch" href="/assets/2022-03-04-_生命科学_ snapgene 构建载体方法分享.html-Csto7Qf8.js" as="script"><link rel="prefetch" href="/assets/2022-03-25-_生命科学_ 生物基础实验之三引物检测突变体.html-DLeD1o5C.js" as="script"><link rel="prefetch" href="/assets/2025-09-13-_能源化工_ 面向锂电池RUL预测的开源项目全景速览.html-vPQiYUzp.js" as="script"><link rel="prefetch" href="/assets/2020-12-13-_讲座论坛_ 碧根果产业现状及产业化开发关键技术.html-By7n6ptZ.js" as="script"><link rel="prefetch" href="/assets/2020-12-20-_讲座论坛_ 竹资源培育与中国竹产业.html-Dcp5DT1k.js" as="script"><link rel="prefetch" href="/assets/2020-12-27-_讲座论坛_ 经济林之核桃类.html-BBVlnCkj.js" as="script"><link rel="prefetch" href="/assets/2021-04-21-_讲座论坛_ 应对气候变化的中国视角.html-CiMEMYzv.js" as="script"><link rel="prefetch" href="/assets/2022-02-28-_讲座论坛_ 国家自然基金申请知识汇总.html-Dp0Xp6ko.js" as="script"><link rel="prefetch" href="/assets/2022-12-31-_讲座论坛_ 研究的艺术学习笔记.html-unMJ2qNy.js" as="script"><link rel="prefetch" href="/assets/2023-05-31-_音视频处理_ FFmpeg使用指北1-视频解码.html-1PEAUgWb.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ kmeans聚类和WGCNA.html-Dr37pwn7.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ 均匀和不均匀造林对生态多样性的影响综述.html-CWd1EP3U.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ 枣树的历史与现状研究进展.html-D89Q16nL.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ 森林管理和造林业中复杂观念的转变.html-CIY2AROO.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ 深度学习技术在植物领域的研究1.html-NSfTbEwW.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ 深度学习技术在植物领域的研究2.html-ChDap4mV.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ 物联网技术在现代林业中的应用.html-fxMIbbF3.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ 石榴综述论文阅读笔记.html-fSyiqKJS.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ 美国造林业：过去30年的惊人变化时期.html-ZwcWXy3n.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ 苗圃营建学习笔记.html-BygiOGmj.js" as="script"><link rel="prefetch" href="/assets/2020-12-07-_论文总结_ 集约经营下人工林造林技术研究进展.html-DHn_gMcM.js" as="script"><link rel="prefetch" href="/assets/2021-09-23-_论文总结_ 农业工程领域中App和Web相关应用论文笔记.html-BIQmACVk.js" as="script"><link rel="prefetch" href="/assets/2021-09-23-_论文总结_ 智慧农业论文摘要阅读概览.html-B8RnuO57.js" as="script"><link rel="prefetch" href="/assets/2021-09-23-_论文总结_ 深度学习在农业领域应用论文笔记.html-Dla1CYxG.js" as="script"><link rel="prefetch" href="/assets/2021-10-18-_论文总结_ 育种理论与基因检测.html-BCN5DBjb.js" as="script"><link rel="prefetch" href="/assets/2021-10-19-_论文总结_ 树木的营养生理.html-rHwdBuPq.js" as="script"><link rel="prefetch" href="/assets/2021-10-20-_论文总结_ 深度学习在农业领域应用论文笔记2.html-7ODDJfOS.js" as="script"><link rel="prefetch" href="/assets/2021-10-21-_论文总结_ 深度学习在农业领域应用论文笔记3.html-DvfBQvcp.js" as="script"><link rel="prefetch" href="/assets/2021-10-27-_论文总结_ 深度学习在农业领域应用论文笔记4.html-B8BUFzmp.js" as="script"><link rel="prefetch" href="/assets/2021-10-28-_论文总结_ 深度学习在农业领域应用论文笔记5.html-Cg7V-dbp.js" as="script"><link rel="prefetch" href="/assets/2021-10-29-_论文总结_ 深度学习在农业领域应用论文笔记6.html-1IcKcQuk.js" as="script"><link rel="prefetch" href="/assets/2021-10-30-_论文总结_ 深度学习在农业领域应用论文笔记7.html-BkKyj0-p.js" as="script"><link rel="prefetch" href="/assets/2021-11-02-_论文总结_ 深度学习在农业领域应用论文笔记8.html-B3fCs8QY.js" as="script"><link rel="prefetch" href="/assets/2021-11-03-_论文总结_ 深度学习在农业领域应用论文笔记9.html-C1CVOZlK.js" as="script"><link rel="prefetch" href="/assets/2021-11-04-_论文总结_ 森林生态系统中的水生生境.html-Bngu4PWI.js" as="script"><link rel="prefetch" href="/assets/2022-04-05-_论文总结_  种群、保护与生态遗传学笔记.html-CDn1Dhnz.js" as="script"><link rel="prefetch" href="/assets/2022-05-01-_论文总结_ Genecology and Adaptation of Forest Trees 林木的基因生态学与适应性.html-zhBMMXXL.js" as="script"><link rel="prefetch" href="/assets/2022-05-20-_论文总结_ 中国工科生常见英文写作问题总结.html-CMw4OR5f.js" as="script"><link rel="prefetch" href="/assets/2022-05-31-_论文总结_ 科技论文英语写作笔记1.html-DScZIQ5v.js" as="script"><link rel="prefetch" href="/assets/2022-08-01-_论文总结_ 深度学习在农业领域应用论文笔记10.html-Due6CB0d.js" as="script"><link rel="prefetch" href="/assets/2023-02-28-_论文总结_ 深度学习在农业领域应用论文笔记11.html-4NW2lJZw.js" as="script"><link rel="prefetch" href="/assets/2024-02-10-_论文总结_ 深度学习在农业领域应用论文笔记12.html-DFRaSwIL.js" as="script"><link rel="prefetch" href="/assets/2024-09-25-_论文总结_ 深度学习在农业领域应用论文笔记13.html-CdrPecYz.js" as="script"><link rel="prefetch" href="/assets/2025-01-28-_论文总结_ 深度学习在农业领域应用论文笔记14.html-CRoBX_Hk.js" as="script"><link rel="prefetch" href="/assets/2017-11-13-_python_ tensorflow中的argmax()函数.html-DkjtmA1k.js" as="script"><link rel="prefetch" href="/assets/2019-07-31-_python_ 基于matplotlib实现树形图的绘制.html-ClhlZly5.js" as="script"><link rel="prefetch" href="/assets/2019-08-13-_python_ mxnet60分钟入门Gluon教程.html-Cx_4H4mv.js" as="script"><link rel="prefetch" href="/assets/2019-10-28-_python_ 基于NetworkX实现网络图的绘制.html-C2FrFpFE.js" as="script"><link rel="prefetch" href="/assets/2019-10-31-_python_ NetworkX实例.html-B4fbffwd.js" as="script"><link rel="prefetch" href="/assets/2019-11-15-_python_ 基于matplotlib_venn实现维恩图的绘制.html-CkioCn76.js" as="script"><link rel="prefetch" href="/assets/2019-12-30-_python_ CairoSVG使用教程.html-CjSbIoas.js" as="script"><link rel="prefetch" href="/assets/2020-03-25-_python_ 个人日常python工具代码.html-BtwMnHUL.js" as="script"><link rel="prefetch" href="/assets/2020-05-17-_python_ python模块graphviz使用入门.html-Bx7qI6EY.js" as="script"><link rel="prefetch" href="/assets/2020-09-01-_python_ 基于matplotlib实现圆环图的绘制.html-BQ_urbVp.js" as="script"><link rel="prefetch" href="/assets/2020-09-01-_python_ 基于matplotlib实现雷达图的绘制.html-aR3impjv.js" as="script"><link rel="prefetch" href="/assets/2021-07-20-_python_ Python二维码生成器qrcode库入门.html-DbehIUGX.js" as="script"><link rel="prefetch" href="/assets/2021-07-21-_python_ Python map函数总结.html-DSfyjAUH.js" as="script"><link rel="prefetch" href="/assets/2021-07-23-_python_ 圆形嵌套图Circular Packing.html-UzbR1UIM.js" as="script"><link rel="prefetch" href="/assets/2022-04-10-_python_ ​python-pinyin库.html-BEW9CaaD.js" as="script"><link rel="prefetch" href="/assets/2022-07-07-_python_ ​Python数据序列化模块pickle使用笔记.html-CAmDnFcf.js" as="script"><link rel="prefetch" href="/assets/2022-07-21-_python_ 向量检索库Faiss使用指北.html-CKGPoRRw.js" as="script"><link rel="prefetch" href="/assets/2022-07-25-_python_ 基于chardet识别字符编码.html-Dt0C1m72.js" as="script"><link rel="prefetch" href="/assets/2022-09-10-_python_ 基于diagrams库绘制系统架构图.html-DoCDEEx6.js" as="script"><link rel="prefetch" href="/assets/2022-09-19-_python_ 基于blind-watermark库添加图片盲水印.html-D9dzH-IU.js" as="script"><link rel="prefetch" href="/assets/2022-10-24-_python_ 基于Gradio可视化部署机器学习应用.html-Yyl53ZFf.js" as="script"><link rel="prefetch" href="/assets/2022-12-07-_python_ 基于wordcloud库绘制词云图.html-DbQwIWv1.js" as="script"><link rel="prefetch" href="/assets/2023-01-01-_python_ 基于paramiko库操作远程服务器.html-BkuYn7u-.js" as="script"><link rel="prefetch" href="/assets/2023-04-17-_python_ Python枚举模块enum总结.html-BMbShfyg.js" as="script"><link rel="prefetch" href="/assets/2023-05-10-_python_ Python类型提示总结.html-qAVkgMNP.js" as="script"><link rel="prefetch" href="/assets/2023-11-30-_python_ 基于Tablib库处理表格数据.html-ghCGwron.js" as="script"><link rel="prefetch" href="/assets/2023-12-29-_python_ 基于Dataset库操作数据库.html-iJJ3ING2.js" as="script"><link rel="prefetch" href="/assets/2024-01-25-_python_ 基于RapidFuzz库实现字符串模糊匹配.html-Da28EYCL.js" as="script"><link rel="prefetch" href="/assets/2024-04-30-_python_ 基于PyWaffle库绘制华夫饼图.html-BZ7t14_U.js" as="script"><link rel="prefetch" href="/assets/2024-06-30-_python_ Python日志记录库loguru使用指北.html-CTxscKT6.js" as="script"><link rel="prefetch" href="/assets/2024-07-30-_python_ 启发式算法库scikit-opt使用指北.html-61oOz43W.js" as="script"><link rel="prefetch" href="/assets/2024-08-10-_python_ Python并行计算库Joblib使用指北.html-cV5TTpVp.js" as="script"><link rel="prefetch" href="/assets/2024-10-01-_python_ 基于PyOD库实现数据异常检测.html-B56VH8vt.js" as="script"><link rel="prefetch" href="/assets/2024-11-22-_python_ Python异步编程库asyncio使用指北.html-DdZQZ1YB.js" as="script"><link rel="prefetch" href="/assets/2024-11-25-_python_ asyncio库常见问题与实践案例.html-CH_tDXWe.js" as="script"><link rel="prefetch" href="/assets/2025-03-24-_python_ 使用Python实现Markdown文档格式转换.html-CqKGPAkH.js" as="script"><link rel="prefetch" href="/assets/2025-04-27-_python_ 基于WatchDog库实现文件系统监控.html-DJZ4t4-E.js" as="script"><link rel="prefetch" href="/assets/2025-05-20-_python_ 轻量级定时任务调度库schedule使用指北.html-B9wPqpDH.js" as="script"><link rel="prefetch" href="/assets/2025-06-03-_python_ python抽象基类使用总结.html-DjbcKqK1.js" as="script"><link rel="prefetch" href="/assets/2025-10-24-_python_ 代码性能分析工具line_profiler使用指北.html-B5EIJOiz.js" as="script"><link rel="prefetch" href="/assets/2019-03-04-_OpenCV实战_1 基于深度学习识别人脸性别和年龄.html-BnKbCaL8.js" as="script"><link rel="prefetch" href="/assets/2019-03-05-_OpenCV实战_2 人脸识别算法对比.html-CHRTj-d3.js" as="script"><link rel="prefetch" href="/assets/2019-03-06-_OpenCV实战_3 透明斗篷.html-CH8dn1w9.js" as="script"><link rel="prefetch" href="/assets/2019-03-06-_OpenCV实战_4 OpenCV中的颜色空间.html-BRAVSUME.js" as="script"><link rel="prefetch" href="/assets/2019-03-06-_OpenCV实战_5 基于深度学习的文本检测.html-CDIdNOWI.js" as="script"><link rel="prefetch" href="/assets/2019-03-08-_OpenCV实战_6 基于特征点匹配的视频稳像.html-BcXBlslZ.js" as="script"><link rel="prefetch" href="/assets/2019-03-13-_OpenCV实战_7 使用YOLOv3和OpenCV进行基于深度学习的目标检测.html-3R38gVaA.js" as="script"><link rel="prefetch" href="/assets/2019-03-15-_OpenCV实战_8 深度学习目标检测网络YOLOv3的训练.html-Bzs7MZWl.js" as="script"><link rel="prefetch" href="/assets/2019-03-16-_OpenCV实战_10 使用Hu矩进行形状匹配.html-Gjq6Dx6d.js" as="script"><link rel="prefetch" href="/assets/2019-03-16-_OpenCV实战_9 使用OpenCV寻找平面图形的质心.html-B8cN0FQT.js" as="script"><link rel="prefetch" href="/assets/2019-03-19-_OpenCV实战_11 基于OpenCV的二维码扫描器.html-CL1ADYNE.js" as="script"><link rel="prefetch" href="/assets/2019-03-27-_OpenCV实战_12 使用深度学习和OpenCV进行手部关键点检测.html-BRwQNhBi.js" as="script"><link rel="prefetch" href="/assets/2019-04-02-_OpenCV实战_13 OpenCV中使用Mask R-CNN进行对象检测和实例分割.html-Bbe6GRMU.js" as="script"><link rel="prefetch" href="/assets/2019-04-04-_OpenCV实战_14 使用OpenCV实现单目标跟踪.html-BNE8KZeu.js" as="script"><link rel="prefetch" href="/assets/2019-04-08-_OpenCV实战_15 基于深度学习的目标跟踪算法GOTURN.html-Bs-R_B-M.js" as="script"><link rel="prefetch" href="/assets/2019-04-08-_OpenCV实战_16 使用OpenCV实现多目标跟踪.html-BwIXkB5G.js" as="script"><link rel="prefetch" href="/assets/2019-04-10-_OpenCV实战_17 基于卷积神经网络的OpenCV图像着色.html-D5txbCkK.js" as="script"><link rel="prefetch" href="/assets/2019-04-16-_OpenCV实战_18 OpenCV中的单应性矩阵Homography.html-Dl-qgk2v.js" as="script"><link rel="prefetch" href="/assets/2019-04-17-_OpenCV实战_19 使用OpenCV实现基于特征的图像对齐.html-BDjOJmZQ.js" as="script"><link rel="prefetch" href="/assets/2019-04-22-_OpenCV实战_20 使用OpenCV实现基于增强相关系数最大化的图像对齐.html-CLvKA1Cq.js" as="script"><link rel="prefetch" href="/assets/2019-04-23-_OpenCV实战_21 使用OpenCV的Eigenface.html-COqrTvrb.js" as="script"><link rel="prefetch" href="/assets/2019-04-24-_OpenCV实战_22 使用EigenFaces进行人脸重建.html-CjIjO9yn.js" as="script"><link rel="prefetch" href="/assets/2019-04-30-_OpenCV实战_23 使用OpenCV获取高动态范围成像HDR.html-n7tJcipG.js" as="script"><link rel="prefetch" href="/assets/2019-05-05-_OpenCV实战_24 使用OpenCV进行曝光融合.html-CPbTSKw6.js" as="script"><link rel="prefetch" href="/assets/2019-05-05-_OpenCV实战_25 使用OpenCV进行泊松克隆.html-CcnpNLg0.js" as="script"><link rel="prefetch" href="/assets/2019-05-06-_OpenCV实战_26 基于OpenCV实现选择性搜索算法.html-CSecjk6j.js" as="script"><link rel="prefetch" href="/assets/2019-05-07-_OpenCV实战_27 在OpenCV下使用forEach进行并行像素访问.html-DSEk85it.js" as="script"><link rel="prefetch" href="/assets/2019-05-08-_OpenCV实战_28 基于OpenCV的GUI库cvui.html-CNnwQJDv.js" as="script"><link rel="prefetch" href="/assets/2019-05-09-_OpenCV实战_29 使用OpenCV实现红眼自动去除.html-DtsMDMx6.js" as="script"><link rel="prefetch" href="/assets/2019-05-10-_OpenCV实战_30 使用OpenCV实现图像孔洞填充.html-CTpbPlyl.js" as="script"><link rel="prefetch" href="/assets/2019-05-23-_OpenCV实战_31 使用OpenCV将一个三角形仿射变换到另一个三角形.html-Bjre_gk8.js" as="script"><link rel="prefetch" href="/assets/2019-05-24-_OpenCV实战_32 使用OpenCV进行非真实感渲染.html-DWmUL62p.js" as="script"><link rel="prefetch" href="/assets/2019-05-27-_OpenCV实战_33 使用OpenCV进行Hough变换.html-COyTPz5P.js" as="script"><link rel="prefetch" href="/assets/2019-05-28-_OpenCV实战_34 使用OpenCV进行图像修复.html-DUe2QdO0.js" as="script"><link rel="prefetch" href="/assets/2019-07-16-_OpenCV实战_35 使用Tesseract和OpenCV实现文本识别.html-SSx9F_Gg.js" as="script"><link rel="prefetch" href="/assets/2019-08-30-_OpenCV实战_36 使用OpenCV在视频中实现简单背景估计.html-qa59kjAm.js" as="script"><link rel="prefetch" href="/assets/2020-02-29-_OpenCV实战_37 图像质量评价BRISQUE.html-CSgL5bBu.js" as="script"><link rel="prefetch" href="/assets/2020-03-06-_OpenCV实战_38 基于OpenCV的相机标定.html-B3H8U79Z.js" as="script"><link rel="prefetch" href="/assets/2020-03-31-_OpenCV实战_39 在OpenCV中使用ArUco标记的增强现实.html-CTrhSgPu.js" as="script"><link rel="prefetch" href="/assets/2020-05-07-_OpenCV实战_40 计算机视觉工具对比.html-BS2ZhYS4.js" as="script"><link rel="prefetch" href="/assets/2020-05-10-_OpenCV实战_41 嵌入式计算机视觉设备选择.html-DOodkqti.js" as="script"><link rel="prefetch" href="/assets/2020-05-12-_OpenCV实战_42 数码单反相机的技术细节.html-tlSXt0xD.js" as="script"><link rel="prefetch" href="/assets/2020-08-14-_OpenCV实战_43 使用OpenCV进行背景分割.html-BFc_0MRu.js" as="script"><link rel="prefetch" href="/assets/2020-08-24-_OpenCV实战_44 使用OpenCV进行图像超分放大.html-BL5uqa79.js" as="script"><link rel="prefetch" href="/assets/2020-08-27-_OpenCV实战_45 基于OpenCV实现图像哈希算法.html-BDBJTTdM.js" as="script"><link rel="prefetch" href="/assets/2020-09-10-_OpenCV实战_46 在OpenCV下应用图像强度变换实现图像对比度均衡.html-C03Y7P59.js" as="script"><link rel="prefetch" href="/assets/2020-09-15-_OpenCV实战_47 基于OpenCV实现视觉显著性检测.html-CFGvt4ii.js" as="script"><link rel="prefetch" href="/assets/2020-10-09-_OpenCV实战_48 基于OpenCV实现图像质量评价.html-an47GYY1.js" as="script"><link rel="prefetch" href="/assets/2021-02-12-_OpenCV实战_49 对极几何与立体视觉初探.html-DM-BfYgg.js" as="script"><link rel="prefetch" href="/assets/2021-02-16-_OpenCV实战_50 用OpenCV制作低成本立体相机.html-CBX46Bvy.js" as="script"><link rel="prefetch" href="/assets/2021-03-15-_OpenCV实战_51 基于OpenCV实现图像极坐标变换与逆变换.html-C_0W835u.js" as="script"><link rel="prefetch" href="/assets/2022-12-01-_OpenCV实战_52 在OpenCV中使用颜色直方图.html-DA-0rL6Z.js" as="script"><link rel="prefetch" href="/assets/index.html-mk7lBBZn.js" as="script"><link rel="prefetch" href="/assets/2019-06-25-_python_《Python编程快速上手让繁琐工作自动化》学习笔记1.html-L_ieBeuK.js" as="script"><link rel="prefetch" href="/assets/2019-06-26-_python_《Python编程快速上手让繁琐工作自动化》学习笔记2.html-B68I0T4X.js" as="script"><link rel="prefetch" href="/assets/2019-06-28-_python_《Python编程快速上手让繁琐工作自动化》学习笔记3.html-CRS9Fz0U.js" as="script"><link rel="prefetch" href="/assets/2019-07-05-_python_《Python编程快速上手让繁琐工作自动化》学习笔记4.html-BZRJ5gi2.js" as="script"><link rel="prefetch" href="/assets/2019-07-27-_python_《Python编程快速上手让繁琐工作自动化》学习笔记5.html-Dmbic_hD.js" as="script"><link rel="prefetch" href="/assets/2019-07-31-_python_《Python编程快速上手让繁琐工作自动化》学习笔记6.html-BoIT9_xc.js" as="script"><link rel="prefetch" href="/assets/2019-08-02-_python_《Python编程快速上手让繁琐工作自动化》学习笔记7.html-Bq9AyNbv.js" as="script"><link rel="prefetch" href="/assets/2019-05-28-_seaborn_ seaborn学习笔记0 seaborn学习笔记章节.html-BsuqrLDg.js" as="script"><link rel="prefetch" href="/assets/2019-05-29-_seaborn_ seaborn学习笔记1 箱形图Boxplot.html-oBSgQ16Q.js" as="script"><link rel="prefetch" href="/assets/2019-05-30-_seaborn_ seaborn学习笔记2 散点图Scatterplot.html-BD_Dx0hw.js" as="script"><link rel="prefetch" href="/assets/2019-05-30-_seaborn_ seaborn学习笔记3 直方图Histogramplot.html-DC2Tdz2Q.js" as="script"><link rel="prefetch" href="/assets/2019-05-31-_seaborn_ seaborn学习笔记4 核密度图DENSITYPLOT.html-DyEYXPLf.js" as="script"><link rel="prefetch" href="/assets/2019-05-31-_seaborn_ seaborn学习笔记5 小提琴图VIOLINPLOT.html-06AgwkfD.js" as="script"><link rel="prefetch" href="/assets/2019-05-31-_seaborn_ seaborn学习笔记6 热图HEATMAPPLOT.html-DCDEfWML.js" as="script"><link rel="prefetch" href="/assets/2019-06-01-_seaborn_ seaborn学习笔记7 常用参数调整Adjustment of Common Parameters.html-BqIKepnk.js" as="script"><link rel="prefetch" href="/assets/2019-06-01-_seaborn_ seaborn学习笔记8 避免过度绘图Avoid Overplotting.html-3DwQ-bqJ.js" as="script"><link rel="prefetch" href="/assets/2019-06-05-_seaborn_ seaborn学习笔记10 绘图实例(2) Drawing example(2).html-CY2re5UW.js" as="script"><link rel="prefetch" href="/assets/2019-06-05-_seaborn_ seaborn学习笔记9 绘图实例(1) Drawing example(1).html-_sKdfPd5.js" as="script"><link rel="prefetch" href="/assets/2019-06-06-_seaborn_ seaborn学习笔记11 绘图实例(3) Drawing example(3).html-BbJR8aAJ.js" as="script"><link rel="prefetch" href="/assets/2019-06-06-_seaborn_ seaborn学习笔记12 绘图实例(4) Drawing example(4).html-B7-YuRbD.js" as="script"><link rel="prefetch" href="/assets/2020-03-21-_R语言_ ggplot2入门笔记1—ggplot2简要教程.html-uEELJKj-.js" as="script"><link rel="prefetch" href="/assets/2020-03-21-_R语言_ ggplot2入门笔记2—通用教程ggplot2简介.html-1kC-EVb7.js" as="script"><link rel="prefetch" href="/assets/2020-03-21-_R语言_ ggplot2入门笔记3—通用教程如何自定义ggplot2.html-jHpfV85G.js" as="script"><link rel="prefetch" href="/assets/2020-03-21-_R语言_ ggplot2入门笔记4—前50个ggplot2可视化效果.html-CmMwRM-Q.js" as="script"><link rel="prefetch" href="/assets/index.html-F7jFB9cX.js" as="script"><link rel="prefetch" href="/assets/2020-09-05-_R语言_ 基于R语言实现树形图的绘制.html-Ct5jsRzU.js" as="script"><link rel="prefetch" href="/assets/2020-09-05-_R语言_ 基于R语言实现环状条形图的绘制.html-CWKBwF2U.js" as="script"><link rel="prefetch" href="/assets/2019-07-31-_R语言_ R语言PCA分析教程 Principal Component Methods in R.html-Czu_QJpF.js" as="script"><link rel="prefetch" href="/assets/2021-02-05-_R语言_ R语言快速入门教程.html-BhyYBWR3.js" as="script"><link rel="prefetch" href="/assets/2018-12-11-_图像处理_ YUV图像处理入门1.html-C1pkZPlE.js" as="script"><link rel="prefetch" href="/assets/2018-12-11-_图像处理_ YUV图像处理入门2.html-DPD9CESn.js" as="script"><link rel="prefetch" href="/assets/2018-12-11-_图像处理_ YUV图像处理入门3.html-D3sdrc5o.js" as="script"><link rel="prefetch" href="/assets/2018-12-11-_图像处理_ YUV图像处理入门4.html-BJym4IhN.js" as="script"><link rel="prefetch" href="/assets/2018-12-11-_图像处理_ YUV图像处理入门5.html-IpROHvLM.js" as="script"><link rel="prefetch" href="/assets/index.html-hKMNX-_1.js" as="script"><link rel="prefetch" href="/assets/2021-11-21-_数据与分析可视化_ D3入门教程1-d3基础知识.html-DWCMJuA8.js" as="script"><link rel="prefetch" href="/assets/2021-11-28-_数据与分析可视化_ D3入门教程2-在d3中构建形状.html-BIRXnijT.js" as="script"><link rel="prefetch" href="/assets/2021-12-05-_数据与分析可视化_ D3入门教程3-d3中的数据操作.html-CeRyf-ym.js" as="script"><link rel="prefetch" href="/assets/2023-03-16-_数据分析与可视化_ Python绘制数据地图1-GeoPandas入门指北.html-B6Gln0rK.js" as="script"><link rel="prefetch" href="/assets/2023-04-09-_数据分析与可视化_ Python绘制数据地图2-GeoPandas地图可视化.html-B1xnJf_t.js" as="script"><link rel="prefetch" href="/assets/2023-06-16-_数据分析与可视化_ Python绘制数据地图3-GeoPandas使用要点.html-UNAi-BPT.js" as="script"><link rel="prefetch" href="/assets/2023-08-03-_数据分析与可视化_ Python绘制数据地图4-MovingPandas入门指北.html-DZrgBDil.js" as="script"><link rel="prefetch" href="/assets/2023-08-11-_数据分析与可视化_ Python绘制数据地图5-MovingPandas绘图实例.html-BBLQTuFM.js" as="script"><link rel="prefetch" href="/assets/2023-06-28-_数据分析与可视化_ 基于matplotlib-scalebar库绘制比例尺.html-BI4YLk4x.js" as="script"><link rel="prefetch" href="/assets/2023-07-10-_数据分析与可视化_ 基于matplotlib和plottable库绘制精美表格.html-9FAGxkIk.js" as="script"><link rel="prefetch" href="/assets/2023-10-24-_数据分析与可视化_ 基于Python绘制简单动图.html-D4Kefaq7.js" as="script"><link rel="prefetch" href="/assets/2021-11-14-_数据分析与可视化_ 数据绘图要点1-注重数据排序.html-DVVrwI44.js" as="script"><link rel="prefetch" href="/assets/2021-11-18-_数据分析与可视化_ 数据绘图要点2-Y轴的开始与结束.html-4lCKCWoc.js" as="script"><link rel="prefetch" href="/assets/2021-11-24-_数据分析与可视化_ 数据绘图要点3-意大利面条图.html-CQTYBAcn.js" as="script"><link rel="prefetch" href="/assets/2021-12-01-_数据分析与可视化_ 数据绘图要点4-饼图的问题.html-0UeMSQqi.js" as="script"><link rel="prefetch" href="/assets/2021-12-09-_数据分析与可视化_ 数据绘图要点5-误差线的问题.html-DhzzPi1A.js" as="script"><link rel="prefetch" href="/assets/2021-12-19-_数据分析与可视化_ 数据绘图要点6-数据组过多.html-DxlKtPtk.js" as="script"><link rel="prefetch" href="/assets/2021-12-25-_数据分析与可视化_ 数据绘图要点7-过度绘图.html-D-Ae8_u7.js" as="script"><link rel="prefetch" href="/assets/2021-12-29-_数据分析与可视化_ 数据绘图要点8-环状条形图的使用.html-C1VAhFyI.js" as="script"><link rel="prefetch" href="/assets/2022-01-01-_数据分析与可视化_ 数据绘图要点9-颜色的选择.html-CTGyFg8U.js" as="script"><link rel="prefetch" href="/assets/2022-01-06-_数据分析与可视化_ 数据绘图要点10-图例的构建.html-DayQ3cm0.js" as="script"><link rel="prefetch" href="/assets/2022-01-12-_数据分析与可视化_ 数据绘图要点11-雷达图的注意事项.html-Bsu8Dlza.js" as="script"><link rel="prefetch" href="/assets/2022-01-18-_数据分析与可视化_ 数据绘图要点12-图表注释的重要性.html-Cmw0mw4H.js" as="script"><link rel="prefetch" href="/assets/2017-12-10-_机器学习_ 集成学习简单投票法概率.html-C6DrSh3W.js" as="script"><link rel="prefetch" href="/assets/2018-04-17-_机器学习_ sklearn聚类.html-LNhHAFbP.js" as="script"><link rel="prefetch" href="/assets/2018-04-19-_机器学习_ sklearn决策树、随机森林、隐马尔可夫模型.html-B9UuoszF.js" as="script"><link rel="prefetch" href="/assets/2018-04-19-_机器学习_ sklearn朴素贝叶斯算法.html-Ckfxl7XD.js" as="script"><link rel="prefetch" href="/assets/2018-04-21-_机器学习_ sklearn支持向量机.html-DM6X7BKq.js" as="script"><link rel="prefetch" href="/assets/2020-07-25-_机器学习_ Yellowbrick使用笔记1-快速入门.html-ChAURZ8Q.js" as="script"><link rel="prefetch" href="/assets/2020-07-25-_机器学习_ Yellowbrick使用笔记2-模型选择.html-BaSkOjx4.js" as="script"><link rel="prefetch" href="/assets/2020-07-25-_机器学习_ Yellowbrick使用笔记3-特征分析可视化.html-w7uLvbFI.js" as="script"><link rel="prefetch" href="/assets/2020-07-25-_机器学习_ Yellowbrick使用笔记4-目标可视化文件.html-D-LfLc49.js" as="script"><link rel="prefetch" href="/assets/2020-07-25-_机器学习_ Yellowbrick使用笔记5-回归可视化.html-Be6Xmj4W.js" as="script"><link rel="prefetch" href="/assets/2020-07-25-_机器学习_ Yellowbrick使用笔记6-分类可视化.html-0WbfELp4.js" as="script"><link rel="prefetch" href="/assets/2020-07-25-_机器学习_ Yellowbrick使用笔记7-聚类可视化.html-DjoaqHQY.js" as="script"><link rel="prefetch" href="/assets/2020-07-25-_机器学习_ Yellowbrick使用笔记8-模型选择可视化.html-DrTzqQqG.js" as="script"><link rel="prefetch" href="/assets/2020-07-09-_机器学习_ 特征选择笔记1-删除低方差的特征.html-Dt5TCZ4Q.js" as="script"><link rel="prefetch" href="/assets/2020-07-09-_机器学习_ 特征选择笔记2-单变量特征选择.html-B9mqV5Vn.js" as="script"><link rel="prefetch" href="/assets/2020-07-09-_机器学习_ 特征选择笔记3-递归式特征消除.html-DZRj0EJS.js" as="script"><link rel="prefetch" href="/assets/2020-07-09-_机器学习_ 特征选择笔记4-使用SelectFromModel特征选择.html-kIYsRYls.js" as="script"><link rel="prefetch" href="/assets/2024-12-31-_深度学习_ 大模型学习1-大语言模型基础知识.html-Bihg0SCe.js" as="script"><link rel="prefetch" href="/assets/2025-02-28-_深度学习_ 大模型学习2-提示词工程指北.html-CAnmndU-.js" as="script"><link rel="prefetch" href="/assets/2025-07-21-_深度学习_ 大模型学习3上-模型训练与微调.html-DMU-aWll.js" as="script"><link rel="prefetch" href="/assets/2025-07-23-_深度学习_ 大模型学习3下-模型训练与微调.html-DPPt8yXC.js" as="script"><link rel="prefetch" href="/assets/2025-08-08-_深度学习_ 大模型学习4-RAG技术全景解析.html-DITo2uQq.js" as="script"><link rel="prefetch" href="/assets/2025-10-01-_深度学习_ 大模型学习5-高效微调框架Unsloth使用指北.html-Kh37C-sA.js" as="script"><link rel="prefetch" href="/assets/2017-10-11-_深度学习_ 网易云课堂深度学习工程师微专业相关资料.html-D0fPCeaT.js" as="script"><link rel="prefetch" href="/assets/2017-10-12-_深度学习_ 深度学习快速入门资料.html-DWuyL2oq.js" as="script"><link rel="prefetch" href="/assets/2017-10-13-_深度学习_ 卷积神经网络快速入门.html-qgd_i4O5.js" as="script"><link rel="prefetch" href="/assets/2017-11-25-_深度学习_ 深度学习中卷积操作和数学中卷积操作的异同.html-COak7kvh.js" as="script"><link rel="prefetch" href="/assets/2018-07-17-_深度学习_ tf.keras入门1-基本函数介绍.html-DCeqEKut.js" as="script"><link rel="prefetch" href="/assets/2018-07-18-_深度学习_ tf.keras入门2-分类.html-DQ1qWMpc.js" as="script"><link rel="prefetch" href="/assets/2018-07-18-_深度学习_ tf.keras入门3-回归.html-OZr-TODD.js" as="script"><link rel="prefetch" href="/assets/2018-07-18-_深度学习_ tf.keras入门4-过拟合和欠拟合.html-BtS_6ilj.js" as="script"><link rel="prefetch" href="/assets/2018-07-18-_深度学习_ tf.keras入门5-模型保存和载入.html-B1yyZbkq.js" as="script"><link rel="prefetch" href="/assets/2018-07-27-_深度学习_ 经典深度学习模型及其微调（Caffe)总结.html-DtXXt1fm.js" as="script"><link rel="prefetch" href="/assets/2019-07-23-_深度学习_ ncnn安装和调用基础教程.html-mla9LpAW.js" as="script"><link rel="prefetch" href="/assets/2019-08-10-_深度学习_ caffe分类模型训练、结果可视化、部署及量化笔记.html-BjydIN_i.js" as="script"><link rel="prefetch" href="/assets/2019-09-30-_深度学习_ ncnn编译使用.html-bO7MGxCT.js" as="script"><link rel="prefetch" href="/assets/2020-08-07-_深度学习_ ImageAI库使用笔记.html-dO51fmVU.js" as="script"><link rel="prefetch" href="/assets/2020-10-24-_深度学习_ imgaug库使用笔记.html-BN1SjGv9.js" as="script"><link rel="prefetch" href="/assets/2020-11-19-_深度学习_ 深度学习优化器选择学习笔记.html-BCN3-7OZ.js" as="script"><link rel="prefetch" href="/assets/2020-12-09-_深度学习_ Pytorch模型转换为onnx模型笔记.html-SkuWAeMq.js" as="script"><link rel="prefetch" href="/assets/2021-01-14-_深度学习_ ubuntu18.04配置深度学习环境笔记.html-CUJooeLT.js" as="script"><link rel="prefetch" href="/assets/2021-02-02-_深度学习_ imgaug边界框增强笔记.html-DEpFyeyD.js" as="script"><link rel="prefetch" href="/assets/2021-06-09-_深度学习_ CCPD车牌数据集介绍.html-BlQVLzjc.js" as="script"><link rel="prefetch" href="/assets/2022-01-14-_深度学习_ fast-reid入门教程.html-Dgr0eVF4.js" as="script"><link rel="prefetch" href="/assets/2022-02-26-_深度学习_ Python人脸识别库face_recognition使用教程.html-Wbd5rvzA.js" as="script"><link rel="prefetch" href="/assets/2022-07-02-_深度学习_ Python人脸识别库Deepface使用教程.html-HqRv53aU.js" as="script"><link rel="prefetch" href="/assets/2022-11-24-_深度学习_ 搭建行人重识别系统心得.html-RWB2MYyE.js" as="script"><link rel="prefetch" href="/assets/2023-01-03-_深度学习_ 基于切片辅助超推理库SAHI优化小目标识别.html-D3YAfHBx.js" as="script"><link rel="prefetch" href="/assets/2024-03-18-_深度学习_ 计算机视觉低代码工具Supervision库使用指北.html-BRlabnrC.js" as="script"><link rel="prefetch" href="/assets/2024-08-28-_深度学习_ 时间序列分析工具TSLiB库使用指北.html-48pm1e_O.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_编程基础_ C__多线程入门1-创建线程的三种不同方式.html-CEVm5uIQ.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_编程基础_ C__多线程入门10-packaged_task示例.html-DocMoJhX.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_编程基础_ C__多线程入门2-连接和分离线程.html-NL52Y4WU.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_编程基础_ C__多线程入门3-小心地将参数传递给线程.html-OJzhYgeX.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_编程基础_ C__多线程入门4-数据共享和资源竞争.html-Ds5fjYsz.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_编程基础_ C__多线程入门5-使用互斥锁解决资源竞争.html-QD-7To9Z.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_编程基础_ C__多线程入门6-事件处理的需求.html-C1r3a8kd.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_编程基础_ C__多线程入门7-条件变量介绍.html-Bdz8H8YF.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_编程基础_ C__多线程入门8-从线程返回值.html-BXsNyfs0.js" as="script"><link rel="prefetch" href="/assets/2020-05-29-_编程基础_ C__多线程入门9-async教程和示例.html-SiBpmzBy.js" as="script"><link rel="prefetch" href="/assets/2021-10-24-_编程基础_ 常用html标签使用介绍.html-AaJqnKDW.js" as="script"><link rel="prefetch" href="/assets/2017-11-02-_编程基础_ C_自定义类调用窗体控件.html-Dt9lAyct.js" as="script"><link rel="prefetch" href="/assets/2020-05-09-_编程基础_ C和C__内置宏说明.html-CodRHg4y.js" as="script"><link rel="prefetch" href="/assets/2020-06-17-_编程基础_ Python格式化字符串常量f-string总结.html-BOp1GFLb.js" as="script"><link rel="prefetch" href="/assets/2020-06-20-_编程基础_ Python谷歌翻译库googletrans总结.html-Cpv6UlMd.js" as="script"><link rel="prefetch" href="/assets/2020-06-21-_编程基础_ Python数据生成库Faker总结.html-DXZB7D_9.js" as="script"><link rel="prefetch" href="/assets/2020-06-21-_编程基础_ Python配置文件读取库ConfigParser总结.html-D8ceiP57.js" as="script"><link rel="prefetch" href="/assets/2020-06-23-_编程基础_ Python日志记录库logging总结.html-DoQ8bQot.js" as="script"><link rel="prefetch" href="/assets/2020-06-24-_编程基础_ Python随机数生成模块总结.html-Czu3Olw5.js" as="script"><link rel="prefetch" href="/assets/2020-06-25-_编程基础_ Python lambda函数总结.html-DmzyLDq0.js" as="script"><link rel="prefetch" href="/assets/2020-06-25-_编程基础_ Python装饰器入门总结.html-DD6nrhIn.js" as="script"><link rel="prefetch" href="/assets/2020-06-26-_编程基础_ Python列表解析总结.html-2FT6dQUC.js" as="script"><link rel="prefetch" href="/assets/2020-08-01-_编程基础_ Python中的绝对导入与相对导入.html-D-kgzsR0.js" as="script"><link rel="prefetch" href="/assets/2020-08-01-_编程基础_ Python模块和包使用笔记.html-B1JZc-v_.js" as="script"><link rel="prefetch" href="/assets/2020-08-02-_编程基础_ Python对象的浅拷贝与深拷贝笔记.html-C3eV9bNf.js" as="script"><link rel="prefetch" href="/assets/2020-10-14-_编程基础_ Python中args和kwargs参数的使用.html-C7g2eATk.js" as="script"><link rel="prefetch" href="/assets/2020-10-31-_编程基础_ Python命令行解析库argparse学习笔记.html-CSxN_erG.js" as="script"><link rel="prefetch" href="/assets/2021-08-16-_编程基础_ Python字符串替换笔记.html-DWEYK_j_.js" as="script"><link rel="prefetch" href="/assets/2023-09-05-_编程基础_ Python内置模块collections使用笔记.html-BHXC7z3a.js" as="script"><link rel="prefetch" href="/assets/404.html-D48VWrFv.js" as="script"><link rel="prefetch" href="/assets/index.html-CJLCbGgK.js" as="script"><link rel="prefetch" href="/assets/index.html-pCKj9wSE.js" as="script"><link rel="prefetch" href="/assets/index.html-WWMD7EPl.js" as="script"><link rel="prefetch" href="/assets/index.html-B869YxfH.js" as="script"><link rel="prefetch" href="/assets/index.html-BhZvVtO2.js" as="script"><link rel="prefetch" href="/assets/index.html-BRKyYzBl.js" as="script"><link rel="prefetch" href="/assets/index.html-CDrWD1P8.js" as="script"><link rel="prefetch" href="/assets/index.html-JUJPpe1l.js" as="script"><link rel="prefetch" href="/assets/index.html-BEKZDv3H.js" as="script"><link rel="prefetch" href="/assets/index.html-DTG3YjWG.js" as="script"><link rel="prefetch" href="/assets/index.html-CtqtGAYx.js" as="script"><link rel="prefetch" href="/assets/index.html-DTtrZrGn.js" as="script"><link rel="prefetch" href="/assets/index.html-BMYV2MgQ.js" as="script"><link rel="prefetch" href="/assets/index.html-D98NEHXk.js" as="script"><link rel="prefetch" href="/assets/index.html-6NeWiwdL.js" as="script"><link rel="prefetch" href="/assets/index.html-DNOn1htr.js" as="script"><link rel="prefetch" href="/assets/index.html-CToYOmNQ.js" as="script"><link rel="prefetch" href="/assets/index.html-B4EYwIYk.js" as="script"><link rel="prefetch" href="/assets/index.html-C2ntcOFG.js" as="script"><link rel="prefetch" href="/assets/index.html-WeZphgAN.js" as="script"><link rel="prefetch" href="/assets/index.html-YoL9HC1h.js" as="script"><link rel="prefetch" href="/assets/index.html-DSgytngG.js" as="script"><link rel="prefetch" href="/assets/index.html-hBQEf_Yc.js" as="script"><link rel="prefetch" href="/assets/index.html-DI-HAaOP.js" as="script"><link rel="prefetch" href="/assets/index.html-kIbNbN47.js" as="script"><link rel="prefetch" href="/assets/index.html-CPpMvAAZ.js" as="script"><link rel="prefetch" href="/assets/index.html-C484w4wo.js" as="script"><link rel="prefetch" href="/assets/index.html-Dm47NPkL.js" as="script"><link rel="prefetch" href="/assets/index.html-Cu51DFn_.js" as="script"><link rel="prefetch" href="/assets/index.html-BSqZB4al.js" as="script"><link rel="prefetch" href="/assets/index.html-EhGOUNjz.js" as="script"><link rel="prefetch" href="/assets/index.html-BPAGpY_M.js" as="script"><link rel="prefetch" href="/assets/index.html-BqK7hLD-.js" as="script"><link rel="prefetch" href="/assets/index.html--JOn8dCl.js" as="script"><link rel="prefetch" href="/assets/index.html-DjNKAKaO.js" as="script"><link rel="prefetch" href="/assets/index.html-9rk7OVGa.js" as="script"><link rel="prefetch" href="/assets/index.html-CGATpSvT.js" as="script"><link rel="prefetch" href="/assets/index.html-ByNcQHnq.js" as="script"><link rel="prefetch" href="/assets/index.html-CCfZ2xVk.js" as="script"><link rel="prefetch" href="/assets/index.html-DvCvYUAR.js" as="script"><link rel="prefetch" href="/assets/index.html-BSiHg2ya.js" as="script"><link rel="prefetch" href="/assets/index.html-D04oSy5V.js" as="script"><link rel="prefetch" href="/assets/index.html-Dq_FGEcY.js" as="script"><link rel="prefetch" href="/assets/index.html-RGwWhHaL.js" as="script"><link rel="prefetch" href="/assets/index.html-DShK_W7P.js" as="script"><link rel="prefetch" href="/assets/index.html-Bm2_gqBv.js" as="script"><link rel="prefetch" href="/assets/index.html-mTiLUQ2F.js" as="script"><link rel="prefetch" href="/assets/index.html-DWyX0ur1.js" as="script"><link rel="prefetch" href="/assets/index.html-C3t02tlK.js" as="script"><link rel="prefetch" href="/assets/index.html-DHOxM711.js" as="script"><link rel="prefetch" href="/assets/index.html-dsGbDYul.js" as="script"><link rel="prefetch" href="/assets/index.html-DKjHahan.js" as="script"><link rel="prefetch" href="/assets/index.html-DaGXsi4-.js" as="script"><link rel="prefetch" href="/assets/index.html-B7Tt6tvO.js" as="script"><link rel="prefetch" href="/assets/index.html-CN6T4Q_B.js" as="script"><link rel="prefetch" href="/assets/index.html-VD6zeWpH.js" as="script"><link rel="prefetch" href="/assets/index.html-DZ5jbvGm.js" as="script"><link rel="prefetch" href="/assets/index.html-C3WAJ7eJ.js" as="script"><link rel="prefetch" href="/assets/index.html-C9c1YeCQ.js" as="script"><link rel="prefetch" href="/assets/index.html-DYJWH9wb.js" as="script"><link rel="prefetch" href="/assets/index.html-C6mLuqDE.js" as="script"><link rel="prefetch" href="/assets/index.html-DZn1gVyD.js" as="script"><link rel="prefetch" href="/assets/index.html-BxlmUFAF.js" as="script"><link rel="prefetch" href="/assets/index.html-LRxP8P4B.js" as="script"><link rel="prefetch" href="/assets/index.html-Dmi1zZYb.js" as="script"><link rel="prefetch" href="/assets/index.html-C-GhexBQ.js" as="script"><link rel="prefetch" href="/assets/index.html-CR-equgD.js" as="script"><link rel="prefetch" href="/assets/index.html-CDZM2pc9.js" as="script"><link rel="prefetch" href="/assets/index.html-CQqlfi4P.js" as="script"><link rel="prefetch" href="/assets/index.html-DUirfBXV.js" as="script"><link rel="prefetch" href="/assets/index.html-B7UT4ojE.js" as="script"><link rel="prefetch" href="/assets/index.html-q7SdGqBs.js" as="script"><link rel="prefetch" href="/assets/flowchart-CAFN9Lqb.js" as="script"><link rel="prefetch" href="/assets/mermaid.esm.min-DPbUqLDP.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-CMg0yb1C.js" as="script"><link rel="prefetch" href="/assets/browser-CYdOP0d3.js" as="script"><link rel="prefetch" href="/assets/SearchResult-DO0qc5pT.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-DeOkXxfI.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="博客主页" iconsizing="height"><!--[--><i class="vp-icon fas fa-home" sizing="height"></i><!--]-->博客主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/blog/" aria-label="个人博客" iconsizing="height"><!--[--><i class="vp-icon fas fa-blog" sizing="height"></i><!--]-->个人博客<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="关于"><!--[--><i class="vp-icon fas fa-user-plus" sizing="height"></i>关于<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/intro.html" aria-label="关于我" iconsizing="both"><!--[--><i class="vp-icon fas fa-user fa-fw" sizing="both"></i><!--]-->关于我<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about.html" aria-label="关于本站" iconsizing="both"><!--[--><i class="vp-icon fas fa-circle-info fa-fw" sizing="both"></i><!--]-->关于本站<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-center"><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://blog.csdn.net/LuohenYJ" target="_blank" title="开往我的csdn" rel="noopener noreferrer" aria-label="travelling"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor" style="width:1.25rem;height:1.25rem;vertical-align:middle"><path d="M658.836 519.32c-22.121 0-40.145 18.431-40.145 40.957 0 22.528 18.023 40.962 40.145 40.962 22.117 0 40.141-18.434 40.141-40.962 0-22.526-18.024-40.957-40.141-40.957zM364.742 519.32c-22.121 0-40.141 18.431-40.141 40.957 0.41 22.528 18.02 40.962 40.141 40.962 22.117 0 40.141-18.434 40.141-40.962 0-22.526-18.024-40.957-40.141-40.957z" p-id="8700"></path><path d="M512 0C229.23 0 0 229.23 0 512s229.23 512 512 512 512-229.23 512-512S794.77 0 512 0z m133.727 804.81c0 7.375-6.145 13.52-13.516 13.52H391.773c-7.371 0-13.515-6.145-13.515-13.52v-13.516c0-7.371 6.144-13.517 13.515-13.517h240.438c7.371 0 13.516 6.146 13.516 13.517v13.516z m120.832 37.273c-12.289 6.965-27.441 2.867-34.406-9.418l-54.887-96.668c-4.504 0.82-9.422 1.23-13.926 1.23H361.054c-4.914 0-9.421-0.41-13.925-1.23l-54.887 96.668c-6.965 12.285-22.527 16.383-34.406 9.418-12.289-6.961-16.383-22.938-9.422-35.223l51.199-90.113c-27.031-19.66-43.418-52.43-40.957-88.883l19.25-293.273c3.277-49.152 34.406-88.066 87.246-88.066h80.281c0-37.684 29.899-67.993 66.762-67.993 36.868 0 66.766 30.309 66.766 67.993h93.391c53.246 0 70.449 38.914 73.727 88.066l19.25 293.273c2.461 36.453-13.926 69.223-40.957 88.883l51.199 90.113c6.964 12.696 2.867 28.262-9.012 35.223z" p-id="8701"></path><path d="M672.352 314.931H351.633c-14.747 0-26.622 12.285-26.622 27.441v108.953c0 15.157 11.875 27.446 26.622 27.446h320.719c14.746 0 26.625-12.289 26.625-27.446V342.372c0-15.156-11.879-27.441-26.625-27.441z" p-id="8702"></svg></a></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/luohenyueji" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="slimsearch-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="slimsearch-placeholder">搜索</div><div class="slimsearch-key-hints"><kbd class="slimsearch-key">Ctrl</kbd><kbd class="slimsearch-key">K</kbd></div></button><!--]--><!--]--></div><div class="vp-navbar-end"><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="/logo.png" alt><!----><span class="vp-site-name hide-in-pad">落痕月极的博客</span></a><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/" aria-label="博客主页" iconsizing="both"><!--[--><i class="vp-icon fas fa-home fa-fw" sizing="both"></i><!--]-->博客主页<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><i class="vp-icon fas fa-blog fa-fw" sizing="both"></i><span class="vp-sidebar-title">博客</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">编程基础</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">常用工具</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">机器学习</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">讲座论坛</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">论文总结</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">能源化工与仪器科学</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">深度学习</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">数据分析与可视化</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">数学理论</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">随笔所想</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">图像处理</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">音视频处理</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">自然语言处理与语音识别</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">OpenCV</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Python</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">R语言</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">ggplot2入门笔记</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">R语言学习</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/blog/r%E8%AF%AD%E8%A8%80/r%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/2021-02-05-_R%E8%AF%AD%E8%A8%80_%20R%E8%AF%AD%E8%A8%80%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B.html" aria-label="[R语言] R语言快速入门教程" iconsizing="both"><!---->[R语言] R语言快速入门教程<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/r%E8%AF%AD%E8%A8%80/r%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/2019-07-31-_R%E8%AF%AD%E8%A8%80_%20R%E8%AF%AD%E8%A8%80PCA%E5%88%86%E6%9E%90%E6%95%99%E7%A8%8B%20Principal%20Component%20Methods%20in%20R.html" aria-label="[R语言] R语言PCA分析教程 Principal Component Methods in R" iconsizing="both"><!---->[R语言] R语言PCA分析教程 Principal Component Methods in R<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/blog/r%E8%AF%AD%E8%A8%80/r%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/2020-01-10-_R%E8%AF%AD%E8%A8%80_%20WGCNA%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B.html" aria-label="[R语言] WGCNA入门教程" iconsizing="both"><!---->[R语言] WGCNA入门教程<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Visualization</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->[R语言] WGCNA入门教程</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="/" target="_blank" rel="noopener noreferrer">落痕月极</a></span><span property="author" content="落痕月极"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2020年1月10日</span><meta property="datePublished" content="2020-01-10T14:28:55.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 29 分钟</span><meta property="timeRequired" content="PT29M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color3 clickable" role="navigation">R语言</span><!--]--><meta property="articleSection" content="R语言"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color3 clickable" role="navigation">R语言</span><span class="page-tag-item color1 clickable" role="navigation">数据分析与可视化</span><!--]--><meta property="keywords" content="R语言,数据分析与可视化"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><!--[--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-数据输入和清洗">1 数据输入和清洗</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-1-加载基因表达数据">1.1 加载基因表达数据</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-2-数据清洗">1.2 数据清洗</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-3-加载临床特征数据">1.3 加载临床特征数据</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-建设表达网络与模块检测">2 建设表达网络与模块检测</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1-自动一步构建网络与模块检测">2.1 自动一步构建网络与模块检测</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-其他检测算法">2.2 其他检测算法</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-筛选与表型相关的模块">3 筛选与表型相关的模块</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1-量化模块-特质关联">3.1 量化模块-特质关联</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2-基因与性状和重要模块的关系-基因重要性和模块成员">3.2 基因与性状和重要模块的关系：基因重要性和模块成员</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-3-模内分析-鉴定具有高gs和mm的基因">3.3 模内分析：鉴定具有高GS和MM的基因</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-4-网络分析结果总结">3.4 网络分析结果总结</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-使用wgcna进行网络可视化">4 使用WGCNA进行网络可视化</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-1-显示基因网络">4.1 显示基因网络</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-2-可视化特征基因网络">4.2 可视化特征基因网络</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-参考">5 参考</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--]--><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="r语言-wgcna入门教程" tabindex="-1"><a class="header-anchor" href="#r语言-wgcna入门教程"><span>[R语言] WGCNA入门教程</span></a></h1><p><a href="https://github.com/luohenyueji/R-Study-Notes/blob/master/WGCNA/wgcna_tutorial.ipynb" target="_blank" rel="noopener noreferrer"><strong>代码下载地址</strong></a> 本文主要参考WGCNA官网的教程1。整个分析流程可以分为以下几个步骤：</p><ol><li>数据输入和清理</li><li>建设表达网络与模块检测</li><li>筛选与表型相关的模块</li><li>使用WGCNA进行网络可视化</li><li>参考</li></ol><p><strong>WGCNA的安装</strong> 前置软件包安装如果是R语言3.5及以上版本，安装命令如下：</p><blockquote><p>install.packages(&quot;BiocManager&quot;)<br> BiocManager::install(c(&quot;AnnotationDbi&quot;, &quot;impute&quot;,&quot;GO.db&quot;, &quot;preprocessCore&quot;)) install.packages(c(&quot;matrixStats&quot;, &quot;Hmisc&quot;,&quot;foreach&quot;, &quot;doParallel&quot;, &quot;fastcluster&quot;, &quot;dynamicTreeCut&quot;, &quot;survival&quot;)) install.packages(c(&quot;WGCNA&quot;, &quot;stringr&quot;, &quot;reshape2&quot;))</p></blockquote><p>如果R语言3.5以下版本，安装命令如下：</p><blockquote><p>source(&quot;https://bioconductor.org/biocLite.R&quot;) biocLite(c(&quot;AnnotationDbi&quot;, &quot;impute&quot;,&quot;GO.db&quot;, &quot;preprocessCore&quot;)) install.packages(c(&quot;matrixStats&quot;, &quot;Hmisc&quot;,&quot;foreach&quot;, &quot;doParallel&quot;, &quot;fastcluster&quot;, &quot;dynamicTreeCut&quot;, &quot;survival&quot;)) install.packages(c(&quot;WGCNA&quot;, &quot;stringr&quot;, &quot;reshape2&quot;))</p></blockquote><p><strong>专有名词</strong></p><ul><li>共表达网络：定义为加权基因网络。点代表基因，边代表基因表达相关性；</li><li>Module(模块)：高度內连的基因集。在无向网络中，模块内是高度相关的基因。在有向网络中，模块内是高度正相关的基因；</li><li>邻接矩阵(Adjacency matrix)：基因和基因之间的加权相关性值构成的矩阵;</li><li>软阈值：相关性值进行幂次运算幂次的值也就是软阈值;</li><li>连接度(Connectivity)：类似于网络中 &quot;度&quot;degree)的概念。每个基因的连接度是与其相连的基因的边属性之和;</li></ul><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 加载库</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">library</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(WGCNA);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>Warning message:
&quot;package &#39;WGCNA&#39; was built under R version 3.6.1&quot;Loading required package: dynamicTreeCut
Loading required package: fastcluster

Attaching package: &#39;fastcluster&#39;

The following object is masked from &#39;package:stats&#39;:

    hclust



Attaching package: &#39;WGCNA&#39;

The following object is masked from &#39;package:stats&#39;:

    cor
</code></pre><h2 id="_1-数据输入和清洗" tabindex="-1"><a class="header-anchor" href="#_1-数据输入和清洗"><span>1 数据输入和清洗</span></a></h2><p>主要步骤如下：</p><ol><li>加载基因表达数据</li><li>数据清洗</li><li>加载临床特征数据</li></ol><p>数据下载地址：<a href="https://github.com/xndless/helixlife-WGCNA-2018/blob/master/FemaleLiver-Data.zip" target="_blank" rel="noopener noreferrer">FemaleLiver-Data.zip</a></p><h3 id="_1-1-加载基因表达数据" tabindex="-1"><a class="header-anchor" href="#_1-1-加载基因表达数据"><span>1.1 加载基因表达数据</span></a></h3><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 读取文件</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># The following setting is important, do not omit.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果没有显式地指定“stringsAsFactors=FALSE”,默认会将所有的字符串转换为因子,导致数据处理速度较慢</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">options</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stringsAsFactors</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> FALSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Read in the female liver data set 读取135个雌性小鼠的数据</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">femData</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> read.csv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;./data/LiverFemale3600.csv&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Take a quick look at what is in the data set:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看数据的维度</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(femData)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 预览数据</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">head</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(femData)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol class="list-inline"><li>3600</li><li>143</li></ol><table><caption>A data.frame: 6 × 143</caption><thead><tr><th scope="col">substanceBXH</th><th scope="col">gene_symbol</th><th scope="col">LocusLinkID</th><th scope="col">ProteomeID</th><th scope="col">cytogeneticLoc</th><th scope="col">CHROMOSOME</th><th scope="col">StartPosition</th><th scope="col">EndPosition</th><th scope="col">F2_2</th><th scope="col">F2_3</th><th scope="col">...</th><th scope="col">F2_324</th><th scope="col">F2_325</th><th scope="col">F2_326</th><th scope="col">F2_327</th><th scope="col">F2_328</th><th scope="col">F2_329</th><th scope="col">F2_330</th><th scope="col">F2_332</th><th scope="col">F2_355</th><th scope="col">F2_357</th></tr><tr><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">...</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th></tr></thead><tbody><tr><td>MMT00000044</td><td>1700007N18Rik</td><td> 69339</td><td>286025</td><td>0 </td><td>16</td><td> 50911260</td><td> 50912491</td><td>-0.01810</td><td> 0.0642</td><td>...</td><td> 0.047700</td><td>-0.0488</td><td> 0.0168</td><td>-0.0309</td><td> 0.02740</td><td>-0.0310</td><td> 0.0660</td><td>-0.0199</td><td>-0.0146</td><td> 0.065000</td></tr><tr><td>MMT00000046</td><td>Mast2 </td><td> 17776</td><td>157466</td><td>0 </td><td> 4</td><td>115215318</td><td>115372404</td><td>-0.07730</td><td>-0.0297</td><td>...</td><td>-0.049200</td><td>-0.0350</td><td>-0.0738</td><td>-0.1730</td><td>-0.07380</td><td>-0.2010</td><td>-0.0820</td><td>-0.0939</td><td> 0.0192</td><td>-0.049900</td></tr><tr><td>MMT00000051</td><td>Ankrd32 </td><td>105377</td><td>321939</td><td>0 </td><td>13</td><td> 74940309</td><td> 74982847</td><td>-0.02260</td><td> 0.0617</td><td>...</td><td> 0.000612</td><td> 0.1210</td><td> 0.0996</td><td> 0.1090</td><td> 0.02730</td><td> 0.1200</td><td>-0.0629</td><td>-0.0395</td><td> 0.1090</td><td> 0.000253</td></tr><tr><td>MMT00000076</td><td>0 </td><td>383154</td><td> 0</td><td>0 </td><td>16</td><td> 49345114</td><td> 49477048</td><td>-0.00924</td><td>-0.1450</td><td>...</td><td>-0.270000</td><td> 0.0803</td><td> 0.0424</td><td> 0.1610</td><td> 0.05120</td><td> 0.2410</td><td> 0.3890</td><td> 0.0251</td><td>-0.0348</td><td> 0.114000</td></tr><tr><td>MMT00000080</td><td>Ldb2 </td><td> 16826</td><td>157383</td><td>0 </td><td> 5</td><td> 43546124</td><td> 43613704</td><td>-0.04870</td><td> 0.0582</td><td>...</td><td> 0.113000</td><td>-0.0859</td><td>-0.1340</td><td> 0.0639</td><td> 0.00731</td><td> 0.1240</td><td>-0.0212</td><td> 0.0870</td><td> 0.0512</td><td> 0.024300</td></tr><tr><td>MMT00000102</td><td>Rdhs </td><td>216453</td><td> 0</td><td>10_70.0_cM</td><td>10</td><td> 1337265</td><td> 1347607</td><td> 0.17600</td><td>-0.1890</td><td>...</td><td>-0.080000</td><td>-0.1200</td><td> 0.1230</td><td> 0.1870</td><td> 0.05410</td><td> 0.0699</td><td> 0.0708</td><td> 0.1450</td><td>-0.0399</td><td> 0.037500</td></tr></tbody></table><p>提供的基因表达数据中，还有额外的冗余数据，需要把多余注释信息去除，代码如下：</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#  删除冗余数据-c(1:8)删除前8列数据，t()转置数据</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">datExpr0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> as.data.frame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(femData[, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)]));</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">head</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr0)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><caption>A data.frame: 6 × 3600</caption><thead><tr><th></th><th scope="col">V1</th><th scope="col">V2</th><th scope="col">V3</th><th scope="col">V4</th><th scope="col">V5</th><th scope="col">V6</th><th scope="col">V7</th><th scope="col">V8</th><th scope="col">V9</th><th scope="col">V10</th><th scope="col">...</th><th scope="col">V3591</th><th scope="col">V3592</th><th scope="col">V3593</th><th scope="col">V3594</th><th scope="col">V3595</th><th scope="col">V3596</th><th scope="col">V3597</th><th scope="col">V3598</th><th scope="col">V3599</th><th scope="col">V3600</th></tr><tr><th></th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">...</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th></tr></thead><tbody><tr><th scope="row">F2_2</th><td>-0.0181000</td><td>-0.0773</td><td>-0.02260000</td><td>-0.00924</td><td>-0.04870000</td><td> 0.17600000</td><td>0.07680000</td><td>-0.14800000</td><td> 0.06870000</td><td> 0.06090000</td><td>...</td><td> 0.0135000</td><td>-0.15400000</td><td>-0.0218000</td><td> 0.0310000</td><td>0.1290000</td><td> 0.0467000</td><td> 0.00991000</td><td> 0.0291000</td><td>-0.00927</td><td> 0.0436000</td></tr><tr><th scope="row">F2_3</th><td> 0.0642000</td><td>-0.0297</td><td> 0.06170000</td><td>-0.14500</td><td> 0.05820000</td><td>-0.18900000</td><td>0.18600000</td><td> 0.17700000</td><td> 0.10100000</td><td> 0.05570000</td><td>...</td><td>-0.0097100</td><td>-0.07410000</td><td> 0.0900000</td><td> 0.0106000</td><td>0.1130000</td><td>-0.0252000</td><td> 0.03190000</td><td> 0.0408000</td><td>-0.12100</td><td> 0.0827000</td></tr><tr><th scope="row">F2_14</th><td> 0.0000644</td><td> 0.1120</td><td>-0.12900000</td><td> 0.02870</td><td>-0.04830000</td><td>-0.06500000</td><td>0.21400000</td><td>-0.13200000</td><td> 0.10900000</td><td> 0.19100000</td><td>...</td><td> 0.0709000</td><td>-0.13900000</td><td> 0.0277000</td><td>-0.1310000</td><td>0.2550000</td><td>-0.1230000</td><td> 0.08800000</td><td> 0.0892000</td><td>-0.11400</td><td>-0.0872000</td></tr><tr><th scope="row">F2_15</th><td>-0.0580000</td><td>-0.0589</td><td> 0.08710000</td><td>-0.04390</td><td>-0.03710000</td><td>-0.00846000</td><td>0.12000000</td><td> 0.10700000</td><td>-0.00858000</td><td>-0.12100000</td><td>...</td><td>-0.0313000</td><td>-0.07250000</td><td> 0.0178000</td><td> 0.0882000</td><td>0.0790000</td><td> 0.0002760</td><td>-0.04820000</td><td> 0.0493000</td><td>-0.05010</td><td>-0.0390000</td></tr><tr><th scope="row">F2_19</th><td> 0.0483000</td><td> 0.0443</td><td>-0.11500000</td><td> 0.00425</td><td> 0.02510000</td><td>-0.00574000</td><td>0.02100000</td><td>-0.11900000</td><td> 0.10500000</td><td> 0.05410000</td><td>...</td><td> 0.0695000</td><td>-0.11500000</td><td> 0.0618000</td><td> 0.2950000</td><td>0.1270000</td><td>-0.0560000</td><td>-0.02890000</td><td>-0.0389000</td><td> 0.00718</td><td> 0.0710000</td></tr><tr><th scope="row">F2_20</th><td>-0.1519741</td><td>-0.0938</td><td>-0.06502607</td><td>-0.23610</td><td> 0.08504274</td><td>-0.01807182</td><td>0.06222751</td><td>-0.05497686</td><td>-0.02441415</td><td> 0.06343181</td><td>...</td><td> 0.1743492</td><td>-0.09405315</td><td> 0.1176646</td><td> 0.1161963</td><td>0.1180381</td><td>-0.1171272</td><td>-0.09774204</td><td>-0.0745188</td><td> 0.31857</td><td> 0.2047701</td></tr></tbody></table><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将原数据的行列名复制过来</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr0) = femData</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">substanceBXH;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">rownames</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr0) = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(femData)[</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)];</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">head</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr0)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><caption>A data.frame: 6 × 3600</caption><thead><tr><th></th><th scope="col">MMT00000044</th><th scope="col">MMT00000046</th><th scope="col">MMT00000051</th><th scope="col">MMT00000076</th><th scope="col">MMT00000080</th><th scope="col">MMT00000102</th><th scope="col">MMT00000149</th><th scope="col">MMT00000159</th><th scope="col">MMT00000207</th><th scope="col">MMT00000212</th><th scope="col">...</th><th scope="col">MMT00082822</th><th scope="col">MMT00082828</th><th scope="col">MMT00082829</th><th scope="col">MMT00082832</th><th scope="col">MMT00082847</th><th scope="col">MMT00082850</th><th scope="col">MMT00082869</th><th scope="col">MMT00082877</th><th scope="col">MMT00082899</th><th scope="col">MMT00082906</th></tr><tr><th></th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">...</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th></tr></thead><tbody><tr><th scope="row">F2_2</th><td>-0.0181000</td><td>-0.0773</td><td>-0.02260000</td><td>-0.00924</td><td>-0.04870000</td><td> 0.17600000</td><td>0.07680000</td><td>-0.14800000</td><td> 0.06870000</td><td> 0.06090000</td><td>...</td><td> 0.0135000</td><td>-0.15400000</td><td>-0.0218000</td><td> 0.0310000</td><td>0.1290000</td><td> 0.0467000</td><td> 0.00991000</td><td> 0.0291000</td><td>-0.00927</td><td> 0.0436000</td></tr><tr><th scope="row">F2_3</th><td> 0.0642000</td><td>-0.0297</td><td> 0.06170000</td><td>-0.14500</td><td> 0.05820000</td><td>-0.18900000</td><td>0.18600000</td><td> 0.17700000</td><td> 0.10100000</td><td> 0.05570000</td><td>...</td><td>-0.0097100</td><td>-0.07410000</td><td> 0.0900000</td><td> 0.0106000</td><td>0.1130000</td><td>-0.0252000</td><td> 0.03190000</td><td> 0.0408000</td><td>-0.12100</td><td> 0.0827000</td></tr><tr><th scope="row">F2_14</th><td> 0.0000644</td><td> 0.1120</td><td>-0.12900000</td><td> 0.02870</td><td>-0.04830000</td><td>-0.06500000</td><td>0.21400000</td><td>-0.13200000</td><td> 0.10900000</td><td> 0.19100000</td><td>...</td><td> 0.0709000</td><td>-0.13900000</td><td> 0.0277000</td><td>-0.1310000</td><td>0.2550000</td><td>-0.1230000</td><td> 0.08800000</td><td> 0.0892000</td><td>-0.11400</td><td>-0.0872000</td></tr><tr><th scope="row">F2_15</th><td>-0.0580000</td><td>-0.0589</td><td> 0.08710000</td><td>-0.04390</td><td>-0.03710000</td><td>-0.00846000</td><td>0.12000000</td><td> 0.10700000</td><td>-0.00858000</td><td>-0.12100000</td><td>...</td><td>-0.0313000</td><td>-0.07250000</td><td> 0.0178000</td><td> 0.0882000</td><td>0.0790000</td><td> 0.0002760</td><td>-0.04820000</td><td> 0.0493000</td><td>-0.05010</td><td>-0.0390000</td></tr><tr><th scope="row">F2_19</th><td> 0.0483000</td><td> 0.0443</td><td>-0.11500000</td><td> 0.00425</td><td> 0.02510000</td><td>-0.00574000</td><td>0.02100000</td><td>-0.11900000</td><td> 0.10500000</td><td> 0.05410000</td><td>...</td><td> 0.0695000</td><td>-0.11500000</td><td> 0.0618000</td><td> 0.2950000</td><td>0.1270000</td><td>-0.0560000</td><td>-0.02890000</td><td>-0.0389000</td><td> 0.00718</td><td> 0.0710000</td></tr><tr><th scope="row">F2_20</th><td>-0.1519741</td><td>-0.0938</td><td>-0.06502607</td><td>-0.23610</td><td> 0.08504274</td><td>-0.01807182</td><td>0.06222751</td><td>-0.05497686</td><td>-0.02441415</td><td> 0.06343181</td><td>...</td><td> 0.1743492</td><td>-0.09405315</td><td> 0.1176646</td><td> 0.1161963</td><td>0.1180381</td><td>-0.1171272</td><td>-0.09774204</td><td>-0.0745188</td><td> 0.31857</td><td> 0.2047701</td></tr></tbody></table><h3 id="_1-2-数据清洗" tabindex="-1"><a class="header-anchor" href="#_1-2-数据清洗"><span>1.2 数据清洗</span></a></h3><p>我们首先检查缺失值过多的基因和样本，通过goodSamplesGenes检查缺失值，verbose详细程度。</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">gsg</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> goodSamplesGenes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr0, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">verbose</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gsg</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">allOK;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><pre><code> Flagging genes and samples with too many missing values...
  ..step 1
</code></pre><p>TRUE</p><p>如果样本检查语句返回TRUE，那么没有缺失值。如果不是的话，我们会移除那些有问题的基因和样本。通过以下代码来移除缺失值</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gsg</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">allOK)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # Optionally, print the gene and sample names that were removed:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 打印删除的基因和样本名称</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">sum</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gsg</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">goodGenes)</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">        printFlush</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Removing genes:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr0)[</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gsg</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">goodGenes], </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">collapse</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;, &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)));</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">sum</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gsg</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">goodSamples)</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">        printFlush</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Removing samples:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">rownames</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr0)[</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gsg</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">goodSamples], </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">collapse</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;, &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)));</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # Remove the offending genes and samples from the data:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 从数据中删除有问题的基因和样本</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    datExpr0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> datExpr0[gsg</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">goodSamples, gsg</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">goodGenes]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接下来我们对样本进行聚类（与随后的基因聚类相比），看看是否有明显的异常值。</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># hclusts聚类算法, dist计算基因之间的距离</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sampleTree</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> hclust</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dist</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr0), </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">method</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;average&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Plot the sample tree: Open a graphic output window of size 12 by 9 inches</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># The user should change the dimensions if the window is too large or too small.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 绘制聚类树，sizeGrWindow设置绘图窗口大小</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># sizeGrWindow(16,9)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">pdf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;./plot/sampleClustering.pdf&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">width</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 12</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">height</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置文字大小</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">par</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置图像边距c(bottom, left, top, right) </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># par(mar = c(0,4,2,0))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 画图 main标题，sub子标题，xlab x轴标题，cex.lab标题字体大小，cex.axis坐标轴刻度大小，cex.main主标题字体</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">plot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sampleTree, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Sample clustering to detect outliers&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sub</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">xlab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex.lab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex.axis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex.main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dev.off</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>png:</strong> 2</p><p>由上图图能够看出，F2_221 这个样本和其他样本差距非常大，需要将该样本过滤掉。过滤代码如下</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Plot a line to show the cut</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置文字大小</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">par</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">plot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sampleTree, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Sample clustering to detect outliers&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sub</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">xlab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex.lab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex.axis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex.main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在上图上画红线</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">abline</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">h</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 15</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">col</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;red&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Determine cluster under the line</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 剪枝算法，cutHeight 修剪树枝的高度 minSize集群最小数</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">clust</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> cutreeStatic</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sampleTree, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cutHeight</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 15</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">minSize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 剪枝结果</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(clust)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># clust 1 contains the samples we want to keep</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">keepSamples</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (clust</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 符合要求的数据</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">datExpr</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> datExpr0[keepSamples, ]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 提取行</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">nSamples</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> nrow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 提取列</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">nGenes</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> ncol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>clust
  0   1 
  1 134 
</code></pre><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzE3XzEucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h3 id="_1-3-加载临床特征数据" tabindex="-1"><a class="header-anchor" href="#_1-3-加载临床特征数据"><span>1.3 加载临床特征数据</span></a></h3><p>我们现在读取性状数据，并将测量它们的样本与表达样本相匹配。</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">traitData</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> read.csv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;./data/ClinicalTraits.csv&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(traitData)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#names(traitData)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># remove columns that hold information we do not need.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除不需要的列</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">allTraits</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> traitData[, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">31</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)];</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">allTraits</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> allTraits[, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">11</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">36</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) ];</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(allTraits)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">head</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(allTraits)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># names(allTraits)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol class="list-inline"><li>361</li><li>38</li></ol><ol class="list-inline"><li>361</li><li>27</li></ol><table><caption>A data.frame: 6 × 27</caption><thead><tr><th scope="col">Mice</th><th scope="col">weight_g</th><th scope="col">length_cm</th><th scope="col">ab_fat</th><th scope="col">other_fat</th><th scope="col">total_fat</th><th scope="col">X100xfat_weight</th><th scope="col">Trigly</th><th scope="col">Total_Chol</th><th scope="col">HDL_Chol</th><th scope="col">...</th><th scope="col">Leptin_pg_ml</th><th scope="col">Adiponectin</th><th scope="col">Aortic.lesions</th><th scope="col">Aneurysm</th><th scope="col">Aortic_cal_M</th><th scope="col">Aortic_cal_L</th><th scope="col">CoronaryArtery_Cal</th><th scope="col">Myocardial_cal</th><th scope="col">BMD_all_limbs</th><th scope="col">BMD_femurs_only</th></tr><tr><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">...</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th></tr></thead><tbody><tr><td>F2_290</td><td>36.9</td><td> 9.9</td><td>2.53</td><td>2.26</td><td>4.79</td><td>12.981030</td><td> 53</td><td>1167</td><td>50</td><td>...</td><td>245462.00</td><td>11.274</td><td>496250</td><td>16</td><td> 0</td><td>17</td><td>0</td><td> 0</td><td> NA</td><td> NA</td></tr><tr><td>F2_291</td><td>48.5</td><td>10.7</td><td>2.90</td><td>2.97</td><td>5.87</td><td>12.103093</td><td> 61</td><td>1230</td><td>32</td><td>...</td><td> 84420.88</td><td> 7.099</td><td> NA</td><td>16</td><td> 4</td><td> 0</td><td>2</td><td> 4</td><td>0.0548</td><td>0.07730</td></tr><tr><td>F2_292</td><td>45.7</td><td>10.4</td><td>1.04</td><td>2.31</td><td>3.35</td><td> 7.330416</td><td> 41</td><td>1285</td><td>81</td><td>...</td><td>105889.76</td><td> 5.795</td><td>218500</td><td> 0</td><td> 0</td><td>11</td><td>0</td><td> 0</td><td>0.0554</td><td>0.08065</td></tr><tr><td>F2_293</td><td>50.3</td><td>10.9</td><td>0.91</td><td>1.89</td><td>2.80</td><td> 5.566600</td><td>271</td><td>1299</td><td>64</td><td>...</td><td>100398.68</td><td> 5.495</td><td> 61250</td><td> 0</td><td> 0</td><td> 0</td><td>0</td><td>236</td><td>0.0597</td><td>0.08680</td></tr><tr><td>F2_294</td><td>44.8</td><td> 9.8</td><td>1.22</td><td>2.47</td><td>3.69</td><td> 8.236607</td><td>114</td><td>1410</td><td>50</td><td>...</td><td>130846.30</td><td> 6.868</td><td>243750</td><td>12</td><td>10</td><td> 0</td><td>0</td><td> 0</td><td> NA</td><td> NA</td></tr><tr><td>F2_295</td><td>39.2</td><td>10.2</td><td>3.06</td><td>2.49</td><td>5.55</td><td>14.158163</td><td> 72</td><td>1533</td><td>18</td><td>...</td><td> 75166.22</td><td>17.328</td><td>104250</td><td>17</td><td> 2</td><td> 0</td><td>0</td><td> 0</td><td>0.0557</td><td>0.07700</td></tr></tbody></table><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 形成一个类似于表达数据的数据框架，以保存临床特征</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 提取行名</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">femaleSamples</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> rownames</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数据匹配 返回匹配行</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">traitRows</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> match</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(femaleSamples, allTraits</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Mice);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 提取指定要求行</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">datTraits</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> allTraits[traitRows, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 提取行名</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">rownames</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datTraits) = allTraits[traitRows, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 垃圾回收</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">collectGarbage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>现在我们有了变量datExpr中的表达式数据，以及变量dattitries中相应的临床特征。在我们继续进行网络构建和模块检测之前，我们将可视化临床特征与样本树状图的关系。</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Re-cluster samples</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 画聚类图</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sampleTree2</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> hclust</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dist</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr), </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">method</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;average&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Convert traits to a color representation: white means low, red means high, grey means missing entry</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 画表型的热图</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将特征转换为颜色表示：白色表示低，红色表示高，灰色表示缺少条目</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果signed为true 以绿色开头代表最大负值，以白色开头代表零附近的值，然后变为红色代表正值</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">traitColors</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> numbers2colors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datTraits, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">signed</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">FALSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Plot the sample dendrogram and the colors underneath.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 绘制出树状图和下面的颜色 </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">plotDendroAndColors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sampleTree2, traitColors,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">groupLabels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datTraits),</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Sample dendrogram and trait heatmap&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzIyXzAucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h2 id="_2-建设表达网络与模块检测" tabindex="-1"><a class="header-anchor" href="#_2-建设表达网络与模块检测"><span>2 建设表达网络与模块检测</span></a></h2><p>此步骤是使用WGCNA方法进行所有网络分析的基础。我们提出三种不同的方法构建网络并识别模块：</p><ul><li>使用方便的一步网络结构和模块检测功能，适合希望以最小努力达到结果的用户；</li><li>为希望使用定制/替代方法进行实验的用户逐步构建网络和模块检测；</li><li>一种自动分块网络结构和模块检测方法，适用于希望分析太大而无法同时分析的数据集的用户。</li></ul><p>主要步骤如下：</p><ol><li>自动一步构建网络与模块检测</li><li>其他检测算法</li></ol><h3 id="_2-1-自动一步构建网络与模块检测" tabindex="-1"><a class="header-anchor" href="#_2-1-自动一步构建网络与模块检测"><span>2.1 自动一步构建网络与模块检测</span></a></h3><p>在本教程中，我们将演示一步式自动网络构建和模块检测，主要步骤有：</p><ol><li>软阈值的选择：网络拓扑分析</li><li>一步构建网络与模块检测</li></ol><h4 id="_2-1-1-软阈值的选择-网络拓扑分析" tabindex="-1"><a class="header-anchor" href="#_2-1-1-软阈值的选择-网络拓扑分析"><span>2.1.1 软阈值的选择：网络拓扑分析</span></a></h4><p>构建一个加权基因网络需要选择软阈值幂β来计算邻接矩阵权重参数,即将基因间的相关系数进行乘方运算来表征其相关性，首先需要确定乘方的值</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Choose a set of soft-thresholding powers</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 给出候选的β值，c(1:10)表示1到10；seq(from = 12, to=20, by=2)表示从12开始间隔两个数到20</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">powers</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">seq</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 12</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">to</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">by</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">powers</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Call the network topology analysis function 调用网络拓扑分析函数</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># verbose表示输出结果详细程度</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sft</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> pickSoftThreshold</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">powerVector</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> powers, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">verbose</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol class="list-inline"><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>12</li><li>14</li><li>16</li><li>18</li><li>20</li></ol><pre><code>Warning message:
&quot;executing %dopar% sequentially: no parallel backend registered&quot;

   Power SFT.R.sq  slope truncated.R.sq mean.k. median.k. max.k.
1      1   0.0278  0.345          0.456  747.00  762.0000 1210.0
2      2   0.1260 -0.597          0.843  254.00  251.0000  574.0
3      3   0.3400 -1.030          0.972  111.00  102.0000  324.0
4      4   0.5060 -1.420          0.973   56.50   47.2000  202.0
5      5   0.6810 -1.720          0.940   32.20   25.1000  134.0
6      6   0.9020 -1.500          0.962   19.90   14.5000   94.8
7      7   0.9210 -1.670          0.917   13.20    8.6800   84.1
8      8   0.9040 -1.720          0.876    9.25    5.3900   76.3
9      9   0.8590 -1.700          0.836    6.80    3.5600   70.5
10    10   0.8330 -1.660          0.831    5.19    2.3800   65.8
11    12   0.8530 -1.480          0.911    3.33    1.1500   58.1
12    14   0.8760 -1.380          0.949    2.35    0.5740   51.9
13    16   0.9070 -1.300          0.970    1.77    0.3090   46.8
14    18   0.9120 -1.240          0.973    1.39    0.1670   42.5
15    20   0.9310 -1.210          0.977    1.14    0.0951   38.7
</code></pre><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># sft这中保存了每个powers值计算出来的网络特征,其中powerEstimate就是最佳power值，fitIndices保存了每个power对应的网络的特征。</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sft)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>List of 2
 $ powerEstimate: num 6
 $ fitIndices   :&#39;data.frame&#39;:	15 obs. of  7 variables:
  ..$ Power         : num [1:15] 1 2 3 4 5 6 7 8 9 10 ...
  ..$ SFT.R.sq      : num [1:15] 0.0278 0.1264 0.3404 0.5062 0.6807 ...
  ..$ slope         : num [1:15] 0.345 -0.597 -1.03 -1.422 -1.716 ...
  ..$ truncated.R.sq: num [1:15] 0.456 0.843 0.972 0.973 0.94 ...
  ..$ mean.k.       : num [1:15] 747 254.5 111 56.5 32.2 ...
  ..$ median.k.     : num [1:15] 761.7 250.8 101.7 47.2 25.1 ...
  ..$ max.k.        : num [1:15] 1206 574 324 202 134 ...
</code></pre><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Plot the results 结果绘图</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置窗格大小</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#sizeGrWindow(9, 5)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置图的显示一行两列</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># par(mfrow = c(1,2));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex1</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Scale-free topology fit index as a function of the soft-thresholding power</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 生成阈值和网络的特征之间的关系函数</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">plot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fitIndices[,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">sign</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fitIndices[,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fitIndices[,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">xlab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Soft Threshold (power)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">ylab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Scale Free Topology Model Fit,signed R^2&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">type</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;n&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Scale independence&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fitIndices[,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">sign</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fitIndices[,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fitIndices[,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">labels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">powers,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cex1,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">col</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;red&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># this line corresponds to using an R^2 cut-off of h</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">abline</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">h</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.90</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">col</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;red&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># sft$fitIndices 保存了每个power构建的相关性网络中的连接度的统计值，k就是连接度值，每个power值提供了max, median, max3种连接度的统计量</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 对连接度的均值进行可视化</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Mean connectivity as a function of the soft-thresholding power</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">plot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fitIndices[,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fitIndices[,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">xlab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Soft Threshold (power)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">ylab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Mean Connectivity&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">type</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;n&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Mean connectivity&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fitIndices[,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">fitIndices[,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">labels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">powers, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cex1,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">col</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;red&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzI5XzAucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzI5XzEucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h4 id="_2-1-2-一步构建网络与模块检测" tabindex="-1"><a class="header-anchor" href="#_2-1-2-一步构建网络与模块检测"><span>2.1.2 一步构建网络与模块检测</span></a></h4><p>确定好power值即可构建基因网络，构建基因网络和识别模块现在是一个简单的函数调用：</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># datExpr表达数据，TOMType拓扑重叠矩阵计算方式，minModuleSize用于模块检测的最小模块尺寸,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># reassignThreshold 是否在模块之间重新分配基因的p值比率阈值，mergeCutHeight 树状图切割高度</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># numericLabels 返回的模块应该用颜色（FALSE）还是数字（TRUE）标记,pamRespectsDendro树状图相关参数</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># saveTOMs 字符串的向量，saveTOMFileBase 包含包含共识拓扑重叠文件的文件名库的字符串</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">net</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> blockwiseModules</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">power</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sft</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">powerEstimate,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">TOMType</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;unsigned&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">minModuleSize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">reassignThreshold</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">                       mergeCutHeight</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.25</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">numericLabels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> TRUE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">pamRespectsDendro</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> FALSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">saveTOMs</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> TRUE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">                       saveTOMFileBase</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;femaleMouseTOM&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">verbose</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code> Calculating module eigengenes block-wise from all genes
   Flagging genes and samples with too many missing values...
    ..step 1
Cluster size 3600 broken into 2108 1492 
Cluster size 2108 broken into 1126 982 
Done cluster 1126 
Done cluster 982 
Done cluster 2108 
Done cluster 1492 
 ..Working on block 1 .
    TOM calculation: adjacency..
    ..will not use multithreading.
     Fraction of slow calculations: 0.396405
    ..connectivity..
    ..matrix multiplication (system BLAS)..
    ..normalization..
    ..done.
   ..saving TOM for block 1 into file femaleMouseTOM-block.1.RData
 ....clustering..
 ....detecting modules..
 ....calculating module eigengenes..
 ....checking kME in modules..
     ..removing 1 genes from module 1 because their KME is too low.
     ..removing 1 genes from module 7 because their KME is too low.
     ..removing 1 genes from module 8 because their KME is too low.
     ..removing 1 genes from module 21 because their KME is too low.
 ..merging modules that are too close..
     mergeCloseModules: Merging modules whose distance is less than 0.25
       Calculating new MEs...
</code></pre><p>我们现在回到网络分析。要查看标识了多少个模块以及模块大小</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(net</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">colors)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><pre><code>  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18 
 99 609 460 409 316 312 221 211 157 123 106 100  94  91  77  76  58  47  34 
</code></pre><p>指示有18个模块，按大小降序标记为1至18，大小范围为609至34个基因。 标签0保留用于所有模块外部的基因。 用于模块识别的分层聚类树状图（树）以net $ dendrograms [[1]]返回； 可以使用以下代码将树状图与颜色分配一起显示：</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># open a graphics window</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># sizeGrWindow(12, 9)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Convert labels to colors for plotting</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将标签转化为绘图颜色</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">mergedColors</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> labels2colors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(net</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">colors)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Plot the dendrogram and the module colors underneath</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 绘制树状图和下面的模块颜色</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># dendroLabels树状图标签。设置为FALSE完全禁用树状图标签；设置为NULL使用的行标签datExpr</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># addGuide是否应在树状图中添加垂直的“指导线”？线条使识别单个样本的颜色代码更加容易。</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">plotDendroAndColors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(net</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">dendrograms[[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]], mergedColors[net</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">blockGenes[[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]]],</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Module colors&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">                    dendroLabels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> FALSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">hang</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.03</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">addGuide</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> TRUE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">guideHang</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.05</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzM2XzAucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p>结果图如上图所示。我们注意到，如果用户想更改条件，则该软件包提供了recutBlockwiseTrees函数，该函数可以应用修改后的条件而不必重新计算网络和聚类树状图。 这样可以节省大量时间。 现在，我们保存后续分析所需的模块分配和模块本征信息。</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">moduleLabels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> net</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">colors</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">moduleColors</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> labels2colors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(net</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">colors)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">MEs</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> net</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MEs;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">geneTree</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> net</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">dendrograms[[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]];</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">save</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs, moduleLabels, moduleColors, geneTree,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;FemaleLiver-02-networkConstruction-auto.RData&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-其他检测算法" tabindex="-1"><a class="header-anchor" href="#_2-2-其他检测算法"><span>2.2 其他检测算法</span></a></h3><p>其他算法包括分步网络构建和模块检测、处理大型数据集：逐块网络构建和模块检测就不再表述具体见下列链接：</p><blockquote><p>https://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/Tutorials/FemaleLiver-02-networkConstr-man.pdf https://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/Tutorials/FemaleLiver-02-networkConstr-blockwise.pdf</p></blockquote><h2 id="_3-筛选与表型相关的模块" tabindex="-1"><a class="header-anchor" href="#_3-筛选与表型相关的模块"><span>3 筛选与表型相关的模块</span></a></h2><p>主要步骤如下：</p><ol><li>量化模块-特质关联</li><li>基因与性状和重要模块的关系：基因重要性和模块成员</li><li>模块内分析：鉴定具有高GS和MM的基因</li><li>网络分析结果总结</li></ol><h3 id="_3-1-量化模块-特质关联" tabindex="-1"><a class="header-anchor" href="#_3-1-量化模块-特质关联"><span>3.1 量化模块-特质关联</span></a></h3><p>在此分析中，我们想确定与所测量的临床特征显着相关的模块。 由于我们已经为每个模块建立了一个概要文件（特征基因），因此我们只需将特征基因与外部特征相关联，然后寻找最重要的关联，实际上是计算模块的ME值与表型的相关系数：</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Define numbers of genes and samples</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 获得基因数和样本数</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">nGenes</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> ncol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">nSamples</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> nrow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Recalculate MEs with color labels</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 用彩色标签重新计算MEs</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在给定的单个数据集中计算模块的模块本征基因</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">MEs0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> moduleEigengenes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr, moduleColors)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">eigengenes</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 对给定的（特征）向量进行重新排序，以使相似的向量（通过相关性度量）彼此相邻</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">MEs</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> orderMEs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs0)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 计算module的ME值与表型的相关系数</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">moduleTraitCor</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> cor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs, datTraits, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">use</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;p&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">moduleTraitPvalue</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> corPvalueStudent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(moduleTraitCor, nSamples);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>由于我们的模块和特征数量适中，因此合适的图形表示形式将有助于阅读表格。 我们通过相关值对每个关联进行颜色编码：</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol class="list-inline"><li>&#39;MEmagenta&#39;</li><li>&#39;MEblack&#39;</li><li>&#39;MEturquoise&#39;</li><li>&#39;MEgreen&#39;</li><li>&#39;MElightcyan&#39;</li><li>&#39;MEblue&#39;</li><li>&#39;MEbrown&#39;</li><li>&#39;MEred&#39;</li><li>&#39;MEsalmon&#39;</li><li>&#39;MEyellow&#39;</li><li>&#39;MElightgreen&#39;</li><li>&#39;MEgreenyellow&#39;</li><li>&#39;MEgrey60&#39;</li><li>&#39;MEpink&#39;</li><li>&#39;MEpurple&#39;</li><li>&#39;MEtan&#39;</li><li>&#39;MEcyan&#39;</li><li>&#39;MEmidnightblue&#39;</li><li>&#39;MEgrey&#39;</li></ol><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># sizeGrWindow(10,6)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 显示相关性及其p值</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">textMatrix</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">signif</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(moduleTraitCor, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">(&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">signif</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(moduleTraitPvalue, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sep</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(textMatrix) = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(moduleTraitCor)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">par</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">mar</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Display the correlation values within a heatmap plot\</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ySymbols 当ylabels使用时所使用的其他标签； colorLabels 应该使用颜色标签吗</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># colors 颜色； textMatrix 单元格名字</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">labeledHeatmap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">Matrix</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> moduleTraitCor,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">xLabels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datTraits),</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">yLabels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs),</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">ySymbols</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">               colorLabels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> FALSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">colors</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> greenWhiteRed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">textMatrix</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> textMatrix,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">setStdMargins</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> FALSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">               cex.text</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">zlim</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Module-trait relationships&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>Warning message in greenWhiteRed(50):
&quot;WGCNA::greenWhiteRed: this palette is not suitable for people
with green-red color blindness (the most common kind of color blindness).
Consider using the function blueWhiteRed instead.&quot;
</code></pre><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzQ1XzEucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">sizeGrWindow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Will display correlations and their p-values</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(textMatrix) = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(moduleTraitCor)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">par</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">mar</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Display the correlation values within a heatmap plot</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">labeledHeatmap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">Matrix</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> moduleTraitCor,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">xLabels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datTraits),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">yLabels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">ySymbols</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">colorLabels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> FALSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">colors</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> greenWhiteRed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">textMatrix</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> textMatrix,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">setStdMargins</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> FALSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex.text</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">zlim</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Module-trait relationships&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>Warning message in greenWhiteRed(50):
&quot;WGCNA::greenWhiteRed: this palette is not suitable for people
with green-red color blindness (the most common kind of color blindness).
Consider using the function blueWhiteRed instead.&quot;
</code></pre><h3 id="_3-2-基因与性状和重要模块的关系-基因重要性和模块成员" tabindex="-1"><a class="header-anchor" href="#_3-2-基因与性状和重要模块的关系-基因重要性和模块成员"><span>3.2 基因与性状和重要模块的关系：基因重要性和模块成员</span></a></h3><p>我们量化阵列上所有基因与每个模块的相似性寻找重要模块</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Define variable weight containing the weight column of datTrait</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 定义包含数据特征权重列的变量权重</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">weight</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> as.data.frame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datTraits</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">weight_g);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(weight) = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;weight&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">geneModuleMembership</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> as.data.frame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr, MEs, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">use</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;p&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 模块的名称(颜色) substring提取文本从第3个字母开始</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">modNames</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> substring</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs), </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 基因和模块的相关系数</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">geneModuleMembership</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> as.data.frame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr, MEs, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">use</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;p&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">MMPvalue</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> as.data.frame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">corPvalueStudent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">as.matrix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneModuleMembership), nSamples));</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneModuleMembership) = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;MM&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, modNames, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sep</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MMPvalue) = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;p.MM&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, modNames, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sep</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#gene和性状的关系</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">geneTraitSignificance</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> as.data.frame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr, weight, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">use</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;p&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">GSPvalue</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> as.data.frame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">corPvalueStudent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">as.matrix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneTraitSignificance), nSamples));</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneTraitSignificance) = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;GS.&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(weight), </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sep</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(GSPvalue) = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;p.GS.&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(weight), </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sep</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-模内分析-鉴定具有高gs和mm的基因" tabindex="-1"><a class="header-anchor" href="#_3-3-模内分析-鉴定具有高gs和mm的基因"><span>3.3 模内分析：鉴定具有高GS和MM的基因</span></a></h3><p>使用GS和MM度量，我们可以鉴定出对体重以及在感兴趣的模块中具有较高模块成员性具有重要意义的基因。 例如，我们看一下与重量关联最高的棕色模块。 我们在棕色模块中绘制了基因重要性与模块成员关系的散点图。 在此模块中，GS和MM之间存在高度显着的相关性。</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 模型颜色</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">module</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;brown&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匹配列</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">column</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> match</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(module, modNames);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">moduleGenes</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> moduleColors</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">module;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#sizeGrWindow(7, 7);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">par</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">mfrow</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 画散点图</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">verboseScatterplot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">abs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneModuleMembership[moduleGenes, column]),</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">                    abs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneTraitSignificance[moduleGenes, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">                    xlab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Module Membership in&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, module, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;module&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">                    ylab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Gene significance for body weight&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">                    main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Module membership vs. gene significance</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">                    cex.main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex.lab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex.axis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">col</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> module)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzUxXzAucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h3 id="_3-4-网络分析结果总结" tabindex="-1"><a class="header-anchor" href="#_3-4-网络分析结果总结"><span>3.4 网络分析结果总结</span></a></h3><p>我们发现模块与我们的兴趣特征高度相关，并通过模块成员度量标准确定了其主要参与者。 现在，我们将此统计信息与基因注释合并，并写出一个文件，该文件总结了最重要的结果，并且可以在标准电子表格软件（例如MS Excel或Open Office Calc）中进行检查。 我们的表达式数据仅由探针ID名称注释：</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 提取表带数据样本名称</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># names(datExpr);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 指定颜色数据名称</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># names(datExpr)[moduleColors==&quot;brown&quot;]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 基因注释数据</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">annot</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> read.csv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;./data/GeneAnnotation.csv&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(annot)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(annot)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">probes</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">probes2annot</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> match</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(probes, annot</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">substanceBXH)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># The following is the number or probes without annotation:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">sum</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">is.na</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(probes2annot))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol class="list-inline"><li>23388</li><li>34</li></ol><ol class="list-inline"><li>&#39;X&#39;</li><li>&#39;ID&#39;</li><li>&#39;arrayname&#39;</li><li>&#39;substanceBXH&#39;</li><li>&#39;gene_symbol&#39;</li><li>&#39;LocusLinkID&#39;</li><li>&#39;OfficialGeneSymbol&#39;</li><li>&#39;OfficialGeneName&#39;</li><li>&#39;LocusLinkSymbol&#39;</li><li>&#39;LocusLinkName&#39;</li><li>&#39;ProteomeShortDescription&#39;</li><li>&#39;UnigeneCluster&#39;</li><li>&#39;LocusLinkCode&#39;</li><li>&#39;ProteomeID&#39;</li><li>&#39;ProteomeCode&#39;</li><li>&#39;SwissprotID&#39;</li><li>&#39;OMIMCode&#39;</li><li>&#39;DirectedTilingPriority&#39;</li><li>&#39;AlternateSymbols&#39;</li><li>&#39;AlternateNames&#39;</li><li>&#39;SpeciesID&#39;</li><li>&#39;cytogeneticLoc&#39;</li><li>&#39;Organism&#39;</li><li>&#39;clustername&#39;</li><li>&#39;reporterid&#39;</li><li>&#39;probeid&#39;</li><li>&#39;sequenceid&#39;</li><li>&#39;clusterid&#39;</li><li>&#39;chromosome&#39;</li><li>&#39;startcoordinate&#39;</li><li>&#39;endcoordinate&#39;</li><li>&#39;strand&#39;</li><li>&#39;sequence_3_to_5_prime&#39;</li><li>&#39;sequence_5_to_3_prime&#39;</li></ol><p>0</p><p>现在，我们创建一个数据框，其中包含所有探针的以下信息：探针ID，基因符号，基因座ID（Entrez码），模块颜色，重量的基因重要性以及模块中所有模块的成员和p值。 这些模块将按照其重量的重要性进行排序，而最重要的模块则位于左侧。</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Create the starting data frame</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">geneInfo0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> data.frame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">substanceBXH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> probes,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">geneSymbol</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> annot</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gene_symbol[probes2annot],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">LocusLinkID</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> annot</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">LocusLinkID[probes2annot],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">moduleColor</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> moduleColors,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">geneTraitSignificance,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">GSPvalue)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Order modules by their significance for weight</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">modOrder</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> order</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">abs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs, weight, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">use</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;p&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)));</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Add module membership information in the chosen order</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (mod </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">ncol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneModuleMembership))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    oldNames</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneInfo0)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    geneInfo0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> data.frame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneInfo0, geneModuleMembership[, modOrder[mod]],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    MMPvalue[, modOrder[mod]]);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneInfo0) = </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(oldNames, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;MM.&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, modNames[modOrder[mod]], </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sep</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    paste</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;p.MM.&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, modNames[modOrder[mod]], </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">sep</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Order the genes in the geneInfo variable first by module color, then by geneTraitSignificance</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">geneOrder</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> order</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneInfo0</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">moduleColor, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">abs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneInfo0</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">GS.weight));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">geneInfo</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> geneInfo0[geneOrder, ]</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">write.csv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(geneInfo, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;geneInfo.csv&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-使用wgcna进行网络可视化" tabindex="-1"><a class="header-anchor" href="#_4-使用wgcna进行网络可视化"><span>4 使用WGCNA进行网络可视化</span></a></h2><p>主要步骤如下：</p><ol><li>显示基因网络</li><li>可视化特征基因网络</li></ol><h2 id="_4-1-显示基因网络" tabindex="-1"><a class="header-anchor" href="#_4-1-显示基因网络"><span>4.1 显示基因网络</span></a></h2><p>可视化加权网络的一种方法是绘制其热图，热图的每一行和每一列都对应一个基因。 热图可以描述邻接或拓扑重叠，浅色表示低邻接（重叠），而深色表示更高的邻接（重叠）。 另外，沿着热图的顶部和左侧绘制了基因树状图和模块颜色。</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Calculate topological overlap anew: this could be done more efficiently by saving the TOM</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># calculated during module detection, but let us do it again here.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 重新计算拓扑重叠：通过保存TOM可以更有效地完成此操作</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 是在模块检测期间计算的，但让我们在这里再次进行。</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">dissTOM</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">TOMsimilarityFromExpr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">power</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Transform dissTOM with a power to make moderately strong connections more visible in the heatmap</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 变换dissTOM</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">plotTOM</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dissTOM</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Set diagonal to NA for a nicer plot</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">diag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(plotTOM) = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">NA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Call the plot function</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># sizeGrWindow(9,9)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 基因的聚类树聚类时的距离为1-TOM值结合基因间的距离，即1-TOM值，用热图展示</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># TOMplot(plotTOM, geneTree, moduleColors, main = &quot;Network heatmap plot, all genes&quot;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>TOM calculation: adjacency..
..will not use multithreading.
 Fraction of slow calculations: 0.396405
..connectivity..
..matrix multiplication (system BLAS)..
..normalization..
..done.
</code></pre><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzU5XzEucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p>请注意，生成热图图可能要花费大量时间。 可以限制基因数量以加快绘图速度。 但是，一个基因子集的基因树状图通常看起来与所有基因的基因树状图不同。 在以下示例中，我们将绘制的基因数限制为400：</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">nSelect</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 400</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># For reproducibility, we set the random seed</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">set.seed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">select</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> sample</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(nGenes, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nSelect);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">selectTOM</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dissTOM[select, select];</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># There’s no simple way of restricting a clustering tree to a subset of genes, so we must re-cluster.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 重新画聚类图</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">selectTree</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> hclust</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">as.dist</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(selectTOM), </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">method</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;average&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">selectColors</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> moduleColors[select];</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Open a graphical window</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># sizeGrWindow(9,9)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Taking the dissimilarity to a power, say 10, makes the plot more informative by effectively changing</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># the color palette; setting the diagonal to NA also improves the clarity of the plot</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">plotDiss</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> selectTOM</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">diag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(plotDiss) = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">NA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">TOMplot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(plotDiss, selectTree, selectColors, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Network heatmap plot, selected genes&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzYxXzAucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><h3 id="_4-2-可视化特征基因网络" tabindex="-1"><a class="header-anchor" href="#_4-2-可视化特征基因网络"><span>4.2 可视化特征基因网络</span></a></h3><p>研究找到的模块之间的关系通常很有趣。 可以使用特征基因作为代表特征，并通过特征基因相关性来量化模块相似性。 该软件包包含一个方便的函数plotEigengeneNetworks，该函数生成特征基因网络的摘要图。 通常，向特征基因添加临床特征（或多个特征）以了解特征如何适合特征基因网络是有益的</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Recalculate module eigengenes</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 重新计算基因特征值</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">MEs</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> moduleEigengenes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datExpr, moduleColors)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">eigengenes</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Isolate weight from the clinical traits</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">weight</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> as.data.frame</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(datTraits</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">weight_g);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">names</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(weight) = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;weight&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Add the weight to existing module eigengenes</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">MET</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;"> orderMEs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cbind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MEs, weight))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Plot the relationships among the eigengenes and the trait</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#sizeGrWindow(5,7.5);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">par</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 画树形图</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># marDendro给出树状图的边距设置，marHeatmap热图边距设置</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">plotEigengeneNetworks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MET, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">marDendro</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">marHeatmap</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex.lab</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">xLabelsAngle</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 90</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzY0XzAucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p>该函数生成特征基因和特征的树状图，以及它们之间关系的热图。 要拆分树状图和热图图，我们可以使用以下代码</p><div class="language-r line-numbers-mode" data-highlighter="shiki" data-ext="r" data-title="r" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Plot the dendrogram</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># sizeGrWindow(6,6);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">par</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">plotEigengeneNetworks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MET, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Eigengene dendrogram&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">marDendro</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">plotHeatmaps</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> FALSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Plot the heatmap matrix (note: this plot will overwrite the dendrogram plot)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">par</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">cex</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#61AFEF;">plotEigengeneNetworks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(MET, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Eigengene adjacency heatmap&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">marHeatmap</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">plotDendrograms</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> FALSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">xLabelsAngle</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 90</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzY2XzAucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><figure><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vbHVtaW5pb3VzL2FydGljbGVfcGljdHVyZV93YXJlaG91c2UvcmF3L21hc3Rlci9SLVN0dWR5LU5vdGVzL1dHQ05BJTIwVFVUT1JJQUwvb3V0cHV0XzY2XzEucG5n?x-oss-process=image/format,png" alt="png" tabindex="0" loading="lazy"><figcaption>png</figcaption></figure><p>上图为上述代码的输出。本征基因树状图和热图识别了被称为元模块的相关本征基因群。例如，树状图表明，红、棕、蓝三个模块具有高度的相关性，它们之间的相互关系强于它们与体重的相关性。</p><h2 id="_5-参考" tabindex="-1"><a class="header-anchor" href="#_5-参考"><span>5 参考</span></a></h2><blockquote><p>https://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/Tutorials/<br> https://www.jianshu.com/p/e9cc3f43441d<br> https://blog.csdn.net/weixin_43569478/article/details/83747303<br> https://www.jianshu.com/p/25905a905086</p></blockquote></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/blog/r%E8%AF%AD%E8%A8%80/r%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/2019-07-31-_R%E8%AF%AD%E8%A8%80_%20R%E8%AF%AD%E8%A8%80PCA%E5%88%86%E6%9E%90%E6%95%99%E7%A8%8B%20Principal%20Component%20Methods%20in%20R.html" aria-label="[R语言] R语言PCA分析教程 Principal Component Methods in R" iconsizing="both"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->[R语言] R语言PCA分析教程 Principal Component Methods in R</div></a><!----></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><!----><div class="vp-copyright">Copyright © 2025 落痕月极 </div></footer></div><!--]--><!--[--><!----><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-HB0Nuzez.js" defer></script>
  </body>
</html>
